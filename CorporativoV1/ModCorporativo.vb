'**********************************************************************************************************************'
'*PROGRAMA: MODULO DE CORPORATIVO JOYERIA RAMOS  
'*AUTOR: MIGUEL ANGEL GARCIA WHA 
'*EMPRESA: GRUPO VITEK
'*FECHA DE INICIO: 02/01/2018     
'*FECHA DE TERMINACION:   
'**********************************************************************************************************************'


Option Strict Off
Option Explicit On
Imports ADODB
Imports Microsoft.VisualBasic.Compatibility
'Imports VB6 = Microsoft.VisualBasic

Public Module ModCorporativo
    ''' ****************************************************************************************************************************************************
    '** Nombre        : L.I José Gilberto Quintero López
    '** Fecha         : 05 May 2008
    '** Modificación  : se Modifica la Función BuscaImagen para que tomara como default la ruta de las imagenes
    '**                 de la Constante gstrCorpoRUTAIMAGENES
    '** Referencía    : JGQL 5May2008
    '''
    ''' SE AGREGO REPORTE VENTAS Y EXISTENCIAS POR FAMILIA A LA SEGURIDAD
    ''' 27OCT2010 - MAVF Ver
    '''
    ''' Ver 1.0       Estatus: Aprobado
    ''' ****************************************************************************************************************************************************

    Dim I As Integer
    Const gstrMascaraPict As String = "0000000000000"
    Const cDigitos As String = "1234567890.,"
    Dim mcurImporteCambioDolarP As Decimal

    '''Este Módulo contiene Funciones y Procedimientos que son muy particulares para el Corporativo

    Public Function Referencia(ByRef Sql As String) As Boolean
        On Error GoTo Merr
        Dim rsLocal As ADODB.Recordset
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.UP_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 800, Sql))
        rsLocal = Cmd.Execute
        If rsLocal.RecordCount > 0 Then
            Referencia = True
        Else
            Referencia = False
        End If
Merr:
        If Err.Number <> 0 Then
            ModEstandar.MostrarError()
        End If
    End Function

    '''27OCT2010 - MAVF
    Public Sub LlenaVectorFormas()
        'On Error GoTo Merr
        Try
            'Este Procedimiento Mete al Vector de Formas, todas la formas existentes en el Proyecto
            'Checar si este procedimiento se puede hacer usando un recordset,
            'haciendo un consulta a la tabla de Funciones para obtener todos las formas y posteriormente meterlas al vector de Formas
            'Este Vector Contiene El nombre e indice de todas las Formas     existentes en el Proyecto
            '--------------'------------------------------'
            '  Columna 0   '   Columna 1                  '
            '--------------'------------------------------'
            '---------------------------------------------'
            ' NombreForma  '  Indice en el Menu Principal '
            '--------------'------------------------------'

            'Dim VFormas(0, 0) As Object

            'Menu : Catalogos
            VFormas(0, 0) = "frmCorpoABCClientes"
            VFormas(1, 0) = 0
            VFormas(0, 1) = "frmCorpoAbcVendedores"
            VFormas(1, 1) = 1
            VFormas(0, 2) = "frmCorpoAbcSucursales"
            VFormas(1, 2) = 2
            VFormas(0, 3) = "frmCorpoAbcTalleres"
            VFormas(1, 3) = 3
            VFormas(0, 4) = "frmCorpoAbcTiposMaterial"
            VFormas(1, 4) = 4
            VFormas(0, 5) = "frmCorpoAbcProvAcreed"
            VFormas(1, 5) = 5
            VFormas(0, 6) = "frmCorpoAbcFormasdePago"
            VFormas(1, 6) = 6
            VFormas(0, 7) = "frmCorpoAbcBancos"
            VFormas(1, 7) = 7
            VFormas(0, 8) = "frmCorpoAbcCuentasBancarias"
            VFormas(1, 8) = 8
            VFormas(0, 9) = "frmCorpoABCOrigenyAplicaciondeRecursos"
            VFormas(1, 9) = 9
            VFormas(0, 10) = "frmCorpoABCRubrosdeAplicacionyOrigen"
            VFormas(1, 10) = 10
            VFormas(0, 11) = "frmCorpoABCDescuentosVendExternos"
            VFormas(1, 11) = 11
            '12=Separador
            VFormas(0, 12) = "frmCorpoAbcArticulos"
            VFormas(1, 12) = 16
            'VFormas(0, 13) = "frmCorpoAbcGrupos"
            'VFormas(1, 13) = 17
            '15= Separador
            VFormas(0, 14) = "frmCorpoAbcMarca"
            VFormas(1, 14) = 19
            VFormas(0, 15) = "frmCorpoAbcModelos"
            VFormas(1, 15) = 20
            '18 = Separador
            VFormas(0, 16) = "frmCorpoAbcFamilias"
            VFormas(1, 16) = 22
            VFormas(0, 17) = "frmCorpoAbcLineas"
            VFormas(1, 17) = 23
            VFormas(0, 18) = "frmCorpoAbcSubLineas"
            VFormas(1, 18) = 24
            'Menu : Configuracion General
            VFormas(0, 19) = "frmConfigGralCorporativo"
            VFormas(1, 19) = 0

            'Menu de Ventas (mnuVentasOpc)
            '1 = Ventas Salida de Mercancia: No se hace movimientos con él
            '2 = Ventas Ingresos: No se hace movimientos con él
            '3 = Vendedor Externo: No se hace movimientos con él
            VFormas(0, 20) = "frmVtasReportedeApartados"
            VFormas(1, 20) = 3
            VFormas(0, 21) = "frmVtasReportedeReparaciones"
            VFormas(1, 21) = 4
            VFormas(0, 22) = "frmVtasReportedeCuentasporCobrar"
            VFormas(1, 22) = 5
            VFormas(0, 23) = "frmVtasEstadodeResultados"
            VFormas(1, 23) = 7

            'Menu : Ventas - Ventas Salida de Mercancía (mnuVentasSalMerOpc)
            VFormas(0, 24) = "frmVtasRPTVentasSalidadeMercancia"
            VFormas(1, 24) = 0
            VFormas(0, 25) = "frmVtasRPTVentasSalidadeMercanciaPorProv"
            VFormas(1, 25) = 1
            VFormas(0, 26) = "frmVtasRPTVentasSalidadeMercanciaClasifArtic"
            VFormas(1, 26) = 2
            VFormas(0, 27) = "frmVtasRPTVentasSalidadeMercanciaCompara"
            VFormas(1, 27) = 3
            VFormas(0, 28) = "frmVtasRPTVentasSalidadeMercanciaUtilidad"
            VFormas(1, 28) = 4
            VFormas(0, 29) = "frmVtasRPTVentasSalidadeMercanciaRelojeria"
            VFormas(1, 29) = 5
            VFormas(0, 30) = "frmVtasRPTVentasSalidadeMercanciaRelojMaterial"
            VFormas(1, 30) = 6
            VFormas(0, 31) = "frmVtasRPTVentasSalidadeMercanciaFlujoVenta"
            VFormas(1, 31) = 7
            VFormas(0, 32) = "frmVtasRPTVentasSalidadeMercanciaPorCliente"
            VFormas(1, 32) = 8
            VFormas(0, 33) = "frmVtasRPTVentasSalidadeMercanciaPorVendedor"
            VFormas(1, 33) = 9
            VFormas(0, 34) = "frmVtasRPTVentasSalidadeMercanciaComisionVendedor"
            VFormas(1, 34) = 10
            'Menu : Ventas - Ventas Ingresos(mnuVentasVtasIngrOpc)
            VFormas(0, 35) = "frmVtasRPTIngresosGenerales"
            VFormas(1, 35) = 0
            VFormas(0, 36) = "frmVtasRPTIngresosPorPeriodoySucursal"
            VFormas(1, 36) = 1
            VFormas(0, 37) = "frmVtasRPTIngresosPorAbonos"
            VFormas(1, 37) = 2
            VFormas(0, 38) = "frmVtasRPTIngresosPorReparaciones"
            VFormas(1, 38) = 3
            VFormas(0, 39) = "frmVtasRPTIngresosPorConceptoDePago"
            VFormas(1, 39) = 4
            'Menu : Ventas - Vendedor Externo (mnuVentasVendExtOpc)
            VFormas(0, 40) = "frmVtasVEEntradadeMercancia"
            VFormas(1, 40) = 0
            VFormas(0, 41) = "frmVtasVESalidadeMercancia"
            VFormas(1, 41) = 1
            VFormas(0, 42) = "frmVtasVEExistencias"
            VFormas(1, 42) = 2
            VFormas(0, 43) = "frmVtasVELiquidacionVendedorExterno"
            VFormas(1, 43) = 3
            VFormas(0, 44) = "frmVtasVEIngresosSalidadeMercanciaaVendExt"
            VFormas(1, 44) = 4
            VFormas(0, 45) = "frmVtasVEDetalladodeEntradasSalidas"
            VFormas(1, 45) = 5
            'Menu : Facturacion(mnuFacturacionOpc)
            VFormas(0, 46) = "frmFactAnalisisVentas"
            VFormas(1, 46) = 0
            VFormas(0, 47) = "frmFactFacturacionEspecial"
            VFormas(1, 47) = 1
            '2 = Reportes de Facturacion: No se hace movimientos con él
            'Menu : Facturación - Reportes de Facturacion (mnuFacturacionRptFactOpc)
            VFormas(0, 48) = "frmFactReportesFacturacionGlobalXSucursal"
            VFormas(1, 48) = 0
            VFormas(0, 49) = "frmFactReportesFacturacionDetalladaXSucursal"
            VFormas(1, 49) = 1
            VFormas(0, 50) = "frmFactReportesImpresionTickets"
            VFormas(1, 50) = 2
            VFormas(0, 51) = "frmFactReportesMejoresClientes"
            VFormas(1, 51) = 3
            'Menu : Compras y CxP (mnuCompyCxpOpc)
            VFormas(0, 52) = "frmCXPOrdenCompra"
            VFormas(1, 52) = 0
            VFormas(0, 53) = "frmCXPRegFactCompras"
            VFormas(1, 53) = 1
            VFormas(0, 54) = "frmCXPRegFactGastos"
            VFormas(1, 54) = 2
            VFormas(0, 55) = "frmCXPProgPagos"
            VFormas(1, 55) = 3
            VFormas(0, 56) = "frmCXPRegNotasCredito"
            VFormas(1, 56) = 4
            '''VFormas(0, 57) = "frmCxPCuentasPorPagar"
            '''VFormas(1, 57) = 5
            VFormas(0, 58) = "frmCXPEmisionPagos"
            VFormas(1, 58) = 6

            '6 = Reportes : no se hacen movimientos con el
            'Menu : Compras y CxP - Reportes (mnuCompyCxPRptOpc)
            VFormas(0, 59) = "frmCXPrptFacturas"
            VFormas(1, 59) = 0
            VFormas(0, 60) = "frmCXPrptNotasCredito"
            VFormas(1, 60) = 1
            VFormas(0, 61) = "frmCXPrptMejoresProv" 'Mejores Proveedores
            VFormas(1, 61) = 2
            VFormas(0, 62) = "frmCXPrptComprasPorProveedor" 'Analisis Anual de Compras
            VFormas(1, 62) = 3
            VFormas(0, 63) = "frmCXPrptOC"
            VFormas(1, 63) = 4
            VFormas(0, 64) = "frmCXPrptArticulosPendientes"
            VFormas(1, 64) = 5
            VFormas(0, 65) = "Articulos pendientes por Recibir"
            VFormas(1, 65) = 5

            'Menu : Bancos (mnuBancosOpcProcesoDiario)
            VFormas(0, 66) = "frmBancosProcesoDiarioRegistrodePagos"
            VFormas(1, 66) = 0
            VFormas(0, 67) = "frmBancosProcesoDiarioRegistrodeDepositos"
            VFormas(1, 67) = 1
            VFormas(0, 68) = "frmBancosProcesoDiarioCargosDiversos"
            VFormas(1, 68) = 2
            VFormas(0, 69) = "frmBancosProcesoDiarioTraspasosBancarios"
            VFormas(1, 69) = 3
            VFormas(0, 70) = "frmBancosProcesoDiarioAnticipoProveedoresAcreed"
            VFormas(1, 70) = 4
            VFormas(0, 71) = "frmBancosProcesoDiarioCancelaciondeMovimientosBanc"
            VFormas(1, 71) = 6
            VFormas(0, 72) = "frmBancosProcesoDiarioConsultadeSaldos"
            VFormas(1, 72) = 7
            VFormas(0, 73) = "frmBancosProcesoDiarioCierreDiarioBancos"
            VFormas(1, 73) = 8
            'Menu : Bancos (mnuBancosOpcProcesoMensual)
            VFormas(0, 74) = "frmBancosProcesoMensualConciliacionMensual"
            VFormas(1, 74) = 0
            VFormas(0, 75) = "frmBancosProcesoMensualMovimientosenConciliacion"
            VFormas(1, 75) = 1
            VFormas(0, 76) = "frmBancosProcesoMensualFlujoCajaGeneral"
            VFormas(1, 76) = 2
            VFormas(0, 77) = "frmBancosProcesoMensualConsultaOrigenAplicRec"
            VFormas(1, 77) = 3
            VFormas(0, 78) = "frmBancosProcesoMensualReporteOrigenyAplicacion"
            VFormas(1, 78) = 4
            VFormas(0, 79) = "frmBancosProcesoMensualCierreConciliacion"
            VFormas(1, 79) = 5
            'Menu : Bancos (mnuBancosOpcDepuracion)
            VFormas(0, 80) = "frmBancosProcesoMensualDepuraciondeMovimientosHist"
            VFormas(1, 80) = 2
            'Menu : Bancos (mnuBancosOpcCatalogos)
            VFormas(0, 81) = "frmAbcBancos"
            VFormas(1, 81) = 1
            VFormas(0, 82) = "frmABCCuentasBancarias"
            VFormas(1, 82) = 1
            VFormas(0, 83) = "frmABCOrigenyAplicaciondeRecursos"
            VFormas(1, 83) = 2
            VFormas(0, 84) = "frmABCRubrosdeAplicacionyOrigen"
            VFormas(1, 84) = 3

            'Menu : Inventarios(mnuInvOpc) - Corpo
            VFormas(0, 86) = "frmImpresionEtiquetas"
            VFormas(1, 86) = 2
            VFormas(0, 87) = "frmStockBasicoTienda"
            VFormas(1, 87) = 3
            '4 = Reportee: No se hace movimientos con él
            'Menú :Inventarios - Entradas (mnuInvEntradasOpc)
            VFormas(0, 88) = "frmInventradaPorCompra"
            VFormas(1, 88) = 0
            VFormas(0, 89) = "frmInvEntradaPorTransferencia"
            VFormas(1, 89) = 1
            VFormas(0, 90) = "frmInvEntradaPorDevolSobreVenta"
            VFormas(1, 90) = 2
            VFormas(0, 93) = "frmInvEntradaPorDevoldeVendedoresExternos"
            VFormas(1, 93) = 3
            VFormas(0, 94) = "frmInvEntradaPorDevolsobreVentaAVendedoresExternos"
            VFormas(1, 94) = 4
            VFormas(0, 95) = "frmInvEntradaPorDevolSobreObsequio"
            VFormas(1, 95) = 5
            VFormas(0, 96) = "frmInvEntradaPorDevolPorPrestamo"
            VFormas(1, 96) = 6
            VFormas(0, 97) = "frmInvEntradaporAjuste"
            VFormas(1, 97) = 7
            'Menu : Inventarios - Salidas (mnuInvSalidasOpc)
            VFormas(0, 98) = "frmInvSalidaPorVenta"
            VFormas(1, 98) = 0
            VFormas(0, 99) = "frmInvSalidaPorTransferencia"
            VFormas(1, 99) = 1
            VFormas(0, 100) = "frmInvSalidaPorDevolSobreCompra"
            VFormas(1, 100) = 2
            VFormas(0, 103) = "frmInvSalidaAVendedoresExternos"
            VFormas(1, 103) = 3
            VFormas(0, 104) = "frmInvSalidaPorVentaAVendedoresExternos"
            VFormas(1, 104) = 4
            VFormas(0, 105) = "frmInvSalidaPorObsequio"
            VFormas(1, 105) = 5
            VFormas(0, 106) = "frmInvSalidaPorPrestamo"
            VFormas(1, 106) = 6
            VFormas(0, 107) = "frmInvSalidaPorAjuste"
            VFormas(1, 107) = 7
            'Menu : Inventarios - Reportes(mnuInvRptOpc)
            VFormas(0, 108) = "frmRptKardexArticulo"
            VFormas(1, 108) = 0
            VFormas(0, 109) = "frmRptExistenciasyCostos"
            VFormas(1, 109) = 1
            VFormas(0, 110) = "frmReportePrestamosPendientes"
            VFormas(1, 110) = 2
            ' 3: Procesos de Inventario Físico
            'Menu : Inventarios - Reportes - Procesos de Inventario Físico(mnuInvRptPcInvFisicoOpc)
            '    VFormas(0, 111) = "frmInvHojadeControl"
            '    VFormas(1, 111) = 0
            '    VFormas(0, 112) = "frmInvCapturaInvFisico"
            '    VFormas(1, 112) = 1
            '    VFormas(0, 113) = "frmInvAnalisisComparativo"
            '    VFormas(1, 113) = 2
            '    VFormas(0, 114) = "frmInvGenerarAjustes"
            '    VFormas(1, 114) = 3

            'Menu: Seguridad (mnuSegOpc)
            VFormas(0, 115) = "FRMRASTREOFUNCIONES"
            VFormas(1, 115) = 0
            VFormas(0, 116) = "FRMABCMODULOS"
            VFormas(1, 116) = 1
            VFormas(0, 117) = "FRMABCUSUARIOS"
            VFormas(1, 117) = 2
            'Menu : Configuracion General (Continuación)
            VFormas(0, 118) = "frmPVConfigPuntoVenta"
            VFormas(1, 118) = 1
            VFormas(0, 119) = "FrmPVConfigTicketVenta"
            VFormas(1, 119) = 2
            VFormas(0, 120) = "frmPVConfigFacturacion"
            VFormas(1, 120) = 3

            'Reporte de Existencias-Stock del Modulo de Inventarios
            VFormas(0, 121) = ""
            VFormas(1, 121) = 0
            VFormas(0, 122) = ""
            VFormas(1, 122) = 0
            'CambioUsuario
            VFormas(0, 123) = "frmPVConfigFolios"
            VFormas(1, 123) = 4
            VFormas(0, 124) = "frmPVConfigCaja"
            VFormas(1, 124) = 5
            '''VFormas(0, 125) = "CambioUsuario"
            '''VFormas(1, 125) = 7
            'REPORTES INVENTARIOS - CORPO
            VFormas(0, 126) = "frmrptComparacionExistenciaStock"
            VFormas(1, 126) = 3
            VFormas(0, 127) = "frmRptTransferenciasNoConciliadas"
            VFormas(1, 127) = 4
            'BANCOS - PROCESO DIARIO - OTROS INGRESOS
            VFormas(0, 128) = "frmBancosProcesoDiarioRegistrodeOtrosIngresos"
            VFormas(1, 128) = 5
            'ABC - PROGRAMACION DE PROMOCIONES - TARJETAS EN PROMOCION
            VFormas(0, 129) = "frmCorpoTarjetasCreditoenPromocion"
            VFormas(1, 129) = 12
            VFormas(0, 130) = "frmProgramacionPromociones"
            VFormas(1, 130) = 13
            'Relacion de Gastos CORPORATIVO
            VFormas(0, 131) = "frmVtasRelacionGastos"
            VFormas(1, 131) = 8
            'CATALOGOS - Comisiones por ventas de vendedor
            VFormas(0, 132) = "frmCorpoABCComisiones"
            VFormas(1, 132) = 14
            'Impresora en el menú  de configuracion
            VFormas(0, 133) = "frmConfiguracion"
            VFormas(1, 133) = 7
            'Hoja de control en el menú de Inventario fisico
            VFormas(0, 134) = "frmInvHojadeControl"
            VFormas(1, 134) = 0
            VFormas(0, 135) = "frmInvAnalisisComparativo"
            VFormas(1, 135) = 1
            'Reporte de Bancos
            VFormas(0, 136) = "frmBancosReporteMovBancariosXTipo"
            VFormas(1, 136) = 1
            'Menu de Ventas - PtoVta
            VFormas(0, 137) = "frmVentasFactPendXImprimir"
            VFormas(1, 137) = 12
            'Reporte de Bancos
            VFormas(0, 138) = "frmBancosReportedeMovimientosBancarios"
            VFormas(1, 138) = 0
            VFormas(0, 139) = "frmBancosReporteAnalisisDiarioBancos"
            VFormas(1, 139) = 2
            'Reporte de Bancos
            VFormas(0, 140) = "frmCXPCuentasPorPagar"
            VFormas(1, 140) = 7
            VFormas(0, 141) = "frmCxpReporteSaldoXProveedor"
            VFormas(1, 141) = 8
            VFormas(0, 142) = "frmCXPPresupuestado"
            VFormas(1, 142) = 9
            VFormas(0, 143) = "frmCXPReporteSaldoXProveedores"
            VFormas(1, 143) = 10
            VFormas(0, 144) = "frmCXPRegFactComprasCargaInicial"
            VFormas(1, 144) = 9
            'Nuevas opciones en facturacion
            VFormas(0, 145) = "frmReimpresionCorteFinal"
            VFormas(1, 145) = 4
            VFormas(0, 146) = "frmPVDiarioMovtos"
            VFormas(1, 146) = 5
            'Nuevas opciones de ventas en el corporativo
            VFormas(0, 147) = "FRMCORPOCONTROLREPARACIONES"
            VFormas(1, 147) = 10
            VFormas(0, 148) = "frmVerificadorPrecios"
            VFormas(1, 148) = 11
            'Reportes Ejecutivos
            VFormas(0, 149) = "frmVtasVentasyExistenciasporProveedor"
            VFormas(1, 149) = 0
            VFormas(0, 150) = "frmVtasVentasporResurtir"
            VFormas(1, 150) = 1
            VFormas(0, 151) = "frmVtasVentasyUtilidad"
            VFormas(1, 151) = 2
            VFormas(0, 152) = "frmVentasPorGrupo"
            VFormas(1, 152) = 3
            VFormas(0, 153) = "frmUtilidadporGrupo"
            VFormas(1, 153) = 4
            'Importar Imagenes
            VFormas(0, 154) = "frmImportacionImagenes"
            VFormas(1, 154) = 0
            'Reporte de Ventas con Tarjetas de Credito
            VFormas(0, 155) = "frmFactReporteVtasTarjetaCreditoXSucursal"
            VFormas(1, 155) = 5
            'Reporte de Ventas con Tarjetas de Credito
            VFormas(0, 156) = "frmVtasRPTVtasSalMciaListadoVtasxCte"
            VFormas(1, 156) = 11
            'Reporte de VEntas y Existencias por Familia       '''27OCT2010 - MAVF
            VFormas(0, 157) = "frmVtasVentasyExistxFam"
            VFormas(1, 157) = 5

            'Merr:

            If Err.Number <> 0 Then ModEstandar.MostrarError()
        Catch ex As Exception
            MessageBox.Show(ex.Message)
        End Try

    End Sub

    ''''''''''''''''''--------------------
    Sub TicketEntradaSalidaPrestamo(ByRef Folio As String, ByRef CodSucursal As Integer, ByRef CodMovtoAlm As String)
        'On Error GoTo Errores
        Try
            'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
            'Caja  : Número de Caja, que imprime el Ticket
            Dim I As Byte
            Dim J As Byte
            Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
            Dim recAux As ADODB.Recordset
            Dim RENCABEZ As Byte
            Dim RDETALLE As Byte
            Dim RTOTALES As Byte
            Dim x As Object

            Dim Encabez(17, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
            Dim Detalle(17, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
            Dim Totales(19, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket
            Dim ConfigDevolucion(29, 5) As Object 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
            ' De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.

            Dim Valores(16) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

            Dim PALABRA As String
            'Dim TipoPrecio As String
            'Dim ImpteIVACtes As Double
            Dim TipoCambio As Double
            'Dim DesgloceFormas As Boolean
            'Dim RenIniDesg As Integer
            'Dim ColIniDesg As Integer
            Dim FormatoCantidad As String 'Contiene el FOrmato para la catidad de Artículos, en Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
            Dim C_TamañoTotales As Integer
            Const C_TamañoEncabezado As Integer = 8
            Const C_TamañoDetalle As Integer = 4
            C_TamañoTotales = 6

            '***************************************************************
            ' ** Obtiene Valores para la Fórmula
            '***** ENCABEZADO *****'
            For I = 0 To 16
                Valores(I) = ""
            Next I
            ''Llenar el Vector de COnfiguración del Tickect
            ConfigDevolucion(0, 0) = " "
            ConfigDevolucion(0, 1) = " "
            ConfigDevolucion(0, 2) = 56
            ConfigDevolucion(0, 3) = 0
            ConfigDevolucion(0, 4) = "C"

            ConfigDevolucion(1, 0) = " "
            ConfigDevolucion(1, 1) = "(Empresa)"
            ConfigDevolucion(1, 2) = 14
            ConfigDevolucion(1, 3) = 1
            ConfigDevolucion(1, 4) = "E"

            ConfigDevolucion(2, 0) = " "
            ConfigDevolucion(2, 1) = "(Dirección Empresa)"
            ConfigDevolucion(2, 2) = 17
            ConfigDevolucion(2, 3) = 1
            ConfigDevolucion(2, 4) = "E"

            ConfigDevolucion(3, 0) = "RFC:"
            ConfigDevolucion(3, 1) = "(RFC)"
            ConfigDevolucion(3, 2) = 22
            ConfigDevolucion(3, 3) = 2
            ConfigDevolucion(3, 4) = "E"

            ConfigDevolucion(4, 0) = "***  PRESTAMO DE ARTICULOS  ***"
            ConfigDevolucion(4, 1) = " "
            ConfigDevolucion(4, 2) = 16
            ConfigDevolucion(4, 3) = 3
            ConfigDevolucion(4, 4) = "E"

            ConfigDevolucion(5, 0) = "FECHA: "
            ConfigDevolucion(5, 1) = "(Fecha)+(Hora)"
            ConfigDevolucion(5, 2) = 1
            ConfigDevolucion(5, 3) = 0
            ConfigDevolucion(5, 4) = "E"

            ConfigDevolucion(6, 0) = "FOLIO: "
            ConfigDevolucion(6, 1) = "(Folio Almacen)"
            ConfigDevolucion(6, 2) = 32
            ConfigDevolucion(6, 3) = 1
            ConfigDevolucion(6, 4) = "E"

            ConfigDevolucion(7, 0) = "ALMACEN SALIDA: "
            ConfigDevolucion(7, 1) = "(Almacen Salida)"
            ConfigDevolucion(7, 2) = 1
            ConfigDevolucion(7, 3) = 1
            ConfigDevolucion(7, 4) = "E"

            ConfigDevolucion(8, 0) = "CLIENTE: "
            ConfigDevolucion(8, 1) = "(Cliente)"
            ConfigDevolucion(8, 2) = 1
            ConfigDevolucion(8, 3) = 2
            ConfigDevolucion(8, 4) = "E"

            ConfigDevolucion(9, 0) = "CANTIDAD"
            ConfigDevolucion(9, 1) = "(Cantidad)"
            ConfigDevolucion(9, 2) = 1
            ConfigDevolucion(9, 3) = 0
            ConfigDevolucion(9, 4) = "D"

            ConfigDevolucion(10, 0) = "ARTICULO"
            ConfigDevolucion(10, 1) = "(Descripción)"
            ConfigDevolucion(10, 2) = 11
            ConfigDevolucion(10, 3) = 0
            ConfigDevolucion(10, 4) = "D"

            ConfigDevolucion(11, 0) = "PRECIO"
            ConfigDevolucion(11, 1) = "(Precio Venta)"
            ConfigDevolucion(11, 2) = 35
            ConfigDevolucion(11, 3) = 0
            ConfigDevolucion(11, 4) = "D"

            ConfigDevolucion(12, 0) = "IMPORTE"
            ConfigDevolucion(12, 1) = "(Importe)"
            ConfigDevolucion(12, 2) = 46
            ConfigDevolucion(12, 3) = 1
            ConfigDevolucion(12, 4) = "D"

            ConfigDevolucion(13, 0) = "TOTAL:"
            ConfigDevolucion(13, 1) = "(Total)"
            ConfigDevolucion(13, 2) = 31
            ConfigDevolucion(13, 3) = 1
            ConfigDevolucion(13, 4) = "T"

            ConfigDevolucion(14, 0) = "TOTAL PESOS:"
            ConfigDevolucion(14, 1) = "(Total Pesos)"
            ConfigDevolucion(14, 2) = 31
            ConfigDevolucion(14, 3) = 3
            ConfigDevolucion(14, 4) = "T"

            ConfigDevolucion(15, 0) = "____________________"
            ConfigDevolucion(15, 1) = " "
            ConfigDevolucion(15, 2) = 5
            ConfigDevolucion(15, 3) = 0
            ConfigDevolucion(15, 4) = "T"

            ConfigDevolucion(16, 0) = "____________________"
            ConfigDevolucion(16, 1) = " "
            ConfigDevolucion(16, 2) = 31
            ConfigDevolucion(16, 3) = 1
            ConfigDevolucion(16, 4) = "T"

            ConfigDevolucion(17, 0) = "GERENTE"
            ConfigDevolucion(17, 1) = " "
            ConfigDevolucion(17, 2) = 11
            ConfigDevolucion(17, 3) = 0
            ConfigDevolucion(17, 4) = "T"

            ConfigDevolucion(18, 0) = "CLIENTE"
            ConfigDevolucion(18, 1) = " "
            ConfigDevolucion(18, 2) = 37
            ConfigDevolucion(18, 3) = 1
            ConfigDevolucion(18, 4) = "T"

            If CDbl(CodMovtoAlm) = C_EntradaPorDevolucionSobrePrestamo Then

                'Devolución únicamente
                ConfigDevolucion(4, 0) = "***  DEVOLUCION DE PRESTAMO  ***"
                ConfigDevolucion(4, 1) = " "
                ConfigDevolucion(4, 2) = 16
                ConfigDevolucion(4, 3) = 3
                ConfigDevolucion(4, 4) = "E"

                ConfigDevolucion(7, 0) = "FOLIO PRESTAMO: "
                ConfigDevolucion(7, 1) = "(Folio Prestamo)"
                ConfigDevolucion(7, 2) = 1
                ConfigDevolucion(7, 3) = 1
                ConfigDevolucion(7, 4) = "E"

            End If

            gStrSql = "SELECT     NombreEmp, DomicilioEmp, RFCEmp " & "From dbo.ConfiguracionGeneral GROUP BY NombreEmp, DomicilioEmp, RFCEmp"

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute
            If RsGral.RecordCount > 0 Then
                Valores(0) = Trim(RsGral.Fields("NombreEmp").Value) 'Nombre Empresa
                Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DomicilioEmp").Value)) 'Direccion Empresa                                                     'Ciudad Sucursal
                Valores(2) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RFCEmp").Value)) 'RFC Empresa
            Else
                MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
                For I = 0 To 2
                    Valores(I) = RsGral.Fields(Val(CStr(I))).Value
                Next I
            End If

            gStrSql = "SELECT     M.FolioAlmacen, M.FechaAlmacen, A.DescAlmacen, C.DescCliente, M.ReferenciaDeOrigen " & "FROM         dbo.MovtosAlmacenCab M INNER JOIN " & "dbo.CatAlmacen A ON M.CodAlmacen = A.CodAlmacen INNER JOIN " & "dbo.CatClientes C ON M.CodCliente = C.CodCliente " & "WHERE     (M.FolioAlmacen = '" & Folio & "')"
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute
            If RsGral.RecordCount > 0 Then
                Valores(3) = Folio 'Folio de Movimiento de Almacen
                Valores(4) = Format(RsGral.Fields("FechaAlmacen").Value, "DD/MMM/YYYY") 'Fecha
                Valores(5) = RsGral.Fields("ReferenciaDeOrigen").Value 'Folio de Referencia
                Valores(6) = Trim(RsGral.Fields("DescCliente").Value) 'Nombre del Cliente
                Valores(7) = Trim(RsGral.Fields("DescAlmacen").Value) 'Almacen de Salida
            End If

            COLS = ConfigDevolucion(0, 2)
            For I = 1 To C_TamañoEncabezado 'Tamaño del Vector de Configuracion del Ticket
                If ConfigDevolucion(I, 4) <> "E" Then Exit For
                Encabez(I, 0) = ConfigDevolucion(I, 0)
                Encabez(I, 2) = ConfigDevolucion(I, 2)
                Encabez(I, 3) = ConfigDevolucion(I, 3)
                Encabez(I, 4) = "S"
                If ConfigDevolucion(I, 1) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(ConfigDevolucion(I, 1)))
                        If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" Then
                            PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                            Select Case PALABRA
                                Case "Empresa"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                                Case "Dirección Empresa"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                                Case "Ciudad Empresa"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                                Case "RFC"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                                Case "Folio Almacen"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                                Case "Folio Prestamo"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                                Case "Fecha"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                                Case "Almacen Salida"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                                Case "Cliente"
                                    Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            End Select
                            PALABRA = ""
                        End If
                    Next J
                End If
            Next I
Continuar:
            'Impresión de la primera parte del Ticket, Encabezado
            '''Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
            FileOpen(1, gstrTicketPrinter, OpenMode.Output)
            Dim Linea As String
            PrintLine(1, Chr(27) & Chr(33) & Chr(1))
            For I = 1 To C_TamañoEncabezado
                If Encabez(I, 4) = "S" Then
                    Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                    If Encabez(I, 3) > 0 Then
                        For J = 1 To Encabez(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                End If
            Next I

            'Obtener los valores para la formula, para la impresión del detalle del Ticket
            gStrSql = "SELECT     MC.FolioAlmacen, MD.CodArticulo, MD.Cantidad, MD.PrecioVenta, MD.Cantidad * round(MD.PrecioVenta,2) AS ImporteD , A.DescArticulo  " & "FROM         dbo.MovtosAlmacenDet MD INNER JOIN " & "dbo.MovtosAlmacenCab MC ON MD.FolioAlmacen = MC.FolioAlmacen INNER JOIN " & "dbo.CatArticulos A ON MD.CodArticulo = A.CodArticulo " & "WHERE     (MC.FolioAlmacen = '" & Folio & "')    AND (Mc.CodAlmacen = " & CodSucursal & ")"
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            Dim SIMBOLO As String
            Dim Valor As Double
            Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
            Dim Encabezado As Boolean
            Dim H As Byte
            SIMBOLO = "+"
            Encabezado = True
            If Not recAux.EOF Then
                recAux.MoveFirst()
            End If
            For H = 1 To recAux.RecordCount
                Valores(0) = recAux.Fields("CodArticulo").Value
                Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
                Valores(2) = recAux.Fields("Cantidad").Value
                Valores(3) = Format(System.Math.Round(recAux.Fields("PrecioVenta").Value, 2), gstrFormatoCantidad) 'pRECIO de Venta
                Valores(4) = Format(System.Math.Round(recAux.Fields("ImporteD").Value, 2), gstrFormatoCantidad) 'Importe
                For I = 0 To 15
                    Detalle(I, 0) = ""
                    Detalle(I, 1) = ""
                    Detalle(I, 2) = ""
                    Detalle(I, 3) = ""
                    Detalle(I, 4) = ""
                Next I

                'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle) '30. Tamaño del VEctro de Configuracion
                    If ConfigDevolucion(I, 4) = "D" Then
                        Detalle(I, 0) = Right(Space(8) & Trim(ConfigDevolucion(I, 0)), 8)
                        Detalle(I, 2) = ConfigDevolucion(I, 2)
                        Detalle(I, 3) = ConfigDevolucion(I, 3)
                        If Trim(ConfigDevolucion(I, 1)) <> "" Then
                            PALABRA = ""
                            For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                                FinPal = False
                                If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                                    PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                                ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Código"
                                            Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                            Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                            Detalle(I, 4) = "C"
                                        Case "Descripción"
                                            Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                            Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                            Detalle(I, 4) = "C"
                                        Case "Cantidad"
                                            Valor = Valores(2)
                                            Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                        Case "Precio Venta"
                                            Valor = Valores(3)
                                            Detalle(I, 4) = Detalle(I, 4) + "D"
                                        Case "Importe"
                                            Valor = Valores(4)
                                            Detalle(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                    If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                        If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                        If SIMBOLO = "+" Then
                                            Detalle(I, 1) = Detalle(I, 1) + Valor
                                        ElseIf SIMBOLO = "-" Then
                                            Detalle(I, 1) = Detalle(I, 1) - Valor
                                        ElseIf SIMBOLO = "*" Then
                                            Detalle(I, 1) = Detalle(I, 1) * Valor
                                        End If
                                    End If
                                    If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                                        SIMBOLO = "+"
                                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                                        SIMBOLO = "-"
                                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "x" Then
                                        SIMBOLO = "*"
                                    End If
                                End If
                            Next J
                        End If
                    End If
                Next I
                '*** Encabezado del Detalle
                If Encabezado Then
                    Encabezado = False
                    PrintLine(1, LineaSepara(COLS))
                    For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                        Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                        If Detalle(I, 3) > 0 Then
                            For J = 1 To 1 'Detalle(i, 3)
                                PrintLine(1, Left(RTrim(Linea), COLS))
                                Linea = ""
                            Next J
                        End If
                    Next I
                    PrintLine(1, LineaSepara(COLS))
                End If

                ''''***** DETALLE *****
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                    If Detalle(I, 4) = "C" Then
                        'Se trata de un dato caracter
                        Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    ElseIf Detalle(I, 4) = "E" Then
                        'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                        If gbytPosicionesDecimal = 0 Then
                            FormatoCantidad = CStr(0)
                        Else
                            FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                        End If
                        Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(8) & Format(Detalle(I, 1), FormatoCantidad), 8)
                    Else
                        Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                    End If
                    If Detalle(I, 3) > 0 Then
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                recAux.MoveNext()

                System.Array.Clear(Detalle, 0, Detalle.Length)
            Next H
            '***** TOTALES *****}
            gStrSql = "SELECT     MD.FolioAlmacen, SUM(round(MD.PrecioVenta,2) * MD.Cantidad) AS TotalD, " & "SUM(round(MD.PrecioVenta,2) * MD.Cantidad * MC.TipoCambio) AS TotalP " & "FROM         dbo.MovtosAlmacenDet MD INNER JOIN " & "dbo.MovtosAlmacenCab MC ON MD.FolioAlmacen = MC.FolioAlmacen " & "WHERE     (MD.FolioAlmacen = '" & Folio & "') and CodAlmacen = " & CodSucursal & "  " & "GROUP BY MD.FolioAlmacen, MD.FolioAlmacen, MC.TipoCambio "
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute
            If RsGral.RecordCount > 0 Then
                Valores(0) = Format(System.Math.Round(RsGral.Fields("TotalD").Value, 2), gstrFormatoCantidad) 'Total Devolucion Dólares
                Valores(1) = Format(System.Math.Round(RsGral.Fields("TotalP").Value, 1), gstrFormatoCantidad) 'Total Devolucion Pesos
            End If

            For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
                Totales(I, 0) = ConfigDevolucion(I, 0)

                Totales(I, 2) = ConfigDevolucion(I, 2)
                Totales(I, 3) = ConfigDevolucion(I, 3)
                Totales(I, 4) = "C"
                If Trim(ConfigDevolucion(I, 1)) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                        FinPal = False
                        If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Total"
                                    Valor = Valores(0)
                                    Totales(I, 4) = "N"
                                Case "Total Pesos"
                                    Valor = Valores(1)
                                    Totales(I, 4) = "N"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                                If Totales(I, 1) = "" Then Totales(I, 1) = 0
                                If SIMBOLO = "+" Then

                                    Totales(I, 1) = Totales(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then

                                    Totales(I, 1) = Totales(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then

                                    Totales(I, 1) = Totales(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "*" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
            Next I
            'Imprimir 3 Lineas en Blanco, para separar el Total de el Detalle.
            For I = 1 To 3
                Linea = ""
                PrintLine(1, Left(RTrim(Linea), COLS))
            Next
            For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
                If Totales(I, 4) = "C" Then
                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else


                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(15), 15) & Right(Space(10) & Format(Totales(I, 1), "###,###,##0.00"), 10)
                End If

                If Totales(I, 3) > 0 Then

                    For J = 1 To Totales(I, 3)
                        '                If TOTALES(i, 1) = "FORPAG" Then LINEA = ""
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I

            For I = 1 To 4
                PrintLine(1, "")
            Next I
            '''Cortar Papel
            PrintLine(1, Chr(27) & Chr(105))
            FileClose(1)
            'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
            '''x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
            System.Array.Clear(Encabez, 0, Encabez.Length)
            System.Array.Clear(Detalle, 0, Detalle.Length)
            System.Array.Clear(Totales, 0, Totales.Length)
            System.Array.Clear(Valores, 0, Valores.Length)
            recAux = Nothing
            'Errores:
        Catch ex As Exception
            If Err.Number = 55 Then
                FileClose(1)
                Err.Clear()
                GoTo Continuar
            End If
            If Err.Number <> 0 Then ModEstandar.MostrarError()
        End Try
    End Sub

    ''' SE AGREGO ELEMENTO 157 - RPT VTAS Y EXIST X FAMILIA - 27OCT2010 - MAVF
    Public Function Acceso(ByRef Usuario As Integer) As Boolean
        'On Error GoTo Merr
        Try
            'Función para determinar los derechos de un usuario, y habilitar  las opciones a las que puede tener acceso
            Dim mblnPoseeDerecho As Boolean
            ReDim VFormas(2, 158) 'Especifica el numero de elementos del Arreglo. Este Vector está definido en el ModVariables de Tipo Público

            LlenaVectorFormas()
            System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
            gStrSql = "Select Forma From Accesos where CodUsuario= " & Usuario & " And CodModulo <= 8 "
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute

            'En relación a las formas que tenga acceso el usuario, se habilitan las opciones del menu
            If RsGral.EOF Then
                MsgBox("No existen accesos registrados para el usuario" & vbNewLine & "Favor de verificar con el administrador del sistema", MsgBoxStyle.Exclamation, gstrCorpoNOMBREEMPRESA)
                If Trim(gStrNomUsuario) = "BISADMIN" Then
                    MDIMenuPrincipalCorpo.mnuSegOpc(0).Enabled = True
                    MDIMenuPrincipalCorpo.mnuSegOpc(1).Enabled = True
                    MDIMenuPrincipalCorpo.mnuSegOpc(2).Enabled = True
                    MDIMenuPrincipalCorpo.mnuConfiguracionOpc(7).Enabled = True
                End If
                Exit Function
            End If
            RsGral.MoveFirst()
            While Not RsGral.EOF
                mblnPoseeDerecho = False
                For I = 0 To 157
                    If UCase(VFormas(0, I)) = UCase(RsGral.Fields("Forma").Value) Then
                        mblnPoseeDerecho = True
                        Exit For
                    End If
                Next

                'Si el Usuario  posee el derecho entonces
                If mblnPoseeDerecho = True Then
                    With MDIMenuPrincipalCorpo
                        Select Case I
                            Case 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 129, 130, 132
                                'Catalogos
                                .mnuCatalogosOpc(VFormas(1, I)).Enabled = True
                            Case 19, 118, 119, 120, 123, 124, 125, 133
                                'Configuracion General
                                .mnuConfiguracionOpc(VFormas(1, I)).Enabled = True
                            Case 20, 21, 22, 23, 131, 147, 148
                                'Ventas
                                .mnuVentasOpc(VFormas(1, I)).Enabled = True
                            Case 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 156
                                'Ventas - Salid de Mercancia
                                .mnuVentasSalMerOpc(VFormas(1, I)).Enabled = True
                            Case 35, 36, 37, 38, 39
                                'Ventas - Ventas Ingresos
                                .mnuVentasVtasIngrOpc(VFormas(1, I)).Enabled = True
                            Case 40, 41, 42, 43, 44, 45
                                'Ventas - Vendedor Externo
                                .mnuVentasVendExtOpc(VFormas(1, I)).Enabled = True
                            Case 149, 150, 151, 152, 153, 157
                                'Reportes Ejecutivos
                                .mnuVentasSalMerOpcRepEjec(VFormas(1, I)).Enabled = True
                            Case 46, 47, 145, 146
                                'Facturacion
                                .mnuFacturacionOpc(VFormas(1, I)).Enabled = True
                            Case 48, 49, 50, 51
                                'Facturacion - Reportes FActuracion
                                .mnuFacturacionRptFactOpc(VFormas(1, I)).Enabled = True
                                '''Case 52, 53, 54, 55, 56, 57, 58
                            Case 52, 53, 54, 55, 56, 58, 144
                                ''Compras y Cuentas por Cobrar
                                .mnuCompyCxPOpc(VFormas(1, I)).Enabled = True
                            Case 59, 60, 61, 62, 63, 64, 65, 140, 141, 142, 143
                                'Compras y CxP - Reportes
                                .mnuCompyCxPRptOpc(VFormas(1, I)).Enabled = True
                            Case 66, 67, 68, 69, 70, 71, 72, 73, 128
                                'Bancos - Proceso Diario
                                .mnuBancosOpcProcesoDiario(VFormas(1, I)).Enabled = True
                            Case 74, 75, 76, 77, 78, 79
                                'Bancos - Proceso Mensual
                                .mnuBancosOpcProcesoMensual(VFormas(1, I)).Enabled = True
                            Case 80
                                'Bancos - Depuración
                                .mnuBancosOpc(VFormas(1, I)).Enabled = True
                            Case 81, 82, 83, 84
                                'Bancos - Catalogos
                                .mnuBancosOpcCatalogos(VFormas(1, I)).Enabled = True
                                'MDIMenuPrincipalCorpo.SetIndex(81).Enabled = True
                                'MDIMenuPrincipalCorpo.mnuBancosOpcCatalogos(VFormas(1, I)).Enabled = True
                                'MDIMenuPrincipalCorpo.mnuBancosOpcCatalogos(81).Enabled = True
                            Case 86, 87
                                'iNVENTARIOS
                                .mnuInvOpc(VFormas(1, I)).Enabled = True
                            Case 88, 89, 90, 93, 94, 95, 96, 97
                                'Invnetarios - Entradas
                                .mnuInvEntradasOpc(VFormas(1, I)).Enabled = True
                            Case 98, 99, 100, 103, 104, 105, 106, 107
                                'Inventarios - Salidas
                                .mnuInvSalidasOpc(VFormas(1, I)).Enabled = True
                            Case 108, 109, 110, 126, 127
                                'Inventarios - Reportes
                                .mnuInvRptOpc(VFormas(1, I)).Enabled = True
                            Case 134, 135
                                'Inventarios - Procesos de Inventario Fisico -
                                .mnuInvHojaOpc(VFormas(1, I)).Enabled = True
                            Case 115, 116, 117
                                'Seguridad
                                .mnuSegOpc(VFormas(1, I)).Enabled = True
                            Case 136, 138, 139
                                'Reportes de Bancos
                                .mnuBancosOpcProcesoDiarioRptOpc(VFormas(1, I)).Enabled = True
                            Case 154 'Utilerias
                                .mnuConfiguracionOpcUtil(VFormas(1, I)).Enabled = True
                            Case 155 'Reporte de Ventas con Tarjetas de Credito
                                .mnuFacturacionRptFactOpc(VFormas(1, I)).Enabled = True
                        End Select
                    End With
                End If
                RsGral.MoveNext()
            End While
            MDIMenuPrincipalCorpo.mnuConfiguracionOpc(9).Enabled = True
            MDIMenuPrincipalCorpo.mnuConfiguracionOpc(10).Enabled = True
            System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
            'Return True
            Exit Function
            'Merr:      
            If Err.Number <> 0 Then ModEstandar.MostrarError()
        Catch ex As Exception
            MessageBox.Show(ex.Message)
        End Try
        'Return True
    End Function

    Public Function ObtenerAlmacenOrigen(ByRef CodArticulo As Integer) As Integer
        On Error GoTo Merr
        Dim Rs As ADODB.Recordset
        ObtenerAlmacenOrigen = 0
        gStrSql = "Select CodAlmacenOrigen From CatArticulos Where CodArticulo = " & CodArticulo
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.UP_SELECT_DATOS"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 800, gStrSql))
        Rs = Cmd.Execute
        ObtenerAlmacenOrigen = Rs.Fields("CodAlmacenOrigen").Value
        'UPGRADE_NOTE: Object Rs may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        Rs = Nothing
        Exit Function
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Function ObtenerTipoAlmacen(ByRef CodAlmacen As Integer) As String
        On Error GoTo Merr
        Dim Rs As ADODB.Recordset
        ObtenerTipoAlmacen = ""
        gStrSql = "Select TipoAlmacen From CatAlmacen Where CodAlmacen= " & CodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.UP_SELECT_DATOS"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 800, gStrSql))
        Rs = Cmd.Execute
        ObtenerTipoAlmacen = Trim(Rs.Fields("TipoAlmacen").Value)
        'UPGRADE_NOTE: Object Rs may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        Rs = Nothing
        Exit Function
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    '''27OCT2010 - MAVF
    Public Sub DesHabilitaMenuPrincipal()
        '        On Error GoTo Merr
        '        'Este Procedimiento desactiva todas las opciones del Menu Principal. Todas las funciones del Vector de Formas
        '        Dim VFormas(2, 158) As Object 'Especifica el numero de elementos del Arreglo. Este Vector está definido en el ModVariables de Tipo Público

        '        LlenaVectorFormas()
        '        With MenuPrincipal
        '            For I = 0 To 157
        '                Select Case I
        '                    Case 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 129, 130, 132
        '                        'Catalogos
        '                        .mnuCatalogosOpc(VFormas(1, I)).Enabled = False
        '                    Case 19, 118, 119, 120, 123, 124, 125, 133
        '                        'Configuracion General
        '                        .mnuConfiguracionOpc(VFormas(1, I)).Enabled = False
        '                    Case 20, 21, 22, 23, 131, 147, 148
        '                        'Ventas
        '                        .mnuVentasOpc(VFormas(1, I)).Enabled = False
        '                    Case 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 156
        '                        'Ventas - Salid de Mercancia
        '                        .mnuVentasSalMerOpc(VFormas(1, I)).Enabled = False
        '                    Case 35, 36, 37, 38, 39
        '                        'Ventas - Ventas Ingresos
        '                        .mnuVentasVtasIngrOpc(VFormas(1, I)).Enabled = False
        '                    Case 40, 41, 42, 43, 44, 45
        '                        'Ventas - Vendedor Externo
        '                        .mnuVentasVendExtOpc(VFormas(1, I)).Enabled = False
        '                    Case 149, 150, 151, 152, 153, 157
        '                        'Reportes Ejecutivos
        '                        .mnuVentasSalMerOpcRepEjec(VFormas(1, I)).Enabled = False
        '                    Case 46, 47, 145, 146
        '                        'Facturacion
        '                        .mnuFacturacionOpc(VFormas(1, I)).Enabled = False
        '                    Case 48, 49, 50, 51
        '                        'Facturacion - Reportes FActuracion
        '                        .mnuFacturacionRptFactOpc(VFormas(1, I)).Enabled = False
        '                    Case 52, 53, 54, 55, 56, 57, 58, 144
        '                        ''Compras y Cuentas por Cobrar
        '                        .mnuCompyCxPOpc(VFormas(1, I)).Enabled = False
        '                    Case 59, 60, 61, 62, 63, 64, 65, 140, 141, 142, 143
        '                        'Compras y CxP - Reportes
        '                        .mnuCompyCxPRptOpc(VFormas(1, I)).Enabled = False
        '                    Case 66, 67, 68, 69, 70, 71, 72, 73, 128
        '                        'Bancos - Proceso Diario
        '                        .mnuBancosOpcProcesoDiario(VFormas(1, I)).Enabled = False
        '                    Case 74, 75, 76, 77, 78, 79
        '                        'Bancos - Proceso Mensual
        '                        .mnuBancosOpcProcesoMensual(VFormas(1, I)).Enabled = False
        '                    Case 80
        '                        'Bancos Depuracion
        '                        .mnuBancosOpc(VFormas(1, I)).Enabled = False
        '                    Case 81, 82, 83, 84
        '                        'Bancos - Catalogos
        '                        .mnuBancosOpcCatalogos(VFormas(1, I)).Enabled = False
        '                    Case 86, 87
        '                        'iNVENTARIOS
        '                        .mnuInvOpc(VFormas(1, I)).Enabled = False
        '                    Case 88, 89, 90, 93, 94, 95, 96, 97
        '                        'Invnetarios - Entradas
        '                        .mnuInvEntradasOpc(VFormas(1, I)).Enabled = False
        '                    Case 98, 99, 100, 103, 104, 105, 106, 107
        '                        'Inventarios - Salidas
        '                        .mnuInvSalidasOpc(VFormas(1, I)).Enabled = False
        '                    Case 108, 109, 110, 126, 127
        '                        'Inventarios - Reportes
        '                        .mnuInvRptOpc(VFormas(1, I)).Enabled = False
        '                    Case 134, 135
        '                        'Inventarios - Procesos de Inventario Fisico -
        '                        .mnuInvHojaOpc(VFormas(1, I)).Enabled = False
        '                    Case 115, 116, 117
        '                        'Seguridad
        '                        .mnuSegOpc(VFormas(1, I)).Enabled = False
        '                    Case 136, 138, 139
        '                        'Reportes de Bancos
        '                        .mnuBancosOpcProcesoDiarioRptOpc(VFormas(1, I)).Enabled = False
        '                    Case 154 'Utilerias
        '                        .mnuConfiguracionOpcUtil(VFormas(1, I)).Enabled = False
        '                    Case 155 'Reporte de Ventas con Tarjeta de Credito
        '                        .mnuFacturacionRptFactOpc(VFormas(1, I)).Enabled = False
        '                End Select
        '            Next
        '            'MenuPrincipal.mnuConfiguracionOpc(9).Enabled = False
        '            'MenuPrincipal.mnuConfiguracionOpc(10).Enabled = False
        '        End With
        'Merr:
        '        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub PasarVector()
        On Error GoTo e
        For I = 0 To 126
            'UPGRADE_WARNING: Couldn't resolve default property of object VFormas(1, I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object VFormas(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            gStrSql = "insert into vectorFormas values(' " & VFormas(0, I) & "', " & VFormas(1, I) & ", " & I & " ) "
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute
        Next
        MsgBox("Listo")
e:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Function Redondear(ByRef Valor As Double, ByRef Decimales As Double) As Double
        On Error GoTo Errores
        Dim ParteEnt As Integer
        Dim ParteDec As Integer
        Dim Valor2 As Double
        Dim x As Integer
        Dim Y As Integer
        ParteEnt = (Valor * 100) \ 100
        'UPGRADE_WARNING: Mod has a new behavior. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
        ParteDec = (Valor * 100) Mod 100
        Y = ParteDec \ (Decimales * 100)
        'UPGRADE_WARNING: Mod has a new behavior. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
        x = ParteDec Mod (Decimales * 100)
        If x >= (Decimales * 100) / 2 Then
            Valor2 = ParteEnt + (Y * Decimales) + Decimales
        Else
            Valor2 = ParteEnt + Decimales * Y
        End If
        Redondear = Valor2 - Valor
Errores:
        If Err.Number <> 0 Then Errores()
    End Function

    '''SE CAMBIO LA VARIABLE GLOBAL PARA LA TASA DE IVA PORQUE DEBE SER CONSIDERADA POR SUCURSAL - Y NO GLOBAL
    '''21FEB2005
    Function CargarDatosConfiguracionCorpo() As Boolean
        'Este Procedimiento Almacena en Variables Globales, los datos de la tabla de Configuracion General.
        'Para que esten disponibles durante el proyecto, ya que seran utilizadas en la mayoria de los Procesos.
        On Error GoTo Merr
        System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
        gStrSql = "Select * from ConfiguracionGeneral"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            gcurCorpoPORCUTILMINOPERACION = RsGral.Fields("PorcUtilMinOperacion").Value
            gstrCorpoRUTAIMAGENES = Trim(RsGral.Fields("RutaImagenes").Value)
            '''gcurCorpoTASAIVA = RsGral!TasaIVA
            gstrCorpoNOMBREEMPRESA = Trim(RsGral.Fields("NombreEmp").Value)
            gstrNombCortoEmpresa = gstrCorpoNOMBREEMPRESA
            gstrCorpoRFCEMPRESA = Trim(RsGral.Fields("RFCEmp").Value)
            gstrCorpoDOMICILIOEMPRESA = Trim(RsGral.Fields("DomicilioEmp").Value)
            gcurCorpoTIPOCAMBIODOLAR = Convert.ToDecimal(Trim(RsGral.Fields("TipoCambio").Value))
            gcurCorpoTIPOCAMBIOEURO = Convert.ToDecimal(RsGral.Fields("TipoCambioEuro").Value)
            gstrCorpoDriveLocal = Trim(RsGral.Fields("DriveLocal").Value)
            '''Debe convertirse a milisegundos puesto que es la medida que tiene el control TIMER
            If Left(RsGral.Fields("LapsoDifStock").Value, 1) = "H" Then
                gintLapsoDifStock = CInt(Numerico(Mid(Trim(RsGral.Fields("LapsoDifStock").Value), 2, Len(Trim(RsGral.Fields("LapsoDifStock").Value)))))
                gintLapsoDifStock = (gintLapsoDifStock * 60) * 60
            Else
                gintLapsoDifStock = CShort(Right(RsGral.Fields("LapsoDifStock").Value, 2)) * 60
            End If
            gstrCorpoTransferEntreSucursales = RsGral.Fields("TransferenciasentreSucursales").Value
            gstrCodificacionImportes = Trim(RsGral.Fields("Codificacion").Value) & ".,"
            'gintCodAlmacenGral = ObtenerCodAlmacenGral()
            gintCodAlmacen = gintCodAlmacenGral
            MDIMenuPrincipalCorpo.Text = "Corporativo - " & gstrCorpoNOMBREEMPRESA
        End If
        System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
        CargarDatosConfiguracionCorpo = True
        Exit Function

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function CargarDatosConfiguracionPV() As Boolean
        'Este Procedimiento Almacena en Variables Globales, los datos de la tabla de Configuracion General.
        'Para que esten disponibles durante el proyecto, ya que seran utilizadas en la mayoria de los Procesos.
        'Trae parametro de almacen que tomo de la carga de datos de configuracin del Corpo -  es el Almacen General
        On Error GoTo Merr

        'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
        System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
        gStrSql = "Select * from ConfiguracionGralPV Where CodAlmacen =  " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            gblnCapturarCantidadArts = RsGral.Fields("CapturarCantArts").Value
            gcurRedondeo = RsGral.Fields("Redondeo").Value
            gstrTipodeTrasfencia = RsGral.Fields("Transferencia").Value
            gbytPosicionesDecimal = RsGral.Fields("PosicionDecimal").Value
            gstrSimboloMonedaNacional = RsGral.Fields("SimboloMonedaNac").Value
            gcurEfectivoMaximoCaja = RsGral.Fields("EfectivoMaximo").Value
            gstrRutaArchivoInvElectronico = Trim(RsGral.Fields("RutaArchivo").Value)
            gstrNomArchivoInvElectronico = Trim(RsGral.Fields("ArchivoInvElectronico").Value)
            gstrSeparador = RsGral.Fields("Separador").Value
            gbytEspacios = RsGral.Fields("Espacios").Value
            gblnPermitirVtassinExistencia = RsGral.Fields("PermitirVtaSinExistencia").Value
            gblnConsultarxDescripcion = RsGral.Fields("ConsultarXDescrip").Value
            gblnAutCambiarCodCapturado = RsGral.Fields("AutorizCambiarCodigoCapt").Value
            gblnAutSuprLineaCapturada = RsGral.Fields("AutorizCambiarLineaCapt").Value
            gblnAutAbandCapturaIniciada = RsGral.Fields("AutorizAbandonarCaptIni").Value
            gblnIndSiProdNoSoportaDescto = RsGral.Fields("IndicarSiProdNoSoportaDescto").Value
            gblnAutConsultaFoliosVta = RsGral.Fields("AutorizConsultarFoliosVta").Value
            gblnAutModificarDesctos = RsGral.Fields("AutorizModificarDesctos").Value
            gcurUtilMinporOperacion = RsGral.Fields("UtilMinXOperacion").Value
            gstrMensajeFiscal = Trim(RsGral.Fields("MsgFiscal").Value)
            gstrMensajeNormal = Trim(RsGral.Fields("MsgNormal").Value)
            gstrMensajeCredito = Trim(RsGral.Fields("MsgCredito").Value)
            gstrMensajeDevoluciones = (RsGral.Fields("MsgDevoluciones")).Value
            gstrImpresionTransferencias = Trim(RsGral.Fields("ImpresionTransferencias").Value)
            gblnTransfCodigoViejo = RsGral.Fields("CodigoViejo").Value
            gcurCorpoTASAIVA = RsGral.Fields("TasaIVA").Value
        End If
        System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
        CargarDatosConfiguracionPV = True
        Exit Function

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function


    '''Sub CargarDatosConfiguracion()
    '''    'Este Procedimiento Almacena en Variables Globales, los datos de la tabla de Configuracion General.
    '''    'Para que esten disponibles durante el proyecto, ya que seran utilizadas en la mayoria de los Procesos.
    '''    On Local Error GoTo MErr
    '''    Screen.MousePointer = vbHourglass
    '''    gStrSql = "Select * from ConfiguracionGeneral,ConfiguracionGralPV"
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        gintCodAlmacen = RsGral!CodAlmacen
    '''        gblnCapturarCantidadArts = RsGral!CapturarCantArts
    '''        gcurRedondeo = RsGral!Redondeo
    '''        gstrTipodeTrasfencia = RsGral!Transferencia
    '''        gbytPosicionesDecimal = RsGral!PosicionDecimal
    '''        gstrSimboloMonedaNacional = RsGral!SimboloMonedaNac
    '''        gcurEfectivoMaximoCaja = RsGral!EfectivoMaximo
    '''        'gstrRutaImagenLogotipo = Trim(RsGral!RutaImagen)
    '''        gstrRutaArchivoInvElectronico = Trim(RsGral!RutaArchivo)
    '''        gstrNomArchivoInvElectronico = Trim(RsGral!ArchivoInvElectronico)
    '''        gstrSeparador = RsGral!Separador
    '''        gbytEspacios = RsGral!Espacios
    '''        gblnPermitirVtassinExistencia = RsGral!PermitirVtaSinExistencia
    '''        gblnConsultarxDescripcion = RsGral!ConsultarXDescrip
    '''        gblnAutCambiarCodCapturado = RsGral!AutorizCambiarCodigoCapt
    '''        gblnAutSuprLineaCapturada = RsGral!AutorizCambiarLineaCapt
    '''        gblnAutAbandCapturaIniciada = RsGral!AutorizAbandonarCaptIni
    '''        gblnIndSiProdNoSoportaDescto = RsGral!IndicarSiProdNoSoportaDescto
    '''        gblnAutConsultaFoliosVta = RsGral!AutorizConsultarFoliosVta
    '''        gblnAutModificarDesctos = RsGral!AutorizModificarDesctos
    '''        gcurUtilMinporOperacion = RsGral!UtilMinXOperacion
    '''        gstrMensajeFiscal = Trim(RsGral!MsgFiscal)
    '''        gstrMensajeNormal = Trim(RsGral!MsgNormal)
    '''        gstrMensajeCredito = Trim(RsGral!MsgCredito)
    '''        gstrMensajeDevoluciones = (RsGral!MsgDevoluciones)
    '''        gcurCorpoPORCUTILMINOPERACION = RsGral!PorcUtilMinOperacion
    '''        gstrCorpoRUTAIMAGENES = Trim(RsGral!RutaImagenes)
    '''        gcurCorpoTASAIVA = RsGral!TasaIva
    '''        gstrCorpoNOMBREEMPRESA = Trim(RsGral!NombreEmp)
    '''        gstrNombCortoEmpresa = gstrCorpoNOMBREEMPRESA
    '''        gstrCorpoRFCEMPRESA = Trim(RsGral!RFCEmp)
    '''        gstrCorpoDOMICILIOEMPRESA = Trim(RsGral!DomicilioEmp)
    '''        gcurCorpoTIPOCAMBIODOLAR = RsGral!TipoCambio
    '''        gcurCorpoTIPOCAMBIOEURO = RsGral!TipoCambioEuro
    '''        If Left(Trim(RsGral!LapsoDifStock), 1) = "H" Then
    '''            gintLapsoDifStock = Numerico(Mid(Trim(RsGral!LapsoDifStock), 2, Len(Trim(RsGral!LapsoDifStock))))
    '''            gintLapsoDifStock = gintLapsoDifStock * 60
    '''        Else
    '''            gintLapsoDifStock = gintLapsoDifStock
    '''        End If
    '''        gstrCodificacionImportes = Trim(RsGral!Codificacion) & ".,"
    '''        gintCodAlmacenGral = ObtenerCodAlmacenGral
    '''    End If
    '''    Screen.MousePointer = vbDefault
    '''    Exit Sub
    '''MErr:
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''    'Resume
    '''End Sub

    Function ObtenerCodAlmacenGral() As Integer
        On Error GoTo Merr

        gStrSql = "SELECT CodAlmacen From dbo.CatAlmacen where (AlmGral = 1) "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        Select Case RsGral.RecordCount
            Case 0
                MsgBox("No ha Definido un Almacén General en el Sistema." & vbNewLine & "Verifique Por Favor.", MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, gstrCorpoNOMBREEMPRESA)
            Case 1
                ObtenerCodAlmacenGral = RsGral.Fields("CodAlmacen").Value
            Case Is > 1
                MsgBox("Se han Definido más de un Almacén General en el Sistema." & vbNewLine & "Verifique Por Favor.", MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, gstrCorpoNOMBREEMPRESA)
        End Select
        Exit Function
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function
    Function RedondearValor(ByRef Valor As Double, ByRef Tope As Double) As Double
        'Funcion que se utilizará para el redondeo, Propuesta por ANtonella, salio de su idea.
        On Error GoTo Errores
        Dim Entero As Integer
        Dim Cantidad As Double
        Dim Redondeo As Double

        Entero = CInt(Valor / Tope)
        Entero = Entero * Tope
        Cantidad = System.Math.Round(CDbl(Valor) - Entero, 4)
        Redondeo = System.Math.Round(Tope - Cantidad, 4)
        If Redondeo >= Tope Then
            Redondeo = Redondeo - Tope
        End If
        RedondearValor = Redondeo
Errores:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    '''CALCULABA INCORRECTAMENTE LIMITES INFERIOR-SUPERIOR Y DEJABA IMPORTE CON DECIMALES.
    '''Function RedondeoUnidadFinalANTERIOR(importe As Currency, Decimales As Currency) As Double
    '''   Dim ParteInf As Currency
    '''   Dim ParteSup As Currency
    '''   Dim ParteEnt As Currency
    '''   Dim ParteDec As Currency
    '''   Dim ParteUnidad As Currency
    '''
    '''   Dim LimInfIni As Currency
    '''   Dim LimInfFin As Currency
    '''   Dim LimSupIni As Currency
    '''   Dim LimSupFin As Currency
    '''
    '''   '''Determina limite inferior y superior del rango permitido
    '''   ParteDec = ((importe * 100) Mod 100) / 100
    '''   ParteInf = ((importe - ParteDec) \ Decimales) * Decimales
    '''   ParteSup = ParteInf + Decimales
    '''
    '''   '''Determina los limites Ini y Fin de los limites Inf y Sup
    '''   LimInfIni = ParteInf
    '''   LimInfFin = ParteInf + (Decimales / 2)
    '''   LimSupIni = ParteSup - (Decimales / 2) + 0.01
    '''   LimSupFin = ParteSup
    '''
    '''   Select Case importe
    '''          Case LimInfIni To LimInfFin
    '''               RedondeoUnidadFinal = -1 * (importe - ParteInf)
    '''          Case LimSupIni To LimSupFin
    '''               RedondeoUnidadFinal = (ParteSup - importe)
    '''   End Select
    '''
    '''   RedondeoUnidadFinal = Round(RedondeoUnidadFinal, 4)
    '''End Function

    Public Function RedondeoUnidadFinal(ByRef importe As Double, ByRef Decimales As Double) As Double
        Dim ParteInf As Double
        Dim ParteSup As Double
        Dim ParteEnt As Integer
        Dim ParteDec As Double

        Dim Limite As Double
        Dim LimInfIni As Double
        Dim LimInfFin As Double
        Dim LimSupIni As Double
        Dim LimSupFin As Double

        '''Determina limite inferior y superior del rango permitido
        ParteEnt = Fix(importe)
        ParteDec = System.Math.Round(System.Math.Abs(importe - ParteEnt), 4)
        Limite = ((importe - ParteDec) \ Decimales) * Decimales

        If Limite < importe Then
            ParteInf = ((importe - ParteDec) \ Decimales) * Decimales
            ParteSup = ParteInf + Decimales
        Else
            ParteSup = ((importe - ParteDec) \ Decimales) * Decimales
            ParteInf = ParteInf - Decimales
        End If

        '''Determina los limites Ini y Fin de los limites Inf y Sup
        LimInfIni = ParteInf
        LimInfFin = ParteInf + (Decimales / 2)
        LimSupIni = ParteSup - (Decimales / 2) + 0.01
        LimSupFin = ParteSup
        '''importe = Round(importe, 1)
        '''ojo
        importe = System.Math.Round(importe, 2)

        Select Case importe
            Case LimInfIni To LimInfFin
                RedondeoUnidadFinal = -1 * (importe - ParteInf)
            Case LimSupIni To LimSupFin
                RedondeoUnidadFinal = (ParteSup - importe)
        End Select
        RedondeoUnidadFinal = System.Math.Round(RedondeoUnidadFinal, 4)
    End Function

    'Function ObtenerParametrosPuntoVenta(CodSucursal As Integer) As Boolean
    '    Dim Pos, i As Integer
    '    gstrBasedeDatosPV = ""
    '    gstrServidorPV = ""
    '    gStrSql = "SELECT PuntoVenta FROM CatAlmacen WHERE CodAlmacen = " & CodSucursal & " AND TipoAlmacen = 'P'"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 800, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    If RsGral.RecordCount > 0 Then
    '        Pos = InStr(3, Trim(RsGral!PuntoVenta), "\")
    '        For i = Pos + 1 To Len(Trim(RsGral!PuntoVenta))
    '            gstrBasedeDatosPV = gstrBasedeDatosPV & Mid(Trim(RsGral!PuntoVenta), i, 1)
    '        Next
    '        For i = 3 To Pos - 1
    '            gstrServidorPV = gstrServidorPV & Mid(Trim(RsGral!PuntoVenta), i, 1)
    '        Next
    '        ObtenerParametrosPuntoVenta = True
    '    Else
    '        MsgBox "Esta Sucursal no Existe..", vbInformation + vbOKOnly, gstrNombCortoEmpresa
    '        ObtenerParametrosPuntoVenta = False
    '    End If
    'End Function

    Sub TicketVenta(ByRef Folio As String, ByRef CodCaja As Integer, ByRef Tipo As String) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Integer
        Dim J As Integer
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Integer
        Dim RDETALLE As Integer
        Dim RTOTALES As Integer
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        Dim cadena As String
        Dim CadenaAnt As String
        Dim UltimaSubCadena As String
        Dim SubCad As String

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasCab.TipoCambio " & "FROM         dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & "dbo.MovimientosVentasCab ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasCab.CodSucursal CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE     dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "' and dbo.MovimientosVentasCab.CodSucursal = " & gintCodAlmacen

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = " SELECT     dbo.MovimientosVentasCab.TipoCambio, dbo.MovimientosVentasCab.FolioVenta, dbo.MovimientosVentasCab.FechaVenta,CASE dbo.MovimientosVentasCab.Condicion WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO'  END AS TipoVenta , " & "dbo.CatVendedores.DescVendedor ,  dbo.MovimientosVentasCab.Nombre As DescCliente " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.CatVendedores ON dbo.MovimientosVentasCab.CodVendedor = dbo.CatVendedores.CodVendedor " & "WHERE   (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Folio
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaVenta").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM") 'Hora

            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = IIf(IsDBNull(RsGral.Fields("TipoVenta").Value), "", RsGral.Fields("TipoVenta").Value) 'TipoVenta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = "" 'Cajero
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("DescCliente").Value) 'Cliente
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Format(RsGral.Fields("TipoCambio").Value, gstrFormatoCantidad) 'Tipo de Cambio
        End If

        'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and   Codalmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & gintCodAlmacen & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")
            '''Encabez(I, 0) = RTrim(RsGral!Etiqueta)
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Tipo de Cambio"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14)
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            If Encabez(I, 4) = "S" Then
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                If Encabez(I, 3) > 0 Then
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & "SUM(MD.ImptePromociones + MD.ImpteDescuentos) AS ImpteDescuentos, MC.PorcIva, MD.IvaReal AS ImpteIva " & "FROM         MovimientosVentasDet MD INNER JOIN " & "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & "MovimientosVentasCab MC ON MC.FolioVenta = MD.FolioVenta " & "WHERE     (MD.FolioVenta = '" & Folio & "') " & "GROUP BY MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, MD.ImptePromociones, MC.PorcIva, MD.ImpteDescuentos, MD.IvaReal, " & "MD.PorcPromociones , MD.PorcDescuentos"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Integer
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            Valores(0) = recAux.Fields("CodArticulo").Value
            Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
            Valores(2) = recAux.Fields("Cantidad").Value
            Valores(3) = Format(recAux.Fields("PrecioLista").Value, gstrFormatoCantidad) 'pRECIO
            Valores(4) = Format(recAux.Fields("PorcDescuentos").Value, gstrFormatoCantidad) 'PORC dESCUENTO
            Valores(5) = Format(recAux.Fields("ImpteDescuentos").Value, gstrFormatoCantidad) 'iMPORTE DESCUENTO
            Valores(6) = Format(recAux.Fields("ImpteIva").Value, gstrFormatoCantidad) 'iMPORTE IVA
            Valores(7) = Format(recAux.Fields("PorcIva").Value, gstrFormatoCantidad) 'pORCENTAJE IVA
            RsGral.MoveFirst()
            For I = 0 To 16
                Detalle(I, 0) = ""
                Detalle(I, 1) = ""
                Detalle(I, 2) = ""
                Detalle(I, 3) = ""
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    Valor = Valores(2)
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    Valor = Valores(3)
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    Valor = Valores(4)
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    Valor = Valores(5)
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    Valor = Valores(6)
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    Valor = Valores(7)
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    If Detalle(I, 3) > 0 Then
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                If Detalle(I, 3) > 0 Then
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT     dbo.MovimientosVentasCab.Moneda , dbo.MovimientosVentasCab.FolioVenta,dbo.MovimientosVentasCab.SubTotal AS SubTotal, " & "dbo.MovimientosVentasCab.Descuento AS Descuento, " & "dbo.MovimientosVentasCab.Iva AS Iva,  dbo.MovimientosVentasCab.PorcIva, " & "dbo.MovimientosVentasCab.Redondeo AS Redondeo, " & "dbo.MovimientosVentasCab.Anticipo AS Anticipo, " & "Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio " & "FROM         dbo.MovimientosVentasCab left outer  JOIN " & "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto " & "WHERE dbo.MovimientosVentasCab.FolioVenta ='" & Folio & "' "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        For I = 1 To 7
            Valores(I) = 0
        Next
        Valores(9) = 0
        Valores(10) = 0
        Valores(8) = ""
        If RsGral.RecordCount > 0 Then

            Valores(0) = RsGral.Fields("SubTotal").Value 'Subtotal
            Valores(1) = RsGral.Fields("Descuento").Value 'Descuento sin IVA
            Valores(11) = RsGral.Fields("Descuento").Value * (1 + RsGral.Fields("PorcIva").Value / 100) 'Descuento con IVA
            Valores(2) = RsGral.Fields("Iva").Value 'IVA
            Valores(3) = RsGral.Fields("Redondeo").Value 'Redondeo
            'Total= Subtotal - Descuento + Iva + Redondeo
            Valores(4) = Format(System.Math.Round(RsGral.Fields("SubTotal").Value - RsGral.Fields("Descuento").Value + RsGral.Fields("Iva").Value + RsGral.Fields("Redondeo").Value, 2), gstrFormatoCantidad)
            Valores(5) = Format(System.Math.Round(Valores(4), 2), gstrFormatoCantidad) 'ImportePesos
            Valores(6) = Format(System.Math.Round(RsGral.Fields("cambio").Value, 2), gstrFormatoCantidad) 'CAmbio en Pesos
            Valores(7) = Format(System.Math.Round(RsGral.Fields("Totalingreso").Value, 2) + Valores(6)) 'Total Pago
            Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, CStr(2)), gstrFormatoCantidad) 'Imoprte total en pesos con letra
            Valores(9) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value, 1), gstrFormatoCantidad) 'Anticipo
            Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
            Valores(17) = IIf((RsGral.Fields("Moneda")).Value = "D", "DOLAR", "PESOS")
        End If

        '** Obtiene el Total de Piezas

        gStrSql = "SELECT     ISNULL(SUM(dbo.MovimientosVentasDet.Cantidad) , 0) AS Cantidad " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.MovimientosVentasDet ON dbo.MovimientosVentasCab.FolioVenta = dbo.MovimientosVentasDet.FolioVenta " & "WHERE     (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "') " & "GROUP BY dbo.MovimientosVentasCab.FolioVenta"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recTotPzas = Cmd.Execute
        Valores(12) = recTotPzas.Fields("Cantidad").Value 'Total Piezas
        recTotPzas = Nothing

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV where CodAlmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            Valores(16) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            '''Totales(I, 0) = RTrim(RsGral!Etiqueta) & IIf()
            Totales(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")

            Totales(I, 2) = RsGral.Fields("Columna").Value

            Totales(I, 3) = RsGral.Fields("Saltos").Value
            Totales(I, 4) = "C"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                    FinPal = False
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "SubTotal"
                                Valor = Valores(0)
                                Totales(I, 4) = "N"
                            Case "Descuento con IVA"
                                Valor = Valores(11)
                                Totales(I, 4) = "N"
                            Case "Descuento sin IVA"
                                Valor = Valores(1)
                                Totales(I, 4) = "N"
                            Case "I.V.A."
                                Valor = Valores(2)
                                Totales(I, 4) = "N"
                            Case "Redondeo"
                                Valor = Valores(3)
                                Totales(I, 4) = "N"
                            Case "Cantidad Letra"
                                Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                Totales(I, 4) = "CL" ' Indica que es la Cantidad con letra
                            Case "Importe"
                                Valor = Valores(4)
                                Totales(I, 4) = "N"
                            Case "Total Pesos"
                                Valor = Valores(5)
                                Totales(I, 4) = "N"
                            Case "Cambio"
                                Valor = Valores(6)
                                Totales(I, 4) = "N"
                            Case "Pago"
                                Valor = Valores(7)
                                Totales(I, 4) = "N"
                            Case "Mensaje Normal"
                                Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                Totales(I, 4) = "C"
                            Case "Mensaje Fiscal"
                                Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                Totales(I, 4) = "C"
                            Case "Formas de Pago"
                                Totales(I, 1) = "FORPAG"
                                Totales(I, 4) = "C"
                            Case "Total Piezas"
                                Valor = Valores(12)
                                Totales(I, 4) = "E"
                            Case "Anticipo"
                                Valor = Valores(9)
                                Totales(I, 4) = "N"
                            Case "Saldo"
                                Valor = Valores(10)
                                Totales(I, 4) = "N"
                            Case "Mensaje Crédito"
                                Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
                                Totales(I, 4) = "C"
                            Case "Moneda"
                                Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
                                Totales(I, 4) = "C"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                            SIMBOLO = "+"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                            SIMBOLO = "-"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Integer
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            If Totales(I, 4) = "C" Then
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount

                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
            ElseIf Totales(I, 4) = "CL" Then
                cadena = ""
                Totales(I, 1) = Totales(I, 1)
                For J = 1 To Len(Totales(I, 1)) Step 1

                    SubCad = Mid(Totales(I, 1), J, 1)
                    If SubCad = " " Then
                        If Len(cadena) >= COLS Then
                            PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                            cadena = UltimaSubCadena
                        Else
                            CadenaAnt = cadena
                        End If
                        UltimaSubCadena = ""
                    End If
                    cadena = cadena & SubCad
                    UltimaSubCadena = UltimaSubCadena & SubCad
                    If J = Len(Totales(I, 1)) Then
                        PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                    End If
                Next J
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then


                Totales(I, 3) = IIf((Totales(I, 4) = "CL"), (Totales(I, 3)) - 1, (Totales(I, 3)))

                For J = 1 To Totales(I, 3)
                    If Totales(I, 1) = "FORPAG" Then Linea = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'X = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
        '
    End Sub

    'Sub TicketVentaAnt(Folio As String, CodCaja As Integer, Tipo As String, CodSucursal As Integer)  ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
    '    On Error GoTo Errores
    '    'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
    '    'Caja  : Número de Caja, que imprime el Ticket
    '    Dim I As Byte
    '    Dim J As Byte
    '    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '    Dim recAux As Recordset
    '    Dim recTotPzas As Recordset
    '    Dim RENCABEZ As Byte
    '    Dim RDETALLE As Byte
    '    Dim RTOTALES As Byte
    '    Dim X As Variant
    '
    '    Dim Encabez(20, 4) As Variant   'Arreglo que contiene los Datos del Encabezado del Ticket
    '    Dim Detalle(20, 4) As Variant   'Arreglo que contiene los Datos del Detalle del Ticket
    '    Dim Totales(25, 4) As Variant   'Arreglo que contiene los Datos de los Totales del Ticket
    '
    '    Dim Valores(19) As Variant      'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '
    '    Dim PALABRA As String
    '    Dim TipoPrecio As String
    '    Dim ImpteIVACtes As Double
    '    Dim TipoCambio As Double
    '    Dim DesgloceFormas As Boolean
    '    Dim RenIniDesg As Integer
    '    Dim ColIniDesg As Integer
    '    Dim FormatoCantidad As String       'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.
    '
    '    Dim cadena As String
    '    Dim CadenaAnt As String
    '    Dim UltimaSubCadena As String
    '    Dim SubCad As String
    '
    '    ' ** Obtiene Valores para la Fórmula
    '    '***** ENCABEZADO *****'
    '    For I = 0 To 19
    '        Valores(I) = ""
    '    Next I
    '
    '    gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & _
    ''                      "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & _
    ''                      "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasCab.TipoCambio " & _
    ''            "FROM         dbo.CatAlmacen INNER JOIN " & _
    ''                      "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & _
    ''                      "dbo.MovimientosVentasCab ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasCab.CodSucursal CROSS JOIN " & _
    ''                      "dbo.ConfiguracionGeneral " & _
    ''            "WHERE     dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "' and dbo.MovimientosVentasCab.CodSucursal = " & CodSucursal
    '
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    If RsGral.RecordCount > 0 Then
    '        TipoCambio = RsGral!TipoCambio
    '        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '        Valores(2) = ""                                                     'Ciudad Empresa
    '        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '        Valores(5) = ""                                                     'Ciudad Sucursal
    '        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '    Else
    '        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '        Exit Sub
    '        For I = 0 To 6
    '            Valores(I) = RsGral.Fields(Val(I))
    '        Next I
    '    End If
    '
    '    gStrSql = " SELECT     dbo.MovimientosVentasCab.TipoCambio, dbo.MovimientosVentasCab.FolioVenta, dbo.MovimientosVentasCab.FechaVenta,CASE dbo.MovimientosVentasCab.Condicion WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO'  END AS TipoVenta , " & _
    ''                "dbo.CatVendedores.DescVendedor ,  dbo.MovimientosVentasCab.Nombre As DescCliente " & _
    ''                "FROM         dbo.MovimientosVentasCab INNER JOIN " & _
    ''                "dbo.CatVendedores ON dbo.MovimientosVentasCab.CodVendedor = dbo.CatVendedores.CodVendedor " & _
    ''                "WHERE   (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "')"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    If RsGral.RecordCount > 0 Then
    '        Valores(7) = Folio
    '        Valores(8) = Format(RsGral!FechaVenta, "DD/MMM/YYYY")   'Fecha
    '        Valores(9) = Format(Now, "HH:MM AMPM")          'Hora
    '        Valores(10) = RsGral!TipoVenta                          'TipoVenta
    '        Valores(11) = ""                                        'Cajero
    '        Valores(12) = Trim(RsGral!DescVendedor)                 'Vendedor
    '        Valores(13) = Trim(RsGral!DescCliente)                  'Cliente
    '        Valores(14) = Format(RsGral!TipoCambio, gstrFormatoCantidad)                  'Tipo de Cambio
    '    End If
    '
    '    'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
    '    gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and   Codalmacen = " & CodSucursal
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '     If RsGral.RecordCount > 0 Then COLS = RsGral!Columna
    '
    '    'Obtener los valores de las formulas de la configuracion de Tickets.
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON "
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RENCABEZ = RsGral.RecordCount
    '    For I = 1 To RENCABEZ
    '        Encabez(I, 0) = RTrim(RsGral!Etiqueta) + IIf(Trim(RsGral!Etiqueta) = "", "", " ")
    '        'Encabez(I, 0) = RTrim(RsGral!Etiqueta)
    '        Encabez(I, 2) = RsGral!Columna
    '        Encabez(I, 3) = RsGral!Saltos
    '        If Trim(RsGral!Formula) <> "" Then
    '            PALABRA = ""
    '            For J = 1 To Len(Trim(RsGral!Formula))
    '                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" Then
    '                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                    Encabez(I, 4) = "S"
    '                    Select Case PALABRA
    '                        Case "Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '                        Case "Dirección Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '                        Case "Ciudad Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '                        Case "Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '                        Case "Dirección Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '                        Case "Ciudad Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '                        Case "RFC"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '                        Case "Folio"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    '                        Case "Fecha"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '                        Case "Hora"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
    '                        Case "Tipo de Venta"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
    '                        Case "Cajero"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
    '                        Case "Vendedor"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
    '                        Case "Cliente"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
    '                        Case "Tipo de Cambio"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(14)
    '                    End Select
    '                    PALABRA = ""
    '                End If
    '            Next J
    '        End If
    '        RsGral.MoveNext
    '    Next I
    '
    'Continuar:
    '    '***************************************************************
    '    'Impresión de la primera parte del Ticket, Encabezado
    '    '***************************************************************
    '    Open gstrTicketPrinter For Output As #1
    '    'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '    Dim Linea As String
    '    Print #1, Chr(27) + Chr(33) + Chr(1)
    '    For I = 1 To RENCABEZ
    '        If Encabez(I, 4) = "S" Then
    '            Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '            If Encabez(I, 3) > 0 Then
    '                For J = 1 To Encabez(I, 3)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    Linea = ""
    '                Next J
    '            End If
    '        End If
    '    Next I
    '
    '    'Obtener los valores para la formula, para la impresión del detalle del Ticket
    '    gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & _
    ''                    "SUM(MD.ImptePromociones + MD.ImpteDescuentos) AS ImpteDescuentos, MC.PorcIva, MD.IvaReal AS ImpteIva " & _
    ''                "FROM         MovimientosVentasDet MD INNER JOIN " & _
    ''                    "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & _
    ''                    "MovimientosVentasCab MC ON MC.FolioVenta = MD.FolioVenta " & _
    ''                "WHERE     (MD.FolioVenta = '" & Folio & "') " & _
    ''                "GROUP BY MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, MD.ImptePromociones, MC.PorcIva, MD.ImpteDescuentos, MD.IvaReal, " & _
    ''                    "MD.PorcPromociones , MD.PorcDescuentos"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recAux = Cmd.Execute
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RDETALLE = RsGral.RecordCount
    '    Dim SIMBOLO As String
    '    Dim Valor As Double
    '    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '    Dim Encabezado As Boolean
    '    Dim H As Byte
    '    SIMBOLO = "+"
    '    Encabezado = True
    '    recAux.MoveFirst
    '    For H = 1 To recAux.RecordCount
    '        Valores(0) = recAux!CodArticulo
    '        Valores(1) = Trim(recAux!DescArticulo)
    '        Valores(2) = recAux!Cantidad
    '        Valores(3) = Format(recAux!PrecioLista, gstrFormatoCantidad)      'pRECIO
    '        Valores(4) = Format(recAux!PorcDescuentos, gstrFormatoCantidad)   'PORC dESCUENTO
    '        Valores(5) = Format(recAux!ImpteDescuentos, gstrFormatoCantidad)  'iMPORTE DESCUENTO
    '        Valores(6) = Format(recAux!ImpteIva, gstrFormatoCantidad)         'iMPORTE IVA
    '        Valores(7) = Format(recAux!PorcIva, gstrFormatoCantidad)          'pORCENTAJE IVA
    '        RsGral.MoveFirst
    '        For I = 0 To 16
    '            Detalle(I, 0) = ""
    '            Detalle(I, 1) = ""
    '            Detalle(I, 2) = ""
    '            Detalle(I, 3) = ""
    '            Detalle(I, 4) = ""
    '        Next I
    '
    '        'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
    '        For I = 1 To RDETALLE
    '            Detalle(I, 0) = Right(Space(10) + Trim(RsGral!Etiqueta), 10)
    '            Detalle(I, 2) = RsGral!Columna
    '            Detalle(I, 3) = RsGral!Saltos
    '            If Trim(RsGral!Formula) <> "" Then
    '                PALABRA = ""
    '                For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '                    FinPal = False
    '                    If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '                        PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                        FinPal = True
    '                        Select Case PALABRA
    '                            Case "Código"
    '                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '                                Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
    '                                Detalle(I, 4) = "C"
    '                            Case "Descripción"
    '                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '                                Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
    '                                Detalle(I, 4) = "C"
    '                            Case "Cantidad"
    '                                Valor = Valores(2)
    '                                Detalle(I, 4) = Detalle(I, 4) + "E"   'SIGNIFICA QUE ES UN DATO ENTERO
    '                            Case "Precio Público"
    '                                Valor = Valores(3)
    '                                Detalle(I, 4) = Detalle(I, 4) + "D"
    '                            Case "% Descuento"
    '                                Valor = Valores(4)
    '                                Detalle(I, 4) = "D"
    '                            Case "$ Descuento"
    '                                Valor = Valores(5)
    '                                Detalle(I, 4) = "D"
    '                            Case "$ IVA"
    '                                Valor = Valores(6)
    '                                Detalle(I, 4) = "D"
    '                            Case "% IVA"
    '                                Valor = Valores(7)
    '                                Detalle(I, 4) = "D"
    '                        End Select
    '                        PALABRA = ""
    '                        J = J + 1
    '                        If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
    '                            If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
    '                            If SIMBOLO = "+" Then
    '                                Detalle(I, 1) = Detalle(I, 1) + Valor
    '                            ElseIf SIMBOLO = "-" Then
    '                                Detalle(I, 1) = Detalle(I, 1) - Valor
    '                            ElseIf SIMBOLO = "*" Then
    '                                Detalle(I, 1) = Detalle(I, 1) * Valor
    '                            End If
    '                        End If
    '                        If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '                            SIMBOLO = "+"
    '                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '                            SIMBOLO = "-"
    '                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "x" Then
    '                            SIMBOLO = "*"
    '                        End If
    '                    End If
    '                Next J
    '            End If
    '            RsGral.MoveNext
    '        Next I
    '        '*** Encabezado del Detalle
    '        If Encabezado Then
    '            Encabezado = False
    '            Print #1, LineaSepara(COLS)
    '            For I = 1 To RDETALLE
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
    '                If Detalle(I, 3) > 0 Then
    '                    For J = 1 To Detalle(I, 3)
    '                        Print #1, Left(RTrim(Linea), COLS)
    '                        Linea = ""
    '                    Next J
    '                End If
    '            Next I
    '            Print #1, LineaSepara(COLS)
    '        End If
    '
    '        ''''***** DETALLE *****
    '        For I = 1 To RDETALLE
    '            If Detalle(I, 4) = "C" Then
    '                'Se trata de un dato caracter
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
    '            ElseIf Detalle(I, 4) = "E" Then
    '                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
    '                If gbytPosicionesDecimal = 0 Then
    '                    FormatoCantidad = 0
    '                Else
    '                    FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '                End If
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
    '            Else
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), "###,###,##0.00"), 10)
    '            End If
    '            If Detalle(I, 3) > 0 Then
    '                For J = 1 To Detalle(I, 3)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    Linea = ""
    '                Next J
    '            End If
    '        Next I
    '        recAux.MoveNext
    '    Next H
    '    '***** TOTALES *****}
    '    gStrSql = "SELECT     dbo.MovimientosVentasCab.Moneda , dbo.MovimientosVentasCab.FolioVenta,dbo.MovimientosVentasCab.SubTotal AS SubTotal, " & _
    ''            "dbo.MovimientosVentasCab.Descuento AS Descuento, " & _
    ''            "dbo.MovimientosVentasCab.Iva AS Iva,  dbo.MovimientosVentasCab.PorcIva, " & _
    ''            "dbo.MovimientosVentasCab.Redondeo AS Redondeo, " & _
    ''            "dbo.MovimientosVentasCab.Anticipo AS Anticipo, " & _
    ''            "Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & _
    ''            "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio " & _
    ''            "FROM         dbo.MovimientosVentasCab left outer  JOIN " & _
    ''            "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto " & _
    ''            "WHERE dbo.MovimientosVentasCab.FolioVenta ='" & Folio & "' "
    '            ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '
    '    For I = 1 To 7
    '        Valores(I) = 0
    '    Next
    '    Valores(9) = 0
    '    Valores(10) = 0
    '    Valores(8) = ""
    '    If RsGral.RecordCount > 0 Then
    '
    '        Valores(0) = RsGral!SubTotal                                    'Subtotal
    '        Valores(1) = RsGral!Descuento                                   'Descuento sin IVA
    '        Valores(11) = RsGral!Descuento * (1 + RsGral!PorcIva / 100)    'Descuento con IVA
    '        Valores(2) = RsGral!Iva                                         'IVA
    '        Valores(3) = RsGral!Redondeo                                    'Redondeo
    '        'Total= Subtotal - Descuento + Iva + Redondeo
    '        Valores(4) = Format(Round(RsGral!SubTotal - RsGral!Descuento + RsGral!Iva + RsGral!Redondeo, 2), gstrFormatoCantidad)
    '        Valores(5) = Format(Round(Valores(4), 2), gstrFormatoCantidad)               'ImportePesos
    '        Valores(6) = Format(Round(RsGral!cambio, 2), gstrFormatoCantidad)           'CAmbio en Pesos
    '        Valores(7) = Format(Round(RsGral!Totalingreso, 2) + Valores(6))               'Total Pago
    '        Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, 2), gstrFormatoCantidad)      'Imoprte total en pesos con letra
    '        Valores(9) = Format(Round(RsGral!Anticipo, 1), gstrFormatoCantidad)          'Anticipo
    '        Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
    '        Valores(17) = IIf((RsGral!Moneda) = "D", "DOLAR", "PESOS")
    '    End If
    '
    '    '** Obtiene el Total de Piezas
    '
    '    gStrSql = "SELECT     ISNULL(SUM(dbo.MovimientosVentasDet.Cantidad) , 0) AS Cantidad " & _
    ''                "FROM         dbo.MovimientosVentasCab INNER JOIN " & _
    ''                        "dbo.MovimientosVentasDet ON dbo.MovimientosVentasCab.FolioVenta = dbo.MovimientosVentasDet.FolioVenta " & _
    ''                "WHERE     (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "') " & _
    ''                "GROUP BY dbo.MovimientosVentasCab.FolioVenta"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recTotPzas = Cmd.Execute
    '    Valores(12) = recTotPzas!Cantidad                'Total Piezas
    '    Set recTotPzas = Nothing
    '
    '    gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV where CodAlmacen = " & CodSucursal
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recAux = Cmd.Execute
    '    If recAux.RecordCount > 0 Then
    '        Valores(13) = Trim(recAux!MsgNormal)
    '        Valores(14) = Trim(recAux!MsgFiscal)
    '        Valores(16) = Trim(recAux!MsgCredito)
    '    End If
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RTOTALES = RsGral.RecordCount
    '    For I = 1 To RTOTALES
    '        Totales(I, 0) = RTrim(RsGral!Etiqueta)
    '        Totales(I, 2) = RsGral!Columna
    '        Totales(I, 3) = RsGral!Saltos
    '        Totales(I, 4) = "C"
    '        If Trim(RsGral!Formula) <> "" Then
    '            PALABRA = ""
    '            For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '                FinPal = False
    '                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                    FinPal = True
    '                    Select Case PALABRA
    '                        Case "SubTotal"
    '                            Valor = Valores(0)
    '                            Totales(I, 4) = "N"
    '                        Case "Descuento con IVA"
    '                            Valor = Valores(11)
    '                            Totales(I, 4) = "N"
    '                        Case "Descuento sin IVA"
    '                            Valor = Valores(1)
    '                            Totales(I, 4) = "N"
    '                        Case "I.V.A."
    '                            Valor = Valores(2)
    '                            Totales(I, 4) = "N"
    '                        Case "Redondeo"
    '                            Valor = Valores(3)
    '                            Totales(I, 4) = "N"
    '                        Case "Cantidad Letra"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
    '                            Totales(I, 4) = "CL"  ' Indica que es la Cantidad con letra
    '                        Case "Importe"
    '                            Valor = Valores(4)
    '                            Totales(I, 4) = "N"
    '                        Case "Total Pesos"
    '                            Valor = Valores(5)
    '                            Totales(I, 4) = "N"
    '                        Case "Cambio"
    '                            Valor = Valores(6)
    '                            Totales(I, 4) = "N"
    '                        Case "Pago"
    '                            Valor = Valores(7)
    '                            Totales(I, 4) = "N"
    '                        Case "Mensaje Normal"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Mensaje Fiscal"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Formas de Pago"
    '                            Totales(I, 1) = "FORPAG"
    '                            Totales(I, 4) = "C"
    '                        Case "Total Piezas"
    '                            Valor = Valores(12)
    '                            Totales(I, 4) = "E"
    '                        Case "Anticipo"
    '                            Valor = Valores(9)
    '                            Totales(I, 4) = "N"
    '                        Case "Saldo"
    '                            Valor = Valores(10)
    '                            Totales(I, 4) = "N"
    '                        Case "Mensaje Crédito"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Moneda"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
    '                            Totales(I, 4) = "C"
    '                    End Select
    '                    PALABRA = ""
    '                    J = J + 1
    '                    If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
    '                        If Totales(I, 1) = "" Then Totales(I, 1) = 0
    '                        If SIMBOLO = "+" Then
    '                            Totales(I, 1) = Totales(I, 1) + Valor
    '                        ElseIf SIMBOLO = "-" Then
    '                            Totales(I, 1) = Totales(I, 1) - Valor
    '                        ElseIf SIMBOLO = "*" Then
    '                            Totales(I, 1) = Totales(I, 1) * Valor
    '                        End If
    '                    End If
    '                    If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '                        SIMBOLO = "+"
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '                        SIMBOLO = "-"
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = "*" Then
    '                        SIMBOLO = "*"
    '                    End If
    '                End If
    '            Next J
    '        End If
    '        RsGral.MoveNext
    '    Next I
    '    For I = 1 To RTOTALES
    '        If Totales(I, 4) = "C" Then
    '            If Totales(I, 1) = "FORPAG" Then
    '                Dim D As Byte
    '                Dim recDesg As Recordset
    '                gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & _
    ''                            "FROM         dbo.CatFormasPago INNER JOIN " & _
    ''                            "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & _
    ''                            "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & _
    ''                            "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & _
    ''                            "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
    '                ModEstandar.BorraCmd
    '                Cmd.CommandText = "dbo.Up_Select_Datos"
    '                Cmd.CommandType = adCmdStoredProc
    '                Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '                Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '                Set recDesg = Cmd.Execute
    '                For D = 1 To recDesg.RecordCount
    '                    Linea = Space(Totales(I, 2)) + Left(recDesg!DescFormaPago + Space(16), 16) + Right(Space(10) + Format(recDesg!importe, "###,###,##0.00"), 10)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    recDesg.MoveNext
    '                Next D
    '            Else
    '                Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
    '            End If
    '        ElseIf Totales(I, 4) = "E" Then
    '            If gbytPosicionesDecimal = 0 Then
    '                FormatoCantidad = 0
    '            Else
    '                FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '            End If
    '            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Right(Space(10) + Format(Totales(I, 1), FormatoCantidad), 10)
    '        ElseIf Totales(I, 4) = "CL" Then
    '            cadena = ""
    '            Totales(I, 1) = Totales(I, 1)
    '            For J = 1 To Len(Totales(I, 1)) Step 1
    '                SubCad = Mid(Totales(I, 1), J, 1)
    '                If SubCad = " " Then
    '                    If Len(cadena) >= COLS Then
    '                        Print #1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt)
    '                        cadena = UltimaSubCadena
    '                    Else
    '                        CadenaAnt = cadena
    '                    End If
    '                    UltimaSubCadena = ""
    '                End If
    '                cadena = cadena + SubCad
    '                UltimaSubCadena = UltimaSubCadena + SubCad
    '                If J = Len(Totales(I, 1)) Then
    '                    Print #1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt)
    '                End If
    '            Next J
    '        Else
    '            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Right(Space(10) + Format(Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
    '        End If
    '        If Totales(I, 3) > 0 Then
    '            Totales(I, 3) = IIf((Totales(I, 4) = "CL"), (Totales(I, 3)) - 1, (Totales(I, 3)))
    '            For J = 1 To Totales(I, 3)
    '                If Totales(I, 1) = "FORPAG" Then Linea = ""
    '                Print #1, Left(RTrim(Linea), COLS)
    '                Linea = ""
    '            Next J
    '        End If
    '    Next I
    '
    '    For I = 1 To 4
    '        Print #1, ""
    '    Next I
    '
    '    '''Cortar Papel
    '    Print #1, Chr(27) + Chr(105)
    '    Close #1
    '    'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
    '    'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
    '    Erase Encabez
    '    Erase Detalle
    '    Erase Totales
    '    Erase Valores
    '    Set recAux = Nothing
    'Errores:
    '    If Err.Number = 55 Then
    '        Close #1
    '        Err.Clear
    '        GoTo Continuar
    '    End If
    '    If Err.Number <> 0 Then ModEstandar.MostrarError
    'End Sub

    Sub TicketVentaPesos(ByRef Folio As String, ByRef CodCaja As Integer, ByRef Tipo As String) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Integer
        Dim J As Integer
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Integer
        Dim RDETALLE As Integer
        Dim RTOTALES As Integer
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        Dim cadena As String
        Dim CadenaAnt As String
        Dim UltimaSubCadena As String
        Dim SubCad As String

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasCab.TipoCambio " & "FROM         dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & "dbo.MovimientosVentasCab ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasCab.CodSucursal CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE     dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "' and dbo.MovimientosVentasCab.CodSucursal = " & gintCodAlmacen

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = " SELECT     dbo.MovimientosVentasCab.TipoCambio, dbo.MovimientosVentasCab.FolioVenta, dbo.MovimientosVentasCab.FechaVenta,CASE dbo.MovimientosVentasCab.Condicion WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO'  END AS TipoVenta , " & "dbo.CatVendedores.DescVendedor ,  dbo.MovimientosVentasCab.Nombre As DescCliente " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.CatVendedores ON dbo.MovimientosVentasCab.CodVendedor = dbo.CatVendedores.CodVendedor " & "WHERE   (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Folio
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaVenta").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM") 'Hora

            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = IIf(IsDBNull(RsGral.Fields("TipoVenta").Value), "", RsGral.Fields("TipoVenta").Value) 'TipoVenta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = "" 'Cajero
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("DescCliente").Value) 'Cliente
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Format(RsGral.Fields("TipoCambio").Value, gstrFormatoCantidad) 'Tipo de Cambio
        End If

        'BUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and  CodAlmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & gintCodAlmacen & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")
            '''Encabez(I, 0) = RTrim(RsGral!Etiqueta) + " "
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Tipo de Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14)
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & "SUM(MD.ImptePromociones + MD.ImpteDescuentos) AS ImpteDescuentos, MC.PorcIva, MD.IvaReal AS ImpteIva " & "FROM         MovimientosVentasDet MD INNER JOIN " & "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & "MovimientosVentasCab MC ON MC.FolioVenta = MD.FolioVenta " & "WHERE     (MD.FolioVenta = '" & Folio & "') " & "GROUP BY MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, MD.ImptePromociones, MC.PorcIva, MD.ImpteDescuentos, MD.IvaReal, " & "MD.PorcPromociones , MD.PorcDescuentos"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Integer
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = recAux.Fields("CodArticulo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = recAux.Fields("Cantidad").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(System.Math.Round(recAux.Fields("PrecioLista").Value * TipoCambio, 1), gstrFormatoCantidad) 'pRECIO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(recAux.Fields("PorcDescuentos").Value, gstrFormatoCantidad) 'PORC dESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(recAux.Fields("ImpteDescuentos").Value * TipoCambio, 1), gstrFormatoCantidad) 'iMPORTE DESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format(System.Math.Round(recAux.Fields("ImpteIva").Value * TipoCambio, 1), gstrFormatoCantidad) 'iMPORTE IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(recAux.Fields("PorcIva").Value, gstrFormatoCantidad) 'pORCENTAJE IVA
            RsGral.MoveFirst()
            For I = 0 To 16
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(6)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(7)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT     dbo.MovimientosVentasCab.Moneda , dbo.MovimientosVentasCab.FolioVenta,dbo.MovimientosVentasCab.SubTotal AS SubTotal, " & "dbo.MovimientosVentasCab.Descuento AS Descuento, " & "dbo.MovimientosVentasCab.Iva AS Iva,  dbo.MovimientosVentasCab.PorcIva, " & "dbo.MovimientosVentasCab.Redondeo AS Redondeo, " & "dbo.MovimientosVentasCab.Anticipo AS Anticipo, " & "Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio " & "FROM         dbo.MovimientosVentasCab left outer  JOIN " & "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto " & "WHERE dbo.MovimientosVentasCab.FolioVenta ='" & Folio & "' "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        For I = 1 To 7
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = 0
        Next
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ""
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = System.Math.Round(RsGral.Fields("SubTotal").Value * TipoCambio, 1) 'Subtotal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = System.Math.Round(RsGral.Fields("Descuento").Value * TipoCambio, 1) 'Descuento sin IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = System.Math.Round(RsGral.Fields("Descuento").Value * (1 + RsGral.Fields("PorcIva").Value / 100) * TipoCambio, 1) 'Descuento con IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = System.Math.Round(RsGral.Fields("Iva").Value * TipoCambio, 1) 'IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = System.Math.Round(RsGral.Fields("Redondeo").Value * TipoCambio, 1) 'Redondeo
            'Total= Subtotal - Descuento + Iva + Redondeo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(System.Math.Round(RsGral.Fields("SubTotal").Value - RsGral.Fields("Descuento").Value + RsGral.Fields("Iva").Value + RsGral.Fields("Redondeo").Value, 2), gstrFormatoCantidad)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(Valores(4) * TipoCambio, 1), gstrFormatoCantidad) 'ImportePesos
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format(System.Math.Round(RsGral.Fields("cambio").Value * TipoCambio, 1), gstrFormatoCantidad) 'CAmbio en Pesos
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(System.Math.Round(RsGral.Fields("Totalingreso").Value * TipoCambio, 1) + Valores(6)) 'Total Pago
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, CStr(1)), gstrFormatoCantidad) 'Imoprte total en pesos con letra
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value * TipoCambio, 1), gstrFormatoCantidad) 'Anticipo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
            'El Descuento siguiente se le agregará el Iva
            'Valores(11) = Format(Round(RsGral!Descuento * (1 + RsGral!PorcIva / 100), 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(17). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(17) = IIf((RsGral.Fields("Moneda")).Value = "D", "DOLAR", "PESOS")
        End If


        '** Obtiene el Total de Piezas

        gStrSql = "SELECT     ISNULL(SUM(dbo.MovimientosVentasDet.Cantidad) , 0) AS Cantidad " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.MovimientosVentasDet ON dbo.MovimientosVentasCab.FolioVenta = dbo.MovimientosVentasDet.FolioVenta " & "WHERE     (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "') " & "GROUP BY dbo.MovimientosVentasCab.FolioVenta"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recTotPzas = Cmd.Execute
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = recTotPzas.Fields("Cantidad").Value 'Total Piezas
        'UPGRADE_NOTE: Object recTotPzas may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        recTotPzas = Nothing

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV  where Codalmacen = " & gintCodAlmacen

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(16) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            '''Totales(I, 0) = RTrim(RsGral!Etiqueta)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")

            Totales(I, 2) = RsGral.Fields("Columna").Value

            Totales(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 4) = "C"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                    FinPal = False
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "SubTotal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(0)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Descuento con IVA"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(11)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Descuento sin IVA"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "I.V.A."
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(2)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Redondeo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(3)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Cantidad Letra"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "CL" ' Indica que es la Cantidad con letra
                            Case "Importe"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(4)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Total Pesos"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(5)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(6)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Pago"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(7)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Normal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Mensaje Fiscal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Formas de Pago"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = "FORPAG"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Total Piezas"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(12)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "E"
                            Case "Anticipo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(9)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Saldo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(10)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Crédito"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Moneda"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(17). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                            SIMBOLO = "+"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                            SIMBOLO = "-"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Integer
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount

                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "CL" Then
                cadena = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 1) = Totales(I, 1)
                For J = 1 To Len(Totales(I, 1)) Step 1

                    SubCad = Mid(Totales(I, 1), J, 1)
                    If SubCad = " " Then
                        If Len(cadena) >= COLS Then
                            'CadenaImp = CadenaAnt
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                            PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                            cadena = UltimaSubCadena
                        Else
                            CadenaAnt = cadena
                        End If
                        UltimaSubCadena = ""
                    End If
                    cadena = cadena & SubCad
                    UltimaSubCadena = UltimaSubCadena & SubCad
                    If J = Len(Totales(I, 1)) Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                        PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                    End If
                Next J
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) >= 0 Then


                Totales(I, 3) = IIf((Totales(I, 4) = "CL"), (Totales(I, 3)) - 1, (Totales(I, 3)))

                For J = 1 To Totales(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Totales(I, 1) = "FORPAG" Then Linea = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'X = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
        '
    End Sub

    'Sub TicketVentaPesosAnt(Folio As String, CodCaja As Integer, Tipo As String, CodSucursal As Integer)  ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
    '    On Error GoTo Errores
    '    'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
    '    'Caja  : Número de Caja, que imprime el Ticket
    '    Dim I As Byte
    '    Dim J As Byte
    '    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '    Dim recAux As Recordset
    '    Dim recTotPzas As Recordset
    '    Dim RENCABEZ As Byte
    '    Dim RDETALLE As Byte
    '    Dim RTOTALES As Byte
    '    Dim X As Variant
    '
    '    Dim Encabez(20, 4) As Variant   'Arreglo que contiene los Datos del Encabezado del Ticket
    '    Dim Detalle(20, 4) As Variant   'Arreglo que contiene los Datos del Detalle del Ticket
    '    Dim Totales(25, 4) As Variant   'Arreglo que contiene los Datos de los Totales del Ticket
    '
    '    Dim Valores(19) As Variant      'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '
    '    Dim PALABRA As String
    '    Dim TipoPrecio As String
    '    Dim ImpteIVACtes As Double
    '    Dim TipoCambio As Double
    '    Dim DesgloceFormas As Boolean
    '    Dim RenIniDesg As Integer
    '    Dim ColIniDesg As Integer
    '    Dim FormatoCantidad As String       'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.
    '
    '    Dim Cadena As String
    '    Dim CadenaAnt As String
    '    Dim UltimaSubCadena As String
    '    Dim SubCad As String
    '
    '    ' ** Obtiene Valores para la Fórmula
    '    '***** ENCABEZADO *****'
    '    For I = 0 To 19
    '        Valores(I) = ""
    '    Next I
    '
    '    gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & _
    ''                      "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & _
    ''                      "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasCab.TipoCambio " & _
    ''            "FROM         dbo.CatAlmacen INNER JOIN " & _
    ''                      "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & _
    ''                      "dbo.MovimientosVentasCab ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasCab.CodSucursal CROSS JOIN " & _
    ''                      "dbo.ConfiguracionGeneral " & _
    ''            "WHERE     dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "' and dbo.MovimientosVentasCab.CodSucursal = " & CodSucursal
    '
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    If RsGral.RecordCount > 0 Then
    '        TipoCambio = RsGral!TipoCambio
    '        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '        Valores(2) = ""                                                     'Ciudad Empresa
    '        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '        Valores(5) = ""                                                     'Ciudad Sucursal
    '        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '    Else
    '        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '        Exit Sub
    '        For I = 0 To 6
    '            Valores(I) = RsGral.Fields(Val(I))
    '        Next I
    '    End If
    '
    '    gStrSql = " SELECT     dbo.MovimientosVentasCab.TipoCambio, dbo.MovimientosVentasCab.FolioVenta, dbo.MovimientosVentasCab.FechaVenta,CASE dbo.MovimientosVentasCab.Condicion WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO'  END AS TipoVenta , " & _
    ''                "dbo.CatVendedores.DescVendedor ,  dbo.MovimientosVentasCab.Nombre As DescCliente " & _
    ''                "FROM         dbo.MovimientosVentasCab INNER JOIN " & _
    ''                "dbo.CatVendedores ON dbo.MovimientosVentasCab.CodVendedor = dbo.CatVendedores.CodVendedor " & _
    ''                "WHERE   (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "')"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    If RsGral.RecordCount > 0 Then
    '        Valores(7) = Folio
    '        Valores(8) = Format(RsGral!FechaVenta, "DD/MMM/YYYY")   'Fecha
    '        Valores(9) = Format(Now, "HH:MM AMPM")          'Hora
    '        Valores(10) = RsGral!TipoVenta                          'TipoVenta
    '        Valores(11) = ""                                        'Cajero
    '        Valores(12) = Trim(RsGral!DescVendedor)                 'Vendedor
    '        Valores(13) = Trim(RsGral!DescCliente)                  'Cliente
    '        Valores(14) = Format(RsGral!TipoCambio, gstrFormatoCantidad)                  'Tipo de Cambio
    '    End If
    '
    '    'BUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
    '    gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and  CodAlmacen = " & CodSucursal
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '     If RsGral.RecordCount > 0 Then COLS = RsGral!Columna
    '
    '    'Obtener los valores de las formulas de la configuracion de Tickets.
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON "
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RENCABEZ = RsGral.RecordCount
    '    For I = 1 To RENCABEZ
    '        Encabez(I, 0) = RTrim(RsGral!Etiqueta) + " "
    '        Encabez(I, 2) = RsGral!Columna
    '        Encabez(I, 3) = RsGral!Saltos
    '        Encabez(I, 4) = "S"
    '        If Trim(RsGral!Formula) <> "" Then
    '            PALABRA = ""
    '            For J = 1 To Len(Trim(RsGral!Formula))
    '                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" Then
    '                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                    Encabez(I, 4) = "S"
    '                    Select Case PALABRA
    '                        Case "Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '                        Case "Dirección Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '                        Case "Ciudad Empresa"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '                        Case "Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '                        Case "Dirección Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '                        Case "Ciudad Sucursal"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '                        Case "RFC"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '                        Case "Folio"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    '                        Case "Fecha"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '                        Case "Hora"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
    '                        Case "Tipo de Venta"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
    '                        Case "Cajero"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
    '                        Case "Vendedor"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
    '                        Case "Cliente"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
    '                        Case "Tipo de Cambio"
    '                            Encabez(I, 1) = Encabez(I, 1) + Valores(14)
    '                    End Select
    '                    PALABRA = ""
    '                End If
    '            Next J
    '        End If
    '        RsGral.MoveNext
    '    Next I
    '
    'Continuar:
    '    '***************************************************************
    '    'Impresión de la primera parte del Ticket, Encabezado
    '    '***************************************************************
    '    Open gstrTicketPrinter For Output As #1
    '    'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '    Dim Linea As String
    '    Print #1, Chr(27) + Chr(33) + Chr(1)
    '    For I = 1 To RENCABEZ
    '        If Encabez(I, 4) = "S" Then
    '            Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '            If Encabez(I, 3) > 0 Then
    '                For J = 1 To Encabez(I, 3)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    Linea = ""
    '                Next J
    '            End If
    '        End If
    '    Next I
    '
    '    'Obtener los valores para la formula, para la impresión del detalle del Ticket
    '    gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & _
    ''                    "SUM(MD.ImptePromociones + MD.ImpteDescuentos) AS ImpteDescuentos, MC.PorcIva, MD.IvaReal AS ImpteIva " & _
    ''                "FROM         MovimientosVentasDet MD INNER JOIN " & _
    ''                    "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & _
    ''                    "MovimientosVentasCab MC ON MC.FolioVenta = MD.FolioVenta " & _
    ''                "WHERE     (MD.FolioVenta = '" & Folio & "') " & _
    ''                "GROUP BY MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioLista, MD.ImptePromociones, MC.PorcIva, MD.ImpteDescuentos, MD.IvaReal, " & _
    ''                    "MD.PorcPromociones , MD.PorcDescuentos"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recAux = Cmd.Execute
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RDETALLE = RsGral.RecordCount
    '    Dim SIMBOLO As String
    '    Dim Valor As Double
    '    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '    Dim Encabezado As Boolean
    '    Dim H As Byte
    '    SIMBOLO = "+"
    '    Encabezado = True
    '    recAux.MoveFirst
    '    For H = 1 To recAux.RecordCount
    '        Valores(0) = recAux!CodArticulo
    '        Valores(1) = Trim(recAux!DescArticulo)
    '        Valores(2) = recAux!Cantidad
    '        Valores(3) = Format(Round(recAux!PrecioLista * TipoCambio, 1), gstrFormatoCantidad)   'pRECIO
    '        Valores(4) = Format(recAux!PorcDescuentos, gstrFormatoCantidad) 'PORC dESCUENTO
    '        Valores(5) = Format(Round(recAux!ImpteDescuentos * TipoCambio, 1), gstrFormatoCantidad) 'iMPORTE DESCUENTO
    '        Valores(6) = Format(Round(recAux!ImpteIVA * TipoCambio, 1), gstrFormatoCantidad)        'iMPORTE IVA
    '        Valores(7) = Format(recAux!PorcIva, gstrFormatoCantidad)           'pORCENTAJE IVA
    '        RsGral.MoveFirst
    '        For I = 0 To 16
    '            Detalle(I, 0) = ""
    '            Detalle(I, 1) = ""
    '            Detalle(I, 2) = ""
    '            Detalle(I, 3) = ""
    '            Detalle(I, 4) = ""
    '        Next I
    '
    '        'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
    '        For I = 1 To RDETALLE
    '            Detalle(I, 0) = Right(Space(10) + Trim(RsGral!Etiqueta), 10)
    '            Detalle(I, 2) = RsGral!Columna
    '            Detalle(I, 3) = RsGral!Saltos
    '            If Trim(RsGral!Formula) <> "" Then
    '                PALABRA = ""
    '                For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '                    FinPal = False
    '                    If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '                        PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                        FinPal = True
    '                        Select Case PALABRA
    '                            Case "Código"
    '                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '                                Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
    '                                Detalle(I, 4) = "C"
    '                            Case "Descripción"
    '                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '                                Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
    '                                Detalle(I, 4) = "C"
    '                            Case "Cantidad"
    '                                Valor = Valores(2)
    '                                Detalle(I, 4) = Detalle(I, 4) + "E"   'SIGNIFICA QUE ES UN DATO ENTERO
    '                            Case "Precio Público"
    '                                Valor = Valores(3)
    '                                Detalle(I, 4) = Detalle(I, 4) + "D"
    '                            Case "% Descuento"
    '                                Valor = Valores(4)
    '                                Detalle(I, 4) = "D"
    '                            Case "$ Descuento"
    '                                Valor = Valores(5)
    '                                Detalle(I, 4) = "D"
    '                            Case "$ IVA"
    '                                Valor = Valores(6)
    '                                Detalle(I, 4) = "D"
    '                            Case "% IVA"
    '                                Valor = Valores(7)
    '                                Detalle(I, 4) = "D"
    '                        End Select
    '                        PALABRA = ""
    '                        J = J + 1
    '                        If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
    '                            If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
    '                            If SIMBOLO = "+" Then
    '                                Detalle(I, 1) = Detalle(I, 1) + Valor
    '                            ElseIf SIMBOLO = "-" Then
    '                                Detalle(I, 1) = Detalle(I, 1) - Valor
    '                            ElseIf SIMBOLO = "*" Then
    '                                Detalle(I, 1) = Detalle(I, 1) * Valor
    '                            End If
    '                        End If
    '                        If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '                            SIMBOLO = "+"
    '                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '                            SIMBOLO = "-"
    '                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "x" Then
    '                            SIMBOLO = "*"
    '                        End If
    '                    End If
    '                Next J
    '            End If
    '            RsGral.MoveNext
    '        Next I
    '        '*** Encabezado del Detalle
    '        If Encabezado Then
    '            Encabezado = False
    '            Print #1, LineaSepara(COLS)
    '            For I = 1 To RDETALLE
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
    '                If Detalle(I, 3) > 0 Then
    '                    For J = 1 To Detalle(I, 3)
    '                        Print #1, Left(RTrim(Linea), COLS)
    '                        Linea = ""
    '                    Next J
    '                End If
    '            Next I
    '            Print #1, LineaSepara(COLS)
    '        End If
    '
    '        ''''***** DETALLE *****
    '        For I = 1 To RDETALLE
    '            If Detalle(I, 4) = "C" Then
    '                'Se trata de un dato caracter
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
    '            ElseIf Detalle(I, 4) = "E" Then
    '                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
    '                If gbytPosicionesDecimal = 0 Then
    '                    FormatoCantidad = 0
    '                Else
    '                    FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '                End If
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
    '            Else
    '                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), "###,###,##0.00"), 10)
    '            End If
    '            If Detalle(I, 3) > 0 Then
    '                For J = 1 To Detalle(I, 3)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    Linea = ""
    '                Next J
    '            End If
    '        Next I
    '        recAux.MoveNext
    '    Next H
    '    '***** TOTALES *****}
    '    gStrSql = "SELECT     dbo.MovimientosVentasCab.Moneda , dbo.MovimientosVentasCab.FolioVenta,dbo.MovimientosVentasCab.SubTotal AS SubTotal, " & _
    ''            "dbo.MovimientosVentasCab.Descuento AS Descuento, " & _
    ''            "dbo.MovimientosVentasCab.Iva AS Iva,  dbo.MovimientosVentasCab.PorcIva, " & _
    ''            "dbo.MovimientosVentasCab.Redondeo AS Redondeo, " & _
    ''            "dbo.MovimientosVentasCab.Anticipo AS Anticipo, " & _
    ''            "Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & _
    ''            "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio " & _
    ''            "FROM         dbo.MovimientosVentasCab left outer  JOIN " & _
    ''            "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto " & _
    ''            "WHERE dbo.MovimientosVentasCab.FolioVenta ='" & Folio & "' "
    '            ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '
    '    For I = 1 To 7
    '        Valores(I) = 0
    '    Next
    '    Valores(9) = 0
    '    Valores(10) = 0
    '    Valores(8) = ""
    '    If RsGral.RecordCount > 0 Then
    '        Valores(0) = RsGral!SubTotal * TipoCambio                                   'Subtotal
    '        Valores(1) = RsGral!Descuento * TipoCambio                                'Descuento sin IVA
    '        Valores(11) = RsGral!Descuento * (1 + RsGral!PorcIva / 100) * TipoCambio  'Descuento con IVA
    '        Valores(2) = RsGral!Iva * TipoCambio                                     'IVA
    '        Valores(3) = RsGral!Redondeo * TipoCambio                                 'Redondeo
    '        'Total= Subtotal - Descuento + Iva + Redondeo
    '        Valores(4) = Format(Round(RsGral!SubTotal - RsGral!Descuento + RsGral!Iva + RsGral!Redondeo, 2), gstrFormatoCantidad)
    '        Valores(5) = Format(Round(Valores(4) * TipoCambio, 1), gstrFormatoCantidad)               'ImportePesos
    '        Valores(6) = Format(Round(RsGral!cambio * TipoCambio, 1), gstrFormatoCantidad)            'CAmbio en Pesos
    '        Valores(7) = Format(Round(RsGral!Totalingreso * TipoCambio, 1) + Valores(6))              'Total Pago
    '        Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, 1), gstrFormatoCantidad)     'Imoprte total en pesos con letra
    '        Valores(9) = Format(Round(RsGral!Anticipo * TipoCambio, 1), gstrFormatoCantidad)          'Anticipo
    '        Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
    '        'El Descuento siguiente se le agregará el Iva
    '        'Valores(11) = Format(Round(RsGral!Descuento * (1 + RsGral!PorcIva / 100), 2)
    '        Valores(17) = IIf((RsGral!Moneda) = "D", "DOLAR", "PESOS")
    '    End If
    '
    '
    '    '** Obtiene el Total de Piezas
    '
    '    gStrSql = "SELECT     ISNULL(SUM(dbo.MovimientosVentasDet.Cantidad) , 0) AS Cantidad " & _
    ''                "FROM         dbo.MovimientosVentasCab INNER JOIN " & _
    ''                        "dbo.MovimientosVentasDet ON dbo.MovimientosVentasCab.FolioVenta = dbo.MovimientosVentasDet.FolioVenta " & _
    ''                "WHERE     (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "') " & _
    ''                "GROUP BY dbo.MovimientosVentasCab.FolioVenta"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recTotPzas = Cmd.Execute
    '    Valores(12) = recTotPzas!Cantidad                'Total Piezas
    '    Set recTotPzas = Nothing
    '
    '    gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV  where Codalmacen = " & CodSucursal
    '
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set recAux = Cmd.Execute
    '    If recAux.RecordCount > 0 Then
    '        Valores(13) = Trim(recAux!MsgNormal)
    '        Valores(14) = Trim(recAux!MsgFiscal)
    '        Valores(16) = Trim(recAux!MsgCredito)
    '    End If
    '    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
    '    ModEstandar.BorraCmd
    '    Cmd.CommandText = "dbo.Up_Select_Datos"
    '    Cmd.CommandType = adCmdStoredProc
    '    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '    Set RsGral = Cmd.Execute
    '    RTOTALES = RsGral.RecordCount
    '    For I = 1 To RTOTALES
    '        Totales(I, 0) = RTrim(RsGral!Etiqueta)
    '        Totales(I, 2) = RsGral!Columna
    '        Totales(I, 3) = RsGral!Saltos
    '        Totales(I, 4) = "C"
    '        If Trim(RsGral!Formula) <> "" Then
    '            PALABRA = ""
    '            For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '                FinPal = False
    '                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '                    FinPal = True
    '                    Select Case PALABRA
    '                        Case "SubTotal"
    '                            Valor = Valores(0)
    '                            Totales(I, 4) = "N"
    '                        Case "Descuento con IVA"
    '                            Valor = Valores(11)
    '                            Totales(I, 4) = "N"
    '                        Case "Descuento sin IVA"
    '                            Valor = Valores(1)
    '                            Totales(I, 4) = "N"
    '                        Case "I.V.A."
    '                            Valor = Valores(2)
    '                            Totales(I, 4) = "N"
    '                        Case "Redondeo"
    '                            Valor = Valores(3)
    '                            Totales(I, 4) = "N"
    '                        Case "Cantidad Letra"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
    '                            Totales(I, 4) = "CL"  ' Indica que es la Cantidad con letra
    '                        Case "Importe"
    '                            Valor = Valores(4)
    '                            Totales(I, 4) = "N"
    '                        Case "Total Pesos"
    '                            Valor = Valores(5)
    '                            Totales(I, 4) = "N"
    '                        Case "Cambio"
    '                            Valor = Valores(6)
    '                            Totales(I, 4) = "N"
    '                        Case "Pago"
    '                            Valor = Valores(7)
    '                            Totales(I, 4) = "N"
    '                        Case "Mensaje Normal"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Mensaje Fiscal"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Formas de Pago"
    '                            Totales(I, 1) = "FORPAG"
    '                            Totales(I, 4) = "C"
    '                        Case "Total Piezas"
    '                            Valor = Valores(12)
    '                            Totales(I, 4) = "E"
    '                        Case "Anticipo"
    '                            Valor = Valores(9)
    '                            Totales(I, 4) = "N"
    '                        Case "Saldo"
    '                            Valor = Valores(10)
    '                            Totales(I, 4) = "N"
    '                        Case "Mensaje Crédito"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
    '                            Totales(I, 4) = "C"
    '                        Case "Moneda"
    '                            Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
    '                            Totales(I, 4) = "C"
    '                    End Select
    '                    PALABRA = ""
    '                    J = J + 1
    '                    If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
    '                        If Totales(I, 1) = "" Then Totales(I, 1) = 0
    '                        If SIMBOLO = "+" Then
    '                            Totales(I, 1) = Totales(I, 1) + Valor
    '                        ElseIf SIMBOLO = "-" Then
    '                            Totales(I, 1) = Totales(I, 1) - Valor
    '                        ElseIf SIMBOLO = "*" Then
    '                            Totales(I, 1) = Totales(I, 1) * Valor
    '                        End If
    '                    End If
    '                    If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '                        SIMBOLO = "+"
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '                        SIMBOLO = "-"
    '                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = "*" Then
    '                        SIMBOLO = "*"
    '                    End If
    '                End If
    '            Next J
    '        End If
    '        RsGral.MoveNext
    '    Next I
    '    For I = 1 To RTOTALES
    '        If Totales(I, 4) = "C" Then
    '            If Totales(I, 1) = "FORPAG" Then
    '                Dim D As Byte
    '                Dim recDesg As Recordset
    '                gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & _
    ''                            "FROM         dbo.CatFormasPago INNER JOIN " & _
    ''                            "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & _
    ''                            "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & _
    ''                            "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & _
    ''                            "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
    '                ModEstandar.BorraCmd
    '                Cmd.CommandText = "dbo.Up_Select_Datos"
    '                Cmd.CommandType = adCmdStoredProc
    '                Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '                Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '                Set recDesg = Cmd.Execute
    '                For D = 1 To recDesg.RecordCount
    '                    Linea = Space(Totales(I, 2)) + Left(recDesg!DescFormaPago + Space(16), 16) + Right(Space(10) + Format(recDesg!importe, "###,###,##0.00"), 10)
    '                    Print #1, Left(RTrim(Linea), COLS)
    '                    recDesg.MoveNext
    '                Next D
    '            Else
    '                Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
    '            End If
    '        ElseIf Totales(I, 4) = "E" Then
    '            If gbytPosicionesDecimal = 0 Then
    '                FormatoCantidad = 0
    '            Else
    '                FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '            End If
    '            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Right(Space(10) + Format(Totales(I, 1), FormatoCantidad), 10)
    '        ElseIf Totales(I, 4) = "CL" Then
    '            Cadena = ""
    '            Totales(I, 1) = Totales(I, 1)
    '            For J = 1 To Len(Totales(I, 1)) Step 1
    '                SubCad = Mid(Totales(I, 1), J, 1)
    '                If SubCad = " " Then
    '                    If Len(Cadena) >= COLS Then
    '                        'CadenaImp = CadenaAnt
    '                        Print #1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt)
    '                        Cadena = UltimaSubCadena
    '                    Else
    '                        CadenaAnt = Cadena
    '                    End If
    '                    UltimaSubCadena = ""
    '                End If
    '                Cadena = Cadena + SubCad
    '                UltimaSubCadena = UltimaSubCadena + SubCad
    '                If J = Len(Totales(I, 1)) Then
    '                    Print #1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt)
    '                End If
    '            Next J
    '        Else
    '            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Right(Space(10) + Format(Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
    '        End If
    '        If Totales(I, 3) >= 0 Then
    '            Totales(I, 3) = IIf((Totales(I, 4) = "CL"), (Totales(I, 3)) - 1, (Totales(I, 3)))
    '            For J = 1 To Totales(I, 3)
    '                If Totales(I, 1) = "FORPAG" Then Linea = ""
    '                Print #1, Left(RTrim(Linea), COLS)
    '                Linea = ""
    '            Next J
    '        End If
    '    Next I
    '
    '    For I = 1 To 4
    '        Print #1, ""
    '    Next I
    '
    '    '''Cortar Papel
    '    Print #1, Chr(27) + Chr(105)
    '    Close #1
    '    'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
    '    'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
    '    Erase Encabez
    '    Erase Detalle
    '    Erase Totales
    '    Erase Valores
    '    Set recAux = Nothing
    'Errores:
    '    If Err.Number = 55 Then
    '        Close #1
    '        Err.Clear
    '        GoTo Continuar
    '    End If
    '    If Err.Number <> 0 Then ModEstandar.MostrarError
    'End Sub

    Sub TicketVentaPrueba(ByRef Tipo As String, ByRef CodAlmacen As Integer)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        Dim cadena As String
        Dim CadenaAnt As String
        Dim UltimaSubCadena As String
        Dim SubCad As String

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.ConfiguracionGeneral.TipoCambio " & "FROM         dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE  dbo.ConfiguracionGralPV.CodAlmacen = " & CodAlmacen

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(7) = "S9999999999999999" 'Folio
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = Format(Now, "DD/MMM/YYYY") 'Fecha
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = Format(Now, "HH:MM") 'Hora
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = IIf((Tipo = "CO"), "CONTADO", "CREDITO") 'TipoVenta
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(11) = "" 'Cajero
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = "XXXXXXXXXXXXXXXXXXXXXXXXX" 'Vendedor
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(13) = "XXXXXXXXXXXXXXXXXXXXXXXXX" 'Cliente
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(14) = "99.99" 'TipoCambio

        'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' And CodAlmacen = " & CodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodAlmacen & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")
            '''Encabez(I, 0) = RTrim(RsGral!Etiqueta) + " "
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Tipo de Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14) + "  "
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        '''Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True

        For H = 1 To 1
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = "X" 'CodArticulo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = New String("X", 150) 'DescArticulo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "99"
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format("999999", gstrFormatoCantidad) 'pRECIO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format("999999", gstrFormatoCantidad) 'PORC dESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format("999999", gstrFormatoCantidad) 'iMPORTE DESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format("999999", gstrFormatoCantidad) 'iMPORTE IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format("99", gstrFormatoCantidad) 'pORCENTAJE IVA
            RsGral.MoveFirst()
            For I = 0 To 15
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(6)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(7)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            '   recAux.MoveNext
        Next H

        '***** TOTALES *****}

        For I = 1 To 7
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = 0
        Next
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ""

        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(0) = "999999.00" 'Subtotal
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(1) = "999999.00" 'Descuento sin IVA
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(11) = "999999.00" 'Descuento con IVA
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(2) = "999999.00" 'IVA
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(3) = "0" 'Redondeo
        'Total= Subtotal - Descuento + Iva + Redondeo
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(4) = Format("999999.00", gstrFormatoCantidad)
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(5) = Format("999999.00", gstrFormatoCantidad) 'ImportePesos
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(6) = Format("999999.00", gstrFormatoCantidad) 'CAmbio en Pesos
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(7) = Format("999999.00", gstrFormatoCantidad) 'Total Pago
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ModEstandar.ConLetra(Valores(5), True, CStr(1)) 'Imoprte total en pesos con letra
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = Format("999999.00", gstrFormatoCantidad) 'Anticipo
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = Format("999999.00", gstrFormatoCantidad)
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(16) = " DOLAR"
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = "99"

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV Where CodAlmacen = " & CodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(15) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value)

            Totales(I, 2) = RsGral.Fields("Columna").Value

            Totales(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 4) = "C"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                    FinPal = False
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "SubTotal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(0)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Descuento con IVA"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(11)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Descuento sin IVA"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "I.V.A."
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(2)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Redondeo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(3)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Cantidad Letra"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "CL"
                            Case "Importe"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(4)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Total Pesos"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(5)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(6)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Pago"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(7)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Normal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Mensaje Fiscal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Formas de Pago"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = "FORPAG"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Total Piezas"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(12)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "E"
                            Case "Anticipo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(9)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Saldo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(10)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Crédito"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(15) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Moneda"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                            SIMBOLO = "+"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                            SIMBOLO = "-"
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Byte
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT DISTINCT DescCorta AS DescFormaPago, EsDolar AS EsDolar, 99999999 AS Importe " & "FROM         dbo.CatFormasPago C"
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount

                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "CL" Then
                cadena = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 1) = Totales(I, 1)
                For J = 1 To Len(Totales(I, 1)) Step 1

                    SubCad = Mid(Totales(I, 1), J, 1)
                    If SubCad = " " Then
                        If Len(cadena) >= COLS Then
                            'CadenaImp = CadenaAnt
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                            PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                            cadena = UltimaSubCadena
                        Else
                            CadenaAnt = cadena
                        End If
                        UltimaSubCadena = ""
                    End If
                    cadena = cadena & SubCad
                    UltimaSubCadena = UltimaSubCadena & SubCad
                    If J = Len(Totales(I, 1)) Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                        PrintLine(1, Left(Space(COLS), Totales(I, 2)) + Totales(I, 0) + Trim(CadenaAnt))
                    End If
                Next J
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then


                Totales(I, 3) = IIf((Totales(I, 4) = "CL"), (Totales(I, 3)) - 1, (Totales(I, 3)))

                For J = 1 To Totales(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Totales(I, 1) = "FORPAG" Then Linea = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        '''x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub TicketVentaReducido(ByRef Folio As String, ByRef CodCaja As Integer, ByRef Tipo As String, ByRef CodSucursal As Integer) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RsAux As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasCab.TipoCambio " & "FROM         dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & "dbo.MovimientosVentasCab ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasCab.CodSucursal CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE     dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "' and dbo.MovimientosVentasCab.CodSucursal = " & CodSucursal

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = " SELECT     dbo.MovimientosVentasCab.FolioAdicional, dbo.MovimientosVentasCab.FechaVenta,CASE dbo.MovimientosVentasCab.Condicion WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO'  END AS TipoVenta , " & "dbo.CatVendedores.DescVendedor ,  dbo.MovimientosVentasCab.Nombre As DescCliente " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.CatVendedores ON dbo.MovimientosVentasCab.CodVendedor = dbo.CatVendedores.CodVendedor " & "WHERE   (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = RsGral.Fields("FolioAdicional").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaVenta").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(RsGral.Fields("FechaVenta").Value, "HH:MM AMPM") 'Hora
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = RsGral.Fields("TipoVenta").Value 'TipoVenta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = "" 'Cajero
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("DescCliente").Value) 'Cliente
        End If

        'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' AND CodAlmacen = " & CodSucursal
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value) & " "
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        'Open gstrTicketPrinter For Output As #1
        FileOpen(1, "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", OpenMode.Output) ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT     dbo.MovimientosVentasDet.CodArticulo, dbo.CatArticulos.DescArticulo , dbo.MovimientosVentasDet.Cantidad, dbo.MovimientosVentasDet.PrecioListaAdicional, " & "SUM(dbo.MovimientosVentasDet.PorcPromociones + dbo.MovimientosVentasDet.PorcDescuentos) AS PorcDescuentos, " & "SUM(dbo.MovimientosVentasDet.ImptePromocionesAdicional + dbo.MovimientosVentasDet.ImpteDescuentosAdicional) AS ImpteDescuentos, " & "dbo.MovimientosVentasCab.PorcIva  , dbo.MovimientosVentasDet.IvaRealAdicional As ImpteIva " & "From dbo.MovimientosVentasDet, dbo.MovimientosVentasCab, dbo.CatArticulos " & "WHERE (dbo.MovimientosVentasCab.FolioVenta =  '" & Folio & "') and dbo.CatArticulos.CodArticulo = dbo.MovimientosVentasDet.CodArticulo " & "and movimientosventascab.folioventa = movimientosventasdet.folioventa " & "GROUP BY dbo.MovimientosVentasDet.CodArticulo, dbo.CatArticulos.DescArticulo ,dbo.MovimientosVentasDet.Cantidad, dbo.MovimientosVentasDet.PrecioListaAdicional, " & "dbo.MovimientosVentasDet.ImptePromocionesAdicional,  dbo.MovimientosVentasCab.PorcIva, dbo.MovimientosVentasDet.ImpteDescuentosAdicional, " & "dbo.MovimientosVentasDet.IvaRealAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "' AND CodAlmacen = " & CodSucursal & " ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = recAux.Fields("CodArticulo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = recAux.Fields("Cantidad").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(recAux.Fields("PrecioListaAdicional").Value, gstrFormatoCantidad) 'pRECIO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(recAux.Fields("PorcDescuentos").Value, gstrFormatoCantidad) 'PORC dESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(recAux.Fields("ImpteDescuentos").Value, gstrFormatoCantidad) 'iMPORTE DESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format(recAux.Fields("ImpteIva").Value, gstrFormatoCantidad) 'iMPORTE IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(recAux.Fields("PorcIva").Value, gstrFormatoCantidad) 'pORCENTAJE IVA
            If RsGral.RecordCount > 0 Then
                RsGral.MoveFirst()
            End If
            For I = 0 To 15
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(6)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(7)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT     dbo.MovimientosVentasCab.FolioAdicional,dbo.MovimientosVentasCab.SubTotalAdicional AS SubTotal, " & "dbo.MovimientosVentasCab.DescuentoAdicional AS Descuento, " & "dbo.MovimientosVentasCab.IvaAdicional AS Iva,  dbo.MovimientosVentasCab.PorcIva, " & "dbo.MovimientosVentasCab.RedondeoAdicional AS Redondeo, " & "dbo.MovimientosVentasCab.AnticipoAdicional AS Anticipo, " & "dbo.Ingresos.Total as TotalIngreso, " & "dbo.Ingresos.Cambio AS Cambio " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto " & "WHERE dbo.MovimientosVentasCab.FolioVenta ='" & Folio & "' "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        For I = 1 To 7
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = 0
        Next
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ""
        If RsGral.RecordCount > 0 Then

            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = RsGral.Fields("SubTotal").Value 'Subtotal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = RsGral.Fields("Descuento").Value 'Descuento sin IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = RsGral.Fields("Descuento").Value * (1 + RsGral.Fields("PorcIva").Value / 100) 'Descuento con IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = RsGral.Fields("Iva").Value 'IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = RsGral.Fields("Redondeo").Value 'Redondeo
            'Total= Subtotal - Descuento + Iva + Redondeo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(System.Math.Round(RsGral.Fields("SubTotal").Value - RsGral.Fields("Descuento").Value + RsGral.Fields("Iva").Value + RsGral.Fields("Redondeo").Value, 2), gstrFormatoCantidad)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(Valores(4) * TipoCambio), gstrFormatoCantidad) 'ImportePesos
            'Valores(6) = Format(Round(RsGral!Cambio * TipoCambio), gstrFormatoCantidad)             'CAmbio en Pesos
            'Valores(7) = Format(Round(RsGral!Totalingreso * TipoCambio) + Valores(6))               'Total Pago
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, CStr(1)), gstrFormatoCantidad) 'Imoprte total en pesos con letra
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value * TipoCambio), gstrFormatoCantidad) 'Anticipo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
            'El Descuento siguiente se le agregará el Iva
            'Valores(11) = Format(Round(RsGral!Descuento * (1 + RsGral!PorcIva / 100), 2), gstrFormatoCantidad)                            'Descuento
        End If


        '** Obtiene el Total de Piezas

        gStrSql = "SELECT     ISNULL(SUM(dbo.MovimientosVentasDet.Cantidad) , 0) AS Cantidad " & "FROM         dbo.MovimientosVentasCab INNER JOIN " & "dbo.MovimientosVentasDet ON dbo.MovimientosVentasCab.FolioVenta = dbo.MovimientosVentasDet.FolioVenta " & "WHERE     (dbo.MovimientosVentasCab.FolioVenta = '" & Folio & "') " & "GROUP BY dbo.MovimientosVentasCab.FolioVenta"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recTotPzas = Cmd.Execute
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = recTotPzas.Fields("Cantidad").Value 'Total Piezas
        'UPGRADE_NOTE: Object recTotPzas may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        recTotPzas = Nothing

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(15) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        Dim Nlinea As Integer
        Dim Aux As Integer
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If Tipo = "CO" Then
            gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE FORMULA = '' AND GRUPO='T' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON"
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsAux = Cmd.Execute
            Aux = RsAux.RecordCount
        Else
            Aux = 1
        End If
        Nlinea = 0
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            If RsGral.Fields("Formula").Value <> "(Pago)" And RsGral.Fields("Formula").Value <> "(Cambio)" Then
                If Trim(RsGral.Fields("Formula").Value) = "" And Tipo = "CO" Then Nlinea = Nlinea + 1
                If Nlinea < Aux Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Totales(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value)

                    Totales(I, 2) = RsGral.Fields("Columna").Value

                    Totales(I, 3) = RsGral.Fields("Saltos").Value
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Totales(I, 4) = "C"
                End If
                If Nlinea = Aux Then Nlinea = 0
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "SubTotal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(0)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Descuento con IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(11)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Descuento sin IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "I.V.A."
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Redondeo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Cantidad Letra"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Importe"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Total Pesos"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Cambio"
                                    'Valor = Valores(6)
                                    'Totales(I, 4) = "N"
                                Case "Pago"
                                    'Valor = Valores(7)
                                    'Totales(I, 4) = "N"
                                Case "Mensaje Normal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Mensaje Fiscal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Formas de Pago"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = "FORPAG"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Total Piezas"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(12)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "E"
                                Case "Anticipo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(9)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Saldo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(10)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Mensaje Crédito"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(15) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Totales(I, 1) = "" Then Totales(I, 1) = 0
                                If SIMBOLO = "+" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Byte
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    '                For D = 1 To recDesg.RecordCount
                    '                    Linea = Space(Totales(I, 2)) + Left(recDesg!DescFormaPago + Space(15), 15) + Right(Space(10) + Format(recDesg!Importe, "###,###,##0.00"), 10)
                    '                    Print #1, Left(RTrim(Linea), Cols)
                    '                    recDesg.MoveNext
                    '                Next D
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(15), 15) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(15), 15) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then

                For J = 1 To Totales(I, 3)
                    'If Totales(I, 1) = "FORPAG" Then Linea = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub TicketVentaReducidoDolares(ByRef Folio As String, ByRef CodCaja As Integer, ByRef Tipo As String, ByRef CodSucursal As Integer, ByRef TipoMovto As String) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        Dim cadena As String
        Dim CadenaAnt As String
        Dim UltimaSubCadena As String
        Dim SubCad As String

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasDet.TipoCambioAdicional " & "FROM     dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & "dbo.MovimientosVentasDet ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasDet.CodSucursalAdicional CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE     dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "' and dbo.MovimientosVentasDet.CodSucursalAdicional = " & CodSucursal

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambioAdicional").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = " SELECT dbo.MovimientosVentasDet.TipoCambioAdicional, dbo.MovimientosVentasDet.FolioAdicional, dbo.MovimientosVentasDet.FechaVentaAdicional,CASE dbo.MovimientosVentasDet.CondicionAdicional WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO' ELSE ''  END AS TipoVenta , " & "dbo.CatVendedores.DescVendedor,dbo.CatClientes.DescCliente As DescCliente " & "FROM dbo.MovimientosVentasDet INNER JOIN " & "dbo.CatVendedores ON dbo.MovimientosVentasDet.CodVendedorAdicional = dbo.CatVendedores.CodVendedor " & "INNER JOIN dbo.CatClientes ON dbo.MovimientosVentasDet.CodClienteAdicional = dbo.CatClientes.CodCliente " & "WHERE   (dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Folio
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaVentaAdicional").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM AMPM") 'Hora
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = RsGral.Fields("TipoVenta").Value 'TipoVenta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = "" 'Cajero
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("DescCliente").Value) 'Cliente
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Format(RsGral.Fields("TipoCambioAdicional").Value, gstrFormatoCantidad) 'Tipo de Cambio
        End If

        'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value) & " "
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Valores(10) = "CONTADO" Or Valores(10) = "CREDITO" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Encabez(I, 2) = Encabez(I, 2) - 1
                                End If
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Tipo de Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14)
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT MD.CodArticulo, MD.DescArticuloAdicional, SUM(MD.CantidadAdicional) AS CantidadAdicional, MD.PrecioListaAdicional, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & "SUM(MD.ImptePromocionesAdicional + MD.ImpteDescuentosAdicional) AS ImpteDescuentos, MD.PorcIvaAdicional, MD.IvaRealAdicional AS ImpteIva " & "FROM MovimientosVentasDet MD INNER JOIN " & "CatArticulos A ON MD.CodArticulo = A.CodArticulo " & "WHERE (MD.FolioAdicional = '" & Folio & "') " & "GROUP BY MD.CodArticulo, MD.DescArticuloAdicional, /*MD.CantidadAdicional,*/ MD.PrecioListaAdicional, MD.ImptePromocionesAdicional, MD.PorcIvaAdicional, MD.ImpteDescuentosAdicional, MD.IvaRealAdicional, " & "MD.PorcPromociones , MD.PorcDescuentos"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = recAux.Fields("CodArticulo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(recAux.Fields("DescArticuloAdicional").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = recAux.Fields("CantidadAdicional").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(recAux.Fields("PrecioListaAdicional").Value, gstrFormatoCantidad) 'pRECIO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(recAux.Fields("PorcDescuentos").Value, gstrFormatoCantidad) 'PORC dESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(recAux.Fields("ImpteDescuentos").Value, gstrFormatoCantidad) 'iMPORTE DESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format(recAux.Fields("ImpteIva").Value, gstrFormatoCantidad) 'iMPORTE IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(recAux.Fields("PorcIvaAdicional").Value, gstrFormatoCantidad) 'pORCENTAJE IVA
            RsGral.MoveFirst()
            For I = 0 To 16
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(6)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(7)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT dbo.MovimientosVentasDet.MonedaAdicional,dbo.MovimientosVentasDet.FolioAdicional,SUM(dbo.MovimientosVentasDet.PrecioListaSinIvaAdicional * dbo.MovimientosVentasDet.CantidadAdicional) AS SubTotal, " & "SUM((dbo.MovimientosVentasDet.ImptePromocionesAdicional + dbo.MovimientosVentasDet.ImpteDescuentosAdicional) * dbo.MovimientosVentasDet.CantidadAdicional) AS Descuento, " & "SUM(dbo.MovimientosVentasDet.IvaRealAdicional * dbo.MovimientosVentasDet.CantidadAdicional) AS Iva,dbo.MovimientosVentasDet.PorcIvaAdicional, " & "dbo.MovimientosVentasDet.RedondeoAdicional AS Redondeo, " & "dbo.MovimientosVentasDet.AnticipoAdicional AS Anticipo " & "/*Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio*/ " & "FROM dbo.MovimientosVentasDet /*left outer  JOIN " & "dbo.Ingresos ON dbo.MovimientosVentasCab.FolioVenta = dbo.Ingresos.FolioMovto*/ " & "WHERE dbo.MovimientosVentasDet.FolioAdicional ='" & Folio & "' " & "GROUP BY dbo.MovimientosVentasDet.MonedaAdicional,dbo.MovimientosVentasDet.FolioAdicional,dbo.MovimientosVentasDet.PorcIvaAdicional,dbo.MovimientosVentasDet.RedondeoAdicional,dbo.MovimientosVentasDet.AnticipoAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        For I = 1 To 7
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = 0
        Next
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ""
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = RsGral.Fields("SubTotal").Value 'Subtotal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = RsGral.Fields("Descuento").Value 'Descuento sin IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = RsGral.Fields("Descuento").Value * (1 + RsGral.Fields("PorcIvaAdicional").Value / 100) 'Descuento con IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = RsGral.Fields("Iva").Value 'IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = RsGral.Fields("Redondeo").Value 'Redondeo
            'Total= Subtotal - Descuento + Iva + Redondeo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(System.Math.Round(RsGral.Fields("SubTotal").Value - RsGral.Fields("Descuento").Value + RsGral.Fields("Iva").Value + RsGral.Fields("Redondeo").Value, 2), gstrFormatoCantidad)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(Valores(4), 2), gstrFormatoCantidad) 'ImportePesos
            'Valores(6) = Format(Round(RsGral!CambiO, 2), gstrFormatoCantidad)           'CAmbio en Pesos
            'Valores(7) = Format(Round(RsGral!Totalingreso, 2) + Valores(6))               'Total Pago
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, CStr(2)), gstrFormatoCantidad) 'Imoprte total en pesos con letra
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value, 1), gstrFormatoCantidad) 'Anticipo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(17). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(17) = IIf((RsGral.Fields("MonedaAdicional")).Value = "D", "DOLAR", "PESOS")
        End If

        '** Obtiene el Total de Piezas

        gStrSql = "SELECT ISNULL(SUM(dbo.MovimientosVentasDet.CantidadAdicional) , 0) AS Cantidad " & "FROM dbo.MovimientosVentasDet " & "WHERE (dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "') " & "GROUP BY dbo.MovimientosVentasDet.FolioAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recTotPzas = Cmd.Execute
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = recTotPzas.Fields("Cantidad").Value 'Total Piezas
        'UPGRADE_NOTE: Object recTotPzas may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        recTotPzas = Nothing
        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(16) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        Dim Nlinea As Integer
        Dim Aux As Integer
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            If RsGral.Fields("Formula").Value <> "(Pago)" And RsGral.Fields("Formula").Value <> "(Cambio)" Then
                'If Trim(RsGral!Formula) = "" And Tipo = "CO" Then Nlinea = Nlinea + 1
                'If Nlinea < Aux Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value)

                Totales(I, 2) = RsGral.Fields("Columna").Value

                Totales(I, 3) = RsGral.Fields("Saltos").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 4) = "C"
                'End If
                'If Nlinea = Aux Then Nlinea = 0
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "SubTotal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(0)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Descuento con IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(11)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Descuento sin IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "I.V.A."
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Redondeo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Cantidad Letra"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "CL" ' Indica que es la Cantidad con letra
                                Case "Importe"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Total Pesos"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Cambio"
                                    'Valor = Valores(6)
                                    'Totales(I, 4) = "N"
                                Case "Pago"
                                    'Valor = Valores(7)
                                    'Totales(I, 4) = "N"
                                Case "Mensaje Normal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Mensaje Fiscal"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Formas de Pago"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = "FORPAG"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Total Piezas"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(12)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "E"
                                Case "Anticipo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(9)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Saldo"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(10)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "N"
                                Case "Mensaje Crédito"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(16). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Moneda"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(17). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Totales(I, 1) = "" Then Totales(I, 1) = 0
                                If SIMBOLO = "+" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Byte
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount

                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "CL" Then
                cadena = ""

                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 1) = Totales(I, 1) + " "
                For J = 1 To Len(Totales(I, 1)) Step 1

                    SubCad = Mid(Totales(I, 1), J, 1)
                    If SubCad = " " Then
                        If Len(cadena) >= COLS Then
                            'CadenaImp = CadenaAnt
                            PrintLine(1, " " & CadenaAnt)
                            cadena = UltimaSubCadena
                        Else
                            CadenaAnt = cadena
                        End If
                        UltimaSubCadena = ""
                    End If
                    cadena = cadena & SubCad
                    UltimaSubCadena = UltimaSubCadena & SubCad
                    If J = Len(Totales(I, 1)) Then
                        PrintLine(1, " " & cadena)
                        PrintLine(1, "")
                    End If
                Next J
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then

                For J = 1 To Totales(I, 3)
                    'If Totales(I, 1) = "FORPAG" Then LINEA = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'X = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub TicketVentaReducidoPesos(ByRef Folio As String, ByRef CodCaja As Integer, ByRef Tipo As String, ByRef CodSucursal As Integer, ByRef TipoMovto As String) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(20, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        Dim cadena As String
        Dim CadenaAnt As String
        Dim UltimaSubCadena As String
        Dim SubCad As String

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT dbo.ConfiguracionGeneral.NombreEmp AS NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "dbo.ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, dbo.CatAlmacen.DescAlmacen AS NomSucursal, " & "dbo.CatAlmacen.Domicilio AS DirSucursal, dbo.MovimientosVentasDet.TipoCambioAdicional " & "FROM     dbo.CatAlmacen INNER JOIN " & "dbo.ConfiguracionGralPV ON dbo.CatAlmacen.CodAlmacen = dbo.ConfiguracionGralPV.CodAlmacen INNER JOIN " & "dbo.MovimientosVentasDet ON dbo.CatAlmacen.CodAlmacen = dbo.MovimientosVentasDet.CodSucursalAdicional CROSS JOIN " & "dbo.ConfiguracionGeneral " & "WHERE    dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "' and dbo.MovimientosVentasDet.CodSucursalAdicional = " & CodSucursal

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambioAdicional").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = " SELECT dbo.MovimientosVentasDet.TipoCambioAdicional, dbo.MovimientosVentasDet.FolioAdicional, dbo.MovimientosVentasDet.FechaVentaAdicional,CASE dbo.MovimientosVentasDet.CondicionAdicional WHEN 'CO' THEN 'CONTADO' WHEN 'CR' THEN 'CREDITO' ELSE '' END AS TipoVenta , " & "dbo.CatVendedores.DescVendedor,dbo.CatClientes.DescCliente As DescCliente " & "FROM dbo.MovimientosVentasDet INNER JOIN " & "dbo.CatVendedores ON dbo.MovimientosVentasDet.CodVendedorAdicional = dbo.CatVendedores.CodVendedor " & "INNER JOIN dbo.CatClientes ON dbo.MovimientosVentasDet.CodClienteAdicional = dbo.CatClientes.CodCliente " & "WHERE   (dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Folio
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaVentaAdicional").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM AMPM") 'Hora
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = RsGral.Fields("TipoVenta").Value 'TipoVenta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = "" 'Cajero
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("DescCliente").Value) 'Cliente
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = Format(RsGral.Fields("TipoCambioAdicional").Value, gstrFormatoCantidad) 'Tipo de Cambio
        End If

        'bUSCAR CUAL SERA EL ANCHO DE COLUMNAS DEL TICKET(Variable Cols)
        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= '" & Tipo & "' and CodAlmacen = " & CodSucursal & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value) & " "
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Encabez(I, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Tipo de Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Valores(10) = "CONTADO" Or Valores(10) = "CREDITO" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Encabez(I, 2) = Encabez(I, 2) - 1
                                End If
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Cajero"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Tipo de Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14)
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(RTrim(Linea) & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT MD.CodArticulo, MD.DescArticuloAdicional, SUM(MD.CantidadAdicional) AS CantidadAdicional, MD.PrecioListaAdicional, SUM(MD.PorcPromociones) + SUM(MD.PorcDescuentos) AS PorcDescuentos, " & "SUM(MD.ImptePromocionesAdicional + MD.ImpteDescuentosAdicional) AS ImpteDescuentos, MD.PorcIvaAdicional, MD.IvaRealAdicional AS ImpteIva,MD.TipoCambioAdicional " & "FROM MovimientosVentasDet MD INNER JOIN " & "CatArticulos A ON MD.CodArticulo = A.CodArticulo " & "WHERE (MD.FolioAdicional = '" & Folio & "') " & "GROUP BY MD.CodArticulo, MD.DescArticuloAdicional, /*MD.CantidadAdicional,*/ MD.PrecioListaAdicional, MD.ImptePromocionesAdicional, MD.PorcIvaAdicional, MD.ImpteDescuentosAdicional, MD.IvaRealAdicional, " & "MD.PorcPromociones,MD.PorcDescuentos,MD.TipoCambioAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = recAux.Fields("CodArticulo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(recAux.Fields("DescArticuloAdicional").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = recAux.Fields("CantidadAdicional").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(System.Math.Round(recAux.Fields("PrecioListaAdicional").Value * recAux.Fields("TipoCambioAdicional").Value, 1), gstrFormatoCantidad) 'pRECIO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(recAux.Fields("PorcDescuentos").Value, gstrFormatoCantidad) 'PORC dESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(recAux.Fields("ImpteDescuentos").Value * TipoCambio, 1), gstrFormatoCantidad) 'iMPORTE DESCUENTO
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Format(System.Math.Round(recAux.Fields("ImpteIva").Value * TipoCambio, 1), gstrFormatoCantidad) 'iMPORTE IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(recAux.Fields("PorcIvaAdicional").Value, gstrFormatoCantidad) 'pORCENTAJE IVA
            RsGral.MoveFirst()
            For I = 0 To 16
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Código"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Descripción"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(2)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(3)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                                Case "% Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ Descuento"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(5)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "$ IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(6)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                                Case "% IVA"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Valor = Valores(7)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = 1 To RDETALLE
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT dbo.MovimientosVentasDet.MonedaAdicional,dbo.MovimientosVentasDet.FolioAdicional,SUM(dbo.MovimientosVentasDet.PrecioListaSinIvaAdicional * dbo.MovimientosVentasDet.CantidadAdicional) AS SubTotal, " & "SUM((dbo.MovimientosVentasDet.ImptePromocionesAdicional + dbo.MovimientosVentasDet.ImpteDescuentosAdicional) * dbo.MovimientosVentasDet.CantidadAdicional) AS Descuento, " & "SUM(dbo.MovimientosVentasDet.IvaRealAdicional * dbo.MovimientosVentasDet.CantidadAdicional) AS Iva,dbo.MovimientosVentasDet.PorcIvaAdicional, " & "dbo.MovimientosVentasDet.RedondeoAdicional AS Redondeo, " & "dbo.MovimientosVentasDet.AnticipoAdicional AS Anticipo, " & "dbo.MovimientosVentasDet.TipoCambioAdicional " & "/*Isnull(dbo.Ingresos.Total,0)  as TotalIngreso, " & "Isnull(dbo.Ingresos.Cambio,0) + Isnull(dbo.Ingresos.CambioDOL ,0)  AS Cambio*/ " & "FROM dbo.MovimientosVentasDet /*left outer  JOIN " & "dbo.Ingresos ON dbo.MovimientosVentasDet.FolioVenta = dbo.Ingresos.FolioMovto*/ " & "WHERE dbo.MovimientosVentasDet.FolioAdicional ='" & Folio & "' " & "GROUP BY dbo.MovimientosVentasDet.MonedaAdicional,dbo.MovimientosVentasDet.FolioAdicional,dbo.MovimientosVentasDet.PorcIvaAdicional,dbo.MovimientosVentasDet.RedondeoAdicional,dbo.MovimientosVentasDet.AnticipoAdicional,dbo.MovimientosVentasDet.TipoCambioAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        For I = 1 To 7
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = 0
        Next
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(9) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(10) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(8) = ""
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = System.Math.Round(RsGral.Fields("SubTotal").Value * RsGral.Fields("TipoCambioAdicional").Value, 1) 'Subtotal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = System.Math.Round(RsGral.Fields("Descuento").Value * RsGral.Fields("TipoCambioAdicional").Value, 1) 'Descuento sin IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = System.Math.Round(RsGral.Fields("Descuento").Value * (1 + RsGral.Fields("PorcIvaAdicional").Value / 100) * RsGral.Fields("TipoCambioAdicional").Value, 1) 'Descuento con IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = System.Math.Round(RsGral.Fields("Iva").Value * RsGral.Fields("TipoCambioAdicional").Value, 1) 'IVA
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = System.Math.Round(RsGral.Fields("Redondeo").Value * RsGral.Fields("TipoCambioAdicional").Value, 1) 'Redondeo
            'Total= Subtotal - Descuento + Iva + Redondeo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = RsGral.Fields("SubTotal").Value - RsGral.Fields("Descuento").Value + RsGral.Fields("Iva").Value + RsGral.Fields("Redondeo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Format(System.Math.Round(Valores(4) * RsGral.Fields("TipoCambioAdicional").Value, 1), gstrFormatoCantidad) 'ImportePesos
            'Valores(6) = Format(Round(RsGral!CambiO * TipoCambio, 1), gstrFormatoCantidad)            'CAmbio en Pesos
            'Valores(7) = Format(Round(RsGral!Totalingreso * TipoCambio, 1) + Valores(6))              'Total Pago
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(ModEstandar.ConLetra(Valores(5), True, CStr(1)), gstrFormatoCantidad) 'Imoprte total en pesos con letra
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value * RsGral.Fields("TipoCambioAdicional").Value, 1), gstrFormatoCantidad) 'Anticipo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = Format(Valores(5) - Valores(9), gstrFormatoCantidad)
            'El Descuento siguiente se le agregará el Iva
            'Valores(11) = Format(Round(RsGral!Descuento * (1 + RsGral!PorcIva / 100), 2))
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(17). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(17) = IIf((RsGral.Fields("MonedaAdicional")).Value = "D", "DOLAR", "PESOS")
        End If


        '** Obtiene el Total de Piezas

        gStrSql = "SELECT ISNULL(SUM(dbo.MovimientosVentasDet.CantidadAdicional) , 0) AS Cantidad " & "FROM dbo.MovimientosVentasDet " & "WHERE (dbo.MovimientosVentasDet.FolioAdicional = '" & Folio & "') " & "GROUP BY dbo.MovimientosVentasDet.FolioAdicional"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recTotPzas = Cmd.Execute
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(12) = recTotPzas.Fields("Cantidad").Value 'Total Piezas
        'UPGRADE_NOTE: Object recTotPzas may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
        recTotPzas = Nothing

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            Valores(13) = Trim(recAux.Fields("MsgNormal").Value)
            Valores(14) = Trim(recAux.Fields("MsgFiscal").Value)
            Valores(16) = Trim(recAux.Fields("MsgCredito").Value)
        End If
        Dim Nlinea As Integer
        Dim Aux As Integer
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND GRUPO='T' and  Tipo= '" & Tipo & "'  and CodAlmacen = " & CodSucursal & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RTOTALES = RsGral.RecordCount
        For I = 1 To RTOTALES
            If RsGral.Fields("Formula").Value <> "(Pago)" And RsGral.Fields("Formula").Value <> "(Cambio)" Then
                'If Trim(RsGral!Formula) = "" And Tipo = "CO" Then Nlinea = Nlinea + 1
                'If Nlinea < Aux Then
                Totales(I, 0) = RTrim(RsGral.Fields("Etiqueta").Value)
                Totales(I, 2) = RsGral.Fields("Columna").Value
                Totales(I, 3) = RsGral.Fields("Saltos").Value
                Totales(I, 4) = "C"
                'End If
                'If Nlinea = Aux Then Nlinea = 0
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "SubTotal"
                                    Valor = Valores(0)
                                    Totales(I, 4) = "N"
                                Case "Descuento con IVA"
                                    Valor = Valores(11)
                                    Totales(I, 4) = "N"
                                Case "Descuento sin IVA"
                                    Valor = Valores(1)
                                    Totales(I, 4) = "N"
                                Case "I.V.A."
                                    Valor = Valores(2)
                                    Totales(I, 4) = "N"
                                Case "Redondeo"
                                    Valor = Valores(3)
                                    Totales(I, 4) = "N"
                                Case "Cantidad Letra"
                                    Totales(I, 1) = Totales(I, 1) + Valores(8) + "  "
                                    Totales(I, 4) = "CL" ' Indica que es la Cantidad con letra
                                Case "Importe"
                                    Valor = Valores(4)
                                    Totales(I, 4) = "N"
                                Case "Total Pesos"
                                    Valor = Valores(5)
                                    Totales(I, 4) = "N"
                                Case "Cambio"
                                    'Valor = Valores(6)
                                    'Totales(I, 4) = "N"
                                Case "Pago"
                                    'Valor = Valores(7)
                                    'Totales(I, 4) = "N"
                                Case "Mensaje Normal"
                                    Totales(I, 1) = Totales(I, 1) + Valores(13) + "  "
                                    Totales(I, 4) = "C"
                                Case "Mensaje Fiscal"
                                    Totales(I, 1) = Totales(I, 1) + Valores(14) + "  "
                                    Totales(I, 4) = "C"
                                Case "Formas de Pago"
                                    Totales(I, 1) = "FORPAG"
                                    Totales(I, 4) = "C"
                                Case "Total Piezas"
                                    Valor = Valores(12)
                                    Totales(I, 4) = "E"
                                Case "Anticipo"
                                    Valor = Valores(9)
                                    Totales(I, 4) = "N"
                                Case "Saldo"
                                    Valor = Valores(10)
                                    Totales(I, 4) = "N"
                                Case "Mensaje Crédito"
                                    Totales(I, 1) = Totales(I, 1) + Valores(16) + "  "
                                    Totales(I, 4) = "C"
                                Case "Moneda"
                                    Totales(I, 1) = Totales(I, 1) + Valores(17) + "  "
                                    Totales(I, 4) = "C"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                                If Totales(I, 1) = "" Then Totales(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    Totales(I, 1) = Totales(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    Totales(I, 1) = Totales(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    Totales(I, 1) = Totales(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "*" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
            End If
            RsGral.MoveNext()
        Next I
        Dim D As Byte
        Dim recDesg As ADODB.Recordset
        For I = 1 To RTOTALES
            If Totales(I, 4) = "C" Then
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount
                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
            ElseIf Totales(I, 4) = "E" Then
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If
                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), FormatoCantidad), 10)
            ElseIf Totales(I, 4) = "CL" Then
                cadena = ""
                Totales(I, 1) = Totales(I, 1) + " "
                For J = 1 To Len(Totales(I, 1)) Step 1
                    SubCad = Mid(Totales(I, 1), J, 1)
                    If SubCad = " " Then
                        If Len(cadena) >= COLS Then
                            'CadenaImp = CadenaAnt
                            PrintLine(1, " " & CadenaAnt)
                            cadena = UltimaSubCadena
                        Else
                            CadenaAnt = cadena
                        End If
                        UltimaSubCadena = ""
                    End If
                    cadena = cadena & SubCad
                    UltimaSubCadena = UltimaSubCadena & SubCad
                    If J = Len(Totales(I, 1)) Then
                        PrintLine(1, " " & cadena)
                        PrintLine(1, "")
                    End If
                Next J
            Else
                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(System.Math.Round(Totales(I, 1), 2), "###,###,##0.00"), 10)
            End If
            If Totales(I, 3) > 0 Then
                For J = 1 To Totales(I, 3)
                    'If Totales(I, 1) = "FORPAG" Then LINEA = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'X = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
        System.Array.Clear(Encabez, 0, Encabez.Length)
        System.Array.Clear(Detalle, 0, Detalle.Length)
        System.Array.Clear(Totales, 0, Totales.Length)
        System.Array.Clear(Valores, 0, Valores.Length)
        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Function LineaSepara(ByRef COLS As Byte) As String
        On Error GoTo Errores
        Dim I As Byte
        LineaSepara = ""
        For I = 1 To COLS
            LineaSepara = LineaSepara & "="
        Next I
Errores:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function


    ''''Carga imagen para cada uno de los articulos
    'Sub BuscaImagen(Imagen As String, Image As Control)
    'On Error GoTo Errores
    '    Dim RecImg As ADODB.Recordset
    '    Dim Archivo
    '    Dim RutaDeImagenes As String   '''Var global para ruta de archivos
    '
    '    RutaDeImagenes = App.Path & "\Sistema\Imagenes\"
    '
    '    If Dir(RutaDeImagenes) <> "" Then
    '        gStrSql = "Select CodArticulo From CatArticulos Where CodArticulo = " & CLng(Numerico(Imagen))
    '        ModEstandar.BorraCmd
    '        Cmd.CommandText = "dbo.Up_Select_Datos"
    '        Cmd.CommandType = adCmdStoredProc
    '        Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '        Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '
    '        Set RecImg = Cmd.Execute
    '        If RecImg.RecordCount > 0 Then
    '           Imagen = Right(gstrMascaraPict + Trim(Str(RecImg!CodArticulo)), Len(gstrMascaraPict))
    '         Else
    '            Imagen = ""
    '         End If
    '        Archivo = Dir(RutaDeImagenes & Imagen & ".*", vbHidden)
    '        If Archivo <> "" Then
    '            Image.Picture = LoadPicture(RutaDeImagenes & Archivo)
    '        Else
    '            Image.Picture = LoadPicture(RutaDeImagenes & "JMR.JPG")
    '        End If
    '    End If
    '
    'Errores:
    '    If Err.Number <> 0 Then
    '        If Err.Number = 53 Then
    '            MsgBox "No se Encontró la Imágen del Producto", vbOKOnly + vbExclamation, "Aviso"
    '            Err.Clear
    '        Else
    '            ModEstandar.MostrarError
    '        End If
    '    End If
    'End Sub
    '
    ''' Validas si existen impresoras registradas, en caso de no existir, se envia al usuario al form. de registro
    ''' de impresoras
    Sub ValidarRegistrodeImpresoras()
        On Error GoTo Merr
        gStrSql = "Select * from ConfiguracionImpresora Where CodAlmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute

        If RsGral.RecordCount = 0 Then
            MsgBox("No Existen Impresoras Registradas, " & vbNewLine & "Se mostrará la forma para Registro de Impresoras.", MsgBoxStyle.Information, gstrCorpoNOMBREEMPRESA)
            'frmConfiguracion.Show vbModal
        Else
            ModCorporativo.CargarRutaImpresoras()
        End If
        Exit Sub
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    '''Carga la imagen de cada uno de los articulos, si no existe entonces pone el logo por default
    Sub BuscaImagen(ByRef Imagen As String, ByRef Image As System.Windows.Forms.PictureBox)
        On Error GoTo Errores
        Dim RecImg As ADODB.Recordset
        Dim Archivo As Object
        Dim RutaDeImagenes As String = "C:\Users\Angel Wha\Desktop\CORPORATIVO Y JOYERIA\CODIGO ANGEL WHA\CorporativoV1\CorporativoV1\Sistema\Imagenes"
        'Var global para ruta de archivos 

        'Referencia  'JGQL 5May2008
        'RutaDeImagenes = App.Path & "\Sistema\Imagenes"


        RutaDeImagenes = gstrCorpoRUTAIMAGENES

        If Dir(RutaDeImagenes, FileAttribute.Directory) <> "" Then
            gStrSql = "Select CodArticulo From CatArticulos Where CodArticulo = " & CInt(Numerico(Imagen))
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))

            RecImg = Cmd.Execute
            If RecImg.RecordCount > 0 Then
                Imagen = Str(RecImg.Fields("CodArticulo").Value)
            Else
                Imagen = ""
            End If
        End If
        If Trim(Imagen) <> "" Then Archivo = Dir(RutaDeImagenes & "\" & Trim(Imagen) & ".*", FileAttribute.Normal)
        '    If Archivo <> "" Then
        '        Image.Image = System.Drawing.Image.FromFile(RutaDeImagenes & "\" & Archivo)
        '    Else
        '        Image.Image = System.Drawing.Image.FromFile(RutaDeImagenes & "\" & "JMR.JPG")
        '    End If
        'End If
        Exit Sub

Errores:
        If Err.Number <> 0 Then
            If Err.Number = 53 And Imagen <> "" Then
                MsgBox("No se encontró la imágen del producto", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
                Err.Clear()
            Else
                ModEstandar.MostrarError()
            End If
        End If
    End Sub

    '''Carga la posible imagen que sera asociada con el articulo en el abc
    Sub BuscaImagenArticulosNuevos(ByRef RutaArchivo As String, ByRef Archivo As String, ByRef Image As Object)
        On Error GoTo Errores

        'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
        If Dir(RutaArchivo, FileAttribute.Directory) <> "" Then
            'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
            Archivo = Dir(RutaArchivo & "\" & Archivo, FileAttribute.Normal)
            If Archivo <> "" Then
                'UPGRADE_ISSUE: Control method Image.Picture was not upgraded. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
                Image = System.Drawing.Image.FromFile(RutaArchivo & "\" & Archivo)
            Else
                'UPGRADE_ISSUE: Control method Image.Picture was not upgraded. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
                Image = System.Drawing.Image.FromFile(My.Application.Info.DirectoryPath & "\Sistema\Imagenes\" & "JMR.JPG")
            End If
        End If
        Exit Sub

Errores:
        If Err.Number <> 0 Then
            If Err.Number = 53 And Archivo <> "" Then
                MsgBox("No se encontró la imágen del producto", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
                Err.Clear()
            Else
                ModEstandar.MostrarError()
            End If
        End If
    End Sub

    '''Carga ruta configurada para impresora de facturacion
    Sub CargarRutaImpresoras()
        On Error GoTo Errores
        'Este Sub , Pone el Variables Globales, las Rutas de las Impresoras para Tickets y La impresora Láser
        gStrSql = "Select * from ConfiguracionImpresora where CodAlmacen = " & gintCodAlmacen
        BorraCmd()
        Cmd.CommandText = "dbo.UP_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            gstrTicketPrinter = Trim(RsGral.Fields("TicketPrinter").Value)
            gstrRutaImpresora = Trim(RsGral.Fields("RutaImpresora").Value)
        End If
Errores:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Function FormateoDecimales(ByRef Cantidad As Object) As Object
        'Esta función formatea una cantidad, de acuerdo al numero de decimales especificados en la configuracion general.
        On Error GoTo Merr
        Dim F As Integer
        Dim Formato As String 'Contiene el Formato a dar a la cantidad (Por ejemplo: "0.00", "0.000",etc)
        FormateoDecimales = Cantidad
        If gbytCantidadDecimales = 0 Then Exit Function
        Formato = "0."
        For F = 1 To gbytCantidadDecimales
            Formato = Formato & "0"
        Next
        FormateoDecimales = Format(Cantidad, Formato)
        Exit Function
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function Valida_Folio(ByRef Folio As String, ByRef tecla As Integer, ByRef Pos As Byte) As Byte ', Band As Boolean) As Byte
        'Función que valida la inserción correcta de un Folio de Venta, que será (S0000)., Letra al inicio, y posteriormente Números.
        'La primer posicion debe ser una letra y posteriormente numeros,(solo se puede introducir 4 numero, pero eso se valida con la Porp maxlength del control)
        Valida_Folio = tecla
        If Pos = 1 Then
            'Valida que la Tecla sea una Letra Asccii= 65-90
            If tecla >= System.Windows.Forms.Keys.A And tecla <= System.Windows.Forms.Keys.Z Then
                Exit Function
            Else
                Valida_Folio = 0
                Exit Function
            End If
        Else
            If (tecla >= System.Windows.Forms.Keys.D0 And tecla <= System.Windows.Forms.Keys.D9) Then
                Exit Function
            Else
                Valida_Folio = 0
                Exit Function
            End If
        End If
    End Function

    Sub ObtenerDatosSucursalMatriz(ByRef txtcod As System.Windows.Forms.TextBox, ByRef txtdesc As System.Windows.Forms.TextBox)
        On Error GoTo Merr
        gStrSql = "SELECT CodAlmacen,DescAlmacen FROM CatAlmacen WHERE AlmGral = 1"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 800, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            txtcod.Text = RsGral.Fields("CodAlmacen").Value
            txtdesc.Text = RsGral.Fields("DescAlmacen").Value
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Public Function BuscaRenglon(ByRef txtTexto As System.Windows.Forms.Control) As String
        Dim Ren As String
        Dim I As Integer
        For I = 1 To txtTexto.Text.Length
            If Mid(txtTexto.ToString(), I, 1) <> "," Then
                Ren = Ren & Mid(txtTexto.ToString(), I, 1)
            Else
                Exit For
            End If
        Next
        BuscaRenglon = Ren
        Return BuscaRenglon
    End Function

    Public Function BuscaColumna(ByRef txtTexto As System.Windows.Forms.Control) As String
        Dim Col As String
        Dim I As Object
        Dim J As Integer
        For I = 1 To txtTexto.Text.Length
            If Mid(txtTexto.ToString(), I, 1) = "," Then
                For J = I + 1 To Len(txtTexto)
                    Col = Col & Mid(txtTexto.ToString(), J, 1)
                Next
                Exit For
            End If
        Next
        BuscaColumna = Col
        Return BuscaColumna
    End Function

    Public Function BuscaCoordenadas(ByRef txtTexto As System.Windows.Forms.Control) As Boolean
        Dim I As Integer
        Dim Coord1 As String
        Dim Coma As String
        Dim Coord2 As String
        For I = 1 To txtTexto.Text.Length
            If Mid(txtTexto.ToString(), I, 1) <> "," Then
                Coord1 = Coord1 & Mid(txtTexto.ToString(), I, 1)
            Else
                Coma = ","
                Exit For
            End If
        Next
        For I = txtTexto.Text.Length To 1 Step -1
            If Mid(txtTexto.ToString(), I, 1) <> "," Then
                Coord2 = Coord2 & Mid(txtTexto.ToString(), I, 1)
            Else
                Exit For
            End If
        Next
        If Coord1 <> "" And Coma <> "" And Coord2 <> "" Then
            BuscaCoordenadas = True
        Else
            BuscaCoordenadas = False
        End If
        Return BuscaCoordenadas
    End Function

    'Función Para Validar la Entrada de Coordenadas
    'Parametros
    '   1 Coord  : String que Almacena la Coordenada
    '   2 Tecla  : Key Que se va a Validar
    Function Valida_Coordenadas(ByRef Coord As String, ByRef tecla As Integer) As Byte
        Dim I As Integer
        If tecla = 44 Then
            For I = 1 To Len(Coord)
                If Mid(Coord, I, 1) = "," Then
                    Valida_Coordenadas = 0
                    Exit Function
                End If
            Next
            Valida_Coordenadas = tecla
            Exit Function
        Else
            Valida_Coordenadas = 0
        End If
        If (tecla >= 48 And tecla <= 57) Or (tecla > 0 And tecla < 32) Then
            Valida_Coordenadas = tecla
        Else
            Valida_Coordenadas = 0
        End If
        Return Valida_Coordenadas
    End Function

    Public Sub Obtiene_Coordenadas(ByRef txtTexto As System.Windows.Forms.Control, ByRef Cadena1 As String, ByRef Cadena2 As String)
        Dim I As Integer
        Cadena1 = ""
        Cadena2 = ""
        For I = 1 To Len(txtTexto)
            If Mid(txtTexto.ToString(), I, 1) <> "," Then
                Cadena1 = Cadena1 & Mid(txtTexto.ToString(), I, 1)
            Else
                Exit For
            End If
        Next
        For I = Len(txtTexto) To 1 Step -1
            If Mid(txtTexto.ToString(), I, 1) <> "," Then
                Cadena2 = Cadena2 & Mid(txtTexto.ToString(), I, 1)
            Else
                Exit For
            End If
        Next
    End Sub

    Public Function ChecaSaldo(ByRef Banco As Integer, ByRef CtaBancaria As String, ByRef importe As Decimal) As Boolean
        On Error GoTo Err_Renamed
        ChecaSaldo = True
        gStrSql = "SELECT (CB.SaldoInicial + (ISNULL(SUM(CASE MB.TipoMovto WHEN 'I' THEN MB.IMPORTE END),0)) - " & "ISNULL(SUM(CASE MB.TipoMovto WHEN 'E' THEN MB.IMPORTE END),0)) AS Saldo " & "FROM CatCuentasBancarias CB INNER JOIN MovimientosBancarios MB ON CB.CodBanco = MB.CodBanco AND CB.CtaBancaria = MB.CtaBancaria " & "WHERE CB.CodBanco = " & Banco & " AND MB.CodBanco = " & Banco & " AND CB.CtaBancaria = '" & CtaBancaria & "' AND " & "MB.CtaBancaria = '" & CtaBancaria & "' GROUP BY CB.SaldoInicial"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            If (RsGral.Fields("SALDO").Value - importe) < 0 Then
                If MsgBox("No Tiene Saldo Disponible, el Saldo Disponible en la Cuenta " & CtaBancaria & Chr(13) & "Es de " & Format(RsGral.Fields("SALDO").Value, "###,##0.00") & " ¿Desea Continuar? ", MsgBoxStyle.Question + MsgBoxStyle.YesNo, gstrNombCortoEmpresa) = MsgBoxResult.Yes Then
                    ChecaSaldo = True
                Else
                    ChecaSaldo = False
                End If
            End If
        Else
            gStrSql = "SELECT SaldoInicial From CatCuentasBancarias WHERE CodBanco = " & Banco & " AND CtaBancaria = '" & CtaBancaria & "'"
            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsGral = Cmd.Execute
            If RsGral.RecordCount > 0 Then
                If (RsGral.Fields("SaldoInicial").Value - importe) < 0 Then
                    If MsgBox("No Tiene Saldo Disponible, el Saldo Disponible en la Cuenta " & CtaBancaria & Chr(13) & "Es de " & Format(RsGral.Fields("SaldoInicial").Value, "###,##0.00") & " ¿Desea Continuar? ", MsgBoxStyle.Question + MsgBoxStyle.YesNo, gstrNombCortoEmpresa) = MsgBoxResult.Yes Then
                        ChecaSaldo = True
                    Else
                        ChecaSaldo = False
                    End If
                End If
            End If
        End If
Err_Renamed:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    '    Public Function ChecaFechaMovimientos(ByRef FechaMov As AxMSComCtl2.AxDTPicker) As Boolean
    '        On Error GoTo Err_Renamed
    '        gStrSql = "SELECT UltCierreBancos FROM ConfiguracionBancos"
    '        ModEstandar.BorraCmd()
    '        cmd.CommandText = "dbo.Up_Select_Datos"
    '        cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
    '        cmd.Parameters.Append(cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
    '        cmd.Parameters.Append(cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
    '        RsGral = cmd.Execute
    '        If RsGral.RecordCount > 0 Then
    '            If FechaMov.Value = RsGral.Fields("UltCierreBancos").Value And Today = RsGral.Fields("UltCierreBancos").Value Then
    '                MsgBox("La Fecha del Movimiento es Igual a la Fecha del Ultimo Corte." & Chr(13) & "La Fecha del Movimiento sera " & Format(FechaMov.Value + 1, "dd/mmm/yyyy"), MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
    '                FechaMov.Value = FechaMov.Value + 1
    '                ChecaFechaMovimientos = True
    '                Exit Function
    '            ElseIf (FechaMov.Value <= Today) And (FechaMov.Value > RsGral.Fields("UltCierreBancos").Value) Then
    '                ChecaFechaMovimientos = True
    '                Exit Function
    '            Else
    '                MsgBox("La Fecha de Movimiento no es Valida, Favor de Verificar...", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
    '                ChecaFechaMovimientos = False
    '                Exit Function
    '            End If
    '        End If
    'Err_Renamed:
    '        If Err.Number <> 0 Then ModEstandar.MostrarError()
    '    End Function

    Public Function ChecaFechaCancelacion(ByRef FechaMov As System.Windows.Forms.Label) As Boolean
        On Error GoTo Err_Renamed
        gStrSql = "SELECT UltCierreBancos FROM ConfiguracionBancos"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            If CDate(FechaMov.Text) <= RsGral.Fields("UltCierreBancos").Value Then
                MsgBox("La Fecha de Cancelación es Menor o Igual a la Fecha del Ultimo Cierre." & Chr(13) & "No Es Posible Cancelar el Movimiento.", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
                ChecaFechaCancelacion = False
            Else
                ChecaFechaCancelacion = True
            End If
        End If
Err_Renamed:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Function ObtieneNumCheque(ByRef CodBanco As Integer, ByRef CtaBancaria As String, ByRef Letra As String) As Integer
        On Error GoTo Err_Renamed
        gStrSql = "SELECT LetraFolios,ConsecutivoChq From CatCuentasBancarias WHERE CodBanco = " & CodBanco & " AND CtaBancaria = '" & CtaBancaria & "'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            ObtieneNumCheque = CInt(RsGral.Fields("ConsecutivoChq").Value) + 1
            Letra = Trim(RsGral.Fields("LetraFolios").Value)
        Else
            ObtieneNumCheque = 0
            Letra = ""
        End If
Err_Renamed:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Function EstaConciliado(ByRef FolioMovimiento As String) As Boolean
        On Error GoTo Err_Renamed
        gStrSql = "SELECT Conciliado FROM MovimientosBancarios WHERE FolioMovto = '" & FolioMovimiento & "'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            If RsGral.Fields("Conciliado").Value = True Then
                EstaConciliado = True
            ElseIf RsGral.Fields("Conciliado").Value = False Then
                EstaConciliado = False
            End If
        End If
Err_Renamed:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Function EstaAplicado(ByRef FolioMovimiento As String) As Boolean
        On Error GoTo Merr
        gStrSql = "SELECT * FROM Anticipos WHERE FolioEgreso = '" & FolioMovimiento & "'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            If RsGral.Fields("Estatus").Value = "A" Then
                MsgBox("Este Anticipo ya Fue Aplicado, No se Puede Cancelar. Favor de Verificar...", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
                EstaAplicado = True
            Else
                EstaAplicado = False
            End If
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Sub BuscaEjercicio(ByRef Fecha As String)

        On Error GoTo Merr
        Dim Ejercicio As Integer
        Dim Periodo As String
        Ejercicio = CShort(Format(Year(CDate(Fecha)), "0000"))
        Periodo = Format(Month(CDate(Fecha)), "00")
        gStrSql = "SELECT Ejercicio, Periodo FROM EjercicioPeriodo WHERE Ejercicio = " & Ejercicio & " AND Periodo = '" & Periodo & "'"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount = 0 Then
            ModStoredProcedures.PR_IMEEjercicioPeriodo(CStr(Ejercicio), Periodo, C_TIPOMOVINGRESO, "0", C_INSERCION, CStr(0))
            Cmd.Execute()
            ModStoredProcedures.PR_IMEEjercicioPeriodo(CStr(Ejercicio), Periodo, C_TIPOMOVEGRESO, "0", C_INSERCION, CStr(0))
            Cmd.Execute()
            ModStoredProcedures.PR_IMEEjercicioPeriodo(CStr(Ejercicio), Periodo, C_TIPOMOVCANCELACION, "0", C_INSERCION, CStr(0))
            Cmd.Execute()
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Public Function BuscaUltimoCierre(ByRef FechaMov As Date) As Boolean
        On Error GoTo Err_Renamed
        BuscaUltimoCierre = False
        gStrSql = "SELECT UltCierreBancos FROM ConfiguracionBancos"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount = 1 Then
            BuscaUltimoCierre = True
            Exit Function
        ElseIf RsGral.RecordCount = 0 Then
            MsgBox("¡¡¡ ATENCION !!! No Existe Información en la Tabla de Configuración de Bancos." & Chr(13) & "No se Puede Guardar el Movimiento, Favor de Verificar ....", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
        End If
Err_Renamed:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Sub ObtenerLimitedeFechas(ByRef Periodo As Integer, ByRef Ejercicio As Integer, ByRef FechaInicial As String, ByRef FechaFinal As String)
        Dim DiaIni As Integer
        Dim DiaFin As Integer
        DiaIni = 1
        Select Case Periodo
            Case 1 'Enero
                DiaFin = 31
            Case 2 'Febrero
                If BICIESTO(Ejercicio) Then
                    DiaFin = 29
                Else
                    DiaFin = 28
                End If
            Case 3 'Marzo
                DiaFin = 31
            Case 4 'Abril
                DiaFin = 30
            Case 5 'Mayo
                DiaFin = 31
            Case 6 'Junio
                DiaFin = 30
            Case 7 'Julio
                DiaFin = 31
            Case 8 'Agosto
                DiaFin = 31
            Case 9 'Septiembre
                DiaFin = 30
            Case 10 'Octubre
                DiaFin = 31
            Case 11 'Noviembre
                DiaFin = 30
            Case 12 'Diciembre
                DiaFin = 31
        End Select

        'FechaInicial = CStr(Ejercicio) & "-" & VB6.Format(CStr(Periodo), "00") & "-" & VB6.Format(CStr(DiaIni), "00") & " " & VB6.Format(CStr(TimeOfDay))
        'FechaFinal = CStr(Ejercicio) & "-" & VB6.Format(CStr(Periodo), "00") & "-" & VB6.Format(CStr(DiaFin), "00") & " " & VB6.Format(CStr(TimeOfDay))

        FechaInicial = CStr(Ejercicio) & "-" & VB6.Format(CStr(Periodo), "00") & "-" & VB6.Format(CStr(DiaIni), "00")
        FechaFinal = CStr(Ejercicio) & "-" & VB6.Format(CStr(Periodo), "00") & "-" & VB6.Format(CStr(DiaFin), "00")

        'Dim FichaInicial1 As String = AgregarHoraAFecha(FechaInicial)
        'Dim FichaFinal1 As String = AgregarHoraAFecha(FechaFinal)

    End Sub

    Public Function ChecaGrid(ByRef frmForma As frmBancosProcesoDiarioOrigenyAplicacion) As Boolean
        Dim I As Integer
        ChecaGrid = False
        With frmForma.flexDetalle
            For I = 1 To .Rows - 1
                If Trim(.get_TextMatrix(I, 0)) <> "" And Trim(.get_TextMatrix(I, 1)) <> "" And Trim(.get_TextMatrix(I, 2)) <> "" And Trim(.get_TextMatrix(I, 3)) <> "" And Trim(.get_TextMatrix(I, 4)) <> "" Then
                    ChecaGrid = True
                End If
            Next
        End With
        Return ChecaGrid
    End Function

    Public Function ExisteAlmGeneral(ByRef CodAlmacen As Integer) As Boolean
        On Error GoTo Merr
        gStrSql = "SELECT * FROM CatAlmacen WHERE CodAlmacen <> " & CodAlmacen & " AND AlmGral = 1"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 1 Then
            MsgBox("Existe Mas de un Almacen General, Este Almacen no Puede ser General. Favor de Verificar ...", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
            ExisteAlmGeneral = True
        ElseIf RsGral.RecordCount = 1 Then
            MsgBox("Ya Existe un Almacen General, Este Almacen no Puede ser General. Favor de Verificar ...", MsgBoxStyle.OkOnly + MsgBoxStyle.Information, gstrNombCortoEmpresa)
            ExisteAlmGeneral = True
        ElseIf RsGral.RecordCount = 0 Then
            ExisteAlmGeneral = False
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function ValidarStockSucursales() As Boolean
        On Error GoTo Merr

        gStrSql = "( SELECT  I.CodAlmacen, SK.CodGrupo, SK.CodFamilia AS Nivel1, IsNull(SK.CodLinea,0) as Nivel2, IsNull(SK.CodSubLinea,0) as Nivel3, " & "SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) AS Existencia, sk.Stock, Abs((SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) - sk.Stock)) as Dif " & "FROM dbo.Inventario I (Nolock) Left OUTER JOIN dbo.StockPorArticulo_Grupo (1) SK  ON I.CodArticulo = SK.CodArticulo " & "GROUP BY I.CodAlmacen, SK.CodGrupo, SK.CodFamilia, SK.CodSubLinea, SK.CodLinea, sk.Stock " & "Having (SK.Stock > 0) AND (SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) < Sk.Stock) ) "
        gStrSql = gStrSql & " Union " & "( SELECT  I.CodAlmacen, SK.CodGrupo, IsNull(SK.CodFamilia,0) AS Nivel1, IsNull(SK.CodLinea,0) as Nivel2, IsNull(SK.CodSubLinea,0) as Nivel3, " & "SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) AS Existencia, sk.Stock, Abs((SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) - sk.Stock)) as Dif " & "FROM  dbo.Inventario I (Nolock)  Left OUTER JOIN dbo.StockPorArticulo_Grupo (2) SK  ON I.CodArticulo = SK.CodArticulo " & "GROUP BY I.CodAlmacen, SK.CodGrupo, SK.CodFamilia, SK.CodSubLinea, SK.CodLinea, sk.Stock " & "Having (SK.Stock > 0) AND (SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) < Sk.Stock) ) "
        gStrSql = gStrSql & " Union " & "( SELECT  I.CodAlmacen, SK.CodGrupo, SK.CodFamilia AS Nivel1, IsNull(SK.CodLinea,0) as Nivel2, IsNull(SK.CodSubLinea,0) as Nivel3, " & "SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) AS Existencia, sk.Stock, Abs((SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) - sk.Stock)) as Dif " & "FROM  dbo.Inventario I (Nolock) Left OUTER JOIN dbo.StockPorArticulo_Grupo (3) SK  ON I.CodArticulo = SK.CodArticulo " & "GROUP BY I.CodAlmacen, SK.CodGrupo, SK.CodFamilia, SK.CodSubLinea, SK.CodLinea, sk.Stock " & "Having (SK.Stock > 0) AND (SUM((I.ExistenciaInicial + I.Entradas) - (I.Salidas + I.Apartados)) < Sk.Stock) ) " & "ORDER BY I.CodAlmacen, SK.CodGrupo, SK.CodFamilia, IsNull(SK.CodLinea,0), IsNull(SK.CodSubLinea,0) "

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'frmValidaExistenciaStock.ShowDialog()
        End If

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function ValidarStockSucursales_Original() As Boolean
        On Error GoTo Merr

        gStrSql = " SELECT     I.CodAlmacen, SUM(I.ExistenciaInicial) + SUM(I.Entradas) - SUM(I.Salidas) - SUM(I.Apartados) AS Existencia, sk.Stock, SUM(I.ExistenciaInicial) " & "+ SUM(I.Entradas) - SUM(I.Salidas) - SUM(I.Apartados) - sk.Stock AS Dif, A.CodArticulo, A.DescArticulo " & "FROM         dbo.Inventario I INNER JOIN " & "dbo.CatArticulos A ON I.CodArticulo = A.CodArticulo FULL OUTER JOIN " & "dbo.StockPorArticulo() sk ON A.CodArticulo = sk.CodArticulo " & "GROUP BY I.CodArticulo, A.DescArticulo, A.CodUnidad, I.CodAlmacen, A.CostoReal, sk.Stock, A.CodArticulo, A.DescArticulo " & "Having (Sum(i.ExistenciaInicial) + Sum(i.Entradas) - Sum(i.Salidas) - Sum(i.Apartados) - sk.Stock <> 0) " & "ORDER BY Existencia"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 800, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'frmValidaExistenciaStock.ShowDialog()
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function
    Public Function NombreTabla(ByRef cPrefijo As String) As String
        On Error GoTo Merr
        Dim lStrSql As String
        Dim rsLook As ADODB.Recordset
        Dim Numero As Integer
        Dim cNomTmp As Object

        If Left(cPrefijo, 2) = "##" Then
            For Numero = 1 To 32000
                'UPGRADE_WARNING: Couldn't resolve default property of object cNomTmp. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                cNomTmp = cPrefijo & Trim(CStr(Numero))
                'UPGRADE_WARNING: Couldn't resolve default property of object cNomTmp. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                gStrSql = "SELECT name FROM tempdb..SysObjects WHERE name LIKE '" & cNomTmp & "%'"
                ModEstandar.BorraCmd()
                Cmd.CommandText = "dbo.UP_Select_Datos"
                Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                rsLook = Cmd.Execute
                If rsLook.RecordCount = 0 Then
                    Exit For
                End If
            Next Numero
            If Numero < 32000 Then
                'UPGRADE_WARNING: Couldn't resolve default property of object cNomTmp. Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                NombreTabla = Trim(cNomTmp)
            Else
                NombreTabla = ""
            End If
        ElseIf Left(cPrefijo, 1) = "#" Then
            For Numero = 1 To 32000
                cNomTmp = cPrefijo & Trim(CStr(Numero))
                gStrSql = "SELECT name FROM tempdb..SysObjects WHERE name LIKE '" & cNomTmp & "%'"
                ModEstandar.BorraCmd()
                Cmd.CommandText = "dbo.UP_Select_Datos"
                Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                rsLook = Cmd.Execute
                If rsLook.RecordCount = 0 Then
                    Exit For
                End If
            Next Numero
            If Numero < 32000 Then
                NombreTabla = Trim(cNomTmp)
            Else
                NombreTabla = ""
            End If
        Else
            For Numero = 1 To 32000
                cNomTmp = cPrefijo & Trim(CStr(Numero))
                gStrSql = "SELECT name FROM SysObjects WHERE name LIKE '" & cNomTmp & "%'"
                ModEstandar.BorraCmd()
                Cmd.CommandText = "dbo.UP_Select_Datos"
                Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                rsLook = Cmd.Execute
                If rsLook.RecordCount = 0 Then
                    Exit For
                End If
            Next Numero
            If Numero < 32000 Then
                NombreTabla = Trim(cNomTmp)
            Else
                NombreTabla = ""
            End If
        End If
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function ExistenciaAlmVExt(ByRef CodAlmacen As Integer) As Integer
        On Error GoTo Merr
        gStrSql = "SELECT ISNULL(SUM((I.ExistenciaInicial + I.Entradas) - ( I.Salidas+ I.Apartados)),0) as Existencia " & "FROM    dbo.Inventario I Where i.CodAlmacen = " & CodAlmacen & " "

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            ExistenciaAlmVExt = RsGral.Fields("Existencia").Value
        End If

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function


    '''Utiliza la variable global -gStrCodificacionImportes- para la codificacion de los costos en el abc de articulos
    Public Function Cifrar(ByRef cCantidad As String) As String
        Dim I As Integer 'Posición del dígito en la cadena cDigitos
        Dim c As Integer 'Contador de posiciones del parámetro
        Dim cDig As String 'Dígito o caracter extraído del parámetro cCantidad
        Dim cRes As String 'Cadena que va almacenando el resultado
        Dim cCant As String 'Almacena el parámetro sin espacios en blanco
        c = 0
        cRes = ""
        cCant = Trim(cCantidad)
        Do While c < Len(cCant)
            c = c + 1
            cDig = Mid(cCant, c, 1)
            I = InStr(1, cDigitos, cDig)
            If I <= 0 Then
                Cifrar = "( ERROR )"
                Exit Function
            End If
            cRes = cRes & Mid(gstrCodificacionImportes, I, 1)
        Loop
        Cifrar = cRes
    End Function


    '''Utiliza la variable global -gStrCodificacionImportes- para la codificacion de los costos en el abc de articulos
    Public Function DesCifrar(ByRef cCantidadCifrada As String) As String
        Dim I As Integer 'Posición del caracter en la cadena cLetras
        Dim c As Integer 'Contador de posiciones del parámetro
        Dim cDig As String 'Dígito o caracter extraído del parámetro cCantidadCifrada
        Dim cRes As String 'Cadena que va almacenando el resultado
        Dim cCant As String 'Almacena el parámetro sin espacios en blanco
        c = 0
        cRes = ""
        cCant = Trim(cCantidadCifrada)
        Do While c < Len(cCant)
            c = c + 1
            cDig = Mid(cCant, c, 1)
            I = InStr(1, gstrCodificacionImportes, cDig)
            If I <= 0 Then
                DesCifrar = "( ERROR )"
                Exit Function
            End If
            cRes = cRes & Mid(cDigitos, I, 1)
        Loop
        DesCifrar = cRes
    End Function

    Public Function CreaCarpetaInformes() As Boolean
        On Error GoTo Errores
        Dim miArchivo As String

        miArchivo = Dir(gstrCorpoDriveLocal & "\Sistema", FileAttribute.Directory)
        If miArchivo = "" Then
            MkDir(gstrCorpoDriveLocal & "\Sistema")
        End If

        miArchivo = Dir(gstrCorpoDriveLocal & "\Sistema\Informes", FileAttribute.Directory)
        If miArchivo = "" Then
            MkDir(gstrCorpoDriveLocal & "\Sistema\Informes")
        End If
        miArchivo = Dir(My.Application.Info.DirectoryPath & "\Sistema\PreCat", FileAttribute.Directory)
        If miArchivo = "" Then
            MkDir(My.Application.Info.DirectoryPath & "\Sistema\PreCat")
        End If
        CreaCarpetaInformes = True
        Exit Function

Errores:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function BuscarCodigoArticulo(ByRef Codigo As String) As Integer
        On Error GoTo Merr
        Dim CodigoString As String
        Dim CodAnterior As Integer
        Dim CodOrigen As Integer
        '''MsgBox "Entra a funcion BuscarCodigoArticulo"
        BuscarCodigoArticulo = 0
        'Esta función recibe como parámetro el código de artículo que se desea buscar.
        'Se buscará en la tabla de articulos, en codigo de Articulo y Código de Articulo anterior.
        'Es posible que se presenten tres situaciones:
        'el código buscado está en el campo código de Articulo de la Tabla
        '       --En este caso el codigo del articulo a buscar no cambia.
        'el código buscado está en el campo código anterior
        '       --En este caso, el codigo a buscar ahora será el que corresponda en el campo Codigo articulo del mismo registro.
        'El codigo a buscar está en los dos campos anteriores
        '       --En este caso, se mostrará una pantalla de ayuda para mostarle al usuario, los dos articulos encontrados. De los cuales debe seleccionar uno.

        ''Esta función regresa:
        '    -1 : Si el articulo no es encontró
        '    -2 : Si se encontró más de un Artículo
        If Trim(Codigo) = "" Then Exit Function
        If Len(CStr(Codigo)) = 6 Then
            CodigoString = Right(New String("0", 6) & CStr(Codigo), 6)
            CodOrigen = CDbl(Left(CodigoString, 1))
            CodAnterior = CInt(Right(CodigoString, 5))
            gStrSql = "SELECT  * From CatArticulos WHERE (CodArticulo = " & Codigo & ") " & "OR   (OrigenAnt = " & CodOrigen & " AND CodigoAnt = " & CodAnterior & ")"
        Else
            gStrSql = "SELECT  * From CatArticulos WHERE (CodArticulo = " & Codigo & ") "
        End If
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.UP_SELECT_DATOS"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        Select Case RsGral.RecordCount
            Case Is <= 0
                'No se encontró el código de articulo
                BuscarCodigoArticulo = -1
            Case 1
                BuscarCodigoArticulo = CInt(RsGral.Fields("CodArticulo").Value)
            Case Else
                'Se encontró más de un registro en el catalogo.
                BuscarCodigoArticulo = -2
        End Select
        Exit Function

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Public Function FE() As Boolean
        On Error GoTo Merr

        FE = False
        gStrSql = "SELECT  * From ConfiguracionGeneral WHERE Expira = 1 "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.UP_SELECT_DATOS"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount = 1 Then
            'Sí Expira
            If Today >= RsGral.Fields("FE").Value Then
                MsgBox("EL SISTEMA HA EXPIRADO" & vbNewLine & "NO ES POSIBLE EL ACCESO" & vbNewLine & vbNewLine & "COMUNIQUESE CON SU PROVEEDOR...", MsgBoxStyle.Critical, gstrCorpoNOMBREEMPRESA)
                FE = True
            ElseIf Today >= System.DateTime.FromOADate(RsGral.Fields("FE").Value - 3) Then
                MsgBox("EL SISTEMA ESTA APUNTO DE EXPIRAR" & vbNewLine & vbNewLine & "ES NECESARIO QUE SE COMUNIQUE" & vbNewLine & "CON SU PROVEEDOR...", MsgBoxStyle.Critical, gstrCorpoNOMBREEMPRESA)
                FE = False
            End If
        End If

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    '''INCLUYE EL CODIGO DEL ARTICULO
    Sub TicketSalidaporTransferencia(ByRef Folio As String) ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket

        Dim ImprimirEncabezadoApartado As Boolean
        Dim PosEncaApartado As Integer
        Dim PosIniApartado As Integer
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(20, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(21, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(25, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PosIniCodigo As Integer
        Dim PosIni As Object
        Dim PALABRA As String
        Dim TipoCambio As Double
        Dim FormatoCantidad As String 'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.

        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        gStrSql = "SELECT     ConfiguracionGeneral.NombreEmp AS NomEmpresa, ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & "ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, CatAlmacen.DescAlmacen AS NomSucursal, CatAlmacen.Domicilio AS DirSucursal, " & "M.TipoCambio " & "FROM         CatAlmacen INNER JOIN " & "ConfiguracionGralPV ON CatAlmacen.CodAlmacen = ConfiguracionGralPV.CodAlmacen INNER JOIN " & "MovtosAlmacenCab M ON CatAlmacen.CodAlmacen = M.CodAlmacen CROSS JOIN " & "ConfiguracionGeneral " & "WHERE     (M.FolioAlmacen = '" & Folio & "')"

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            Valores(2) = "" 'Ciudad Empresa
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            Valores(5) = "" 'Ciudad Sucursal
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            Exit Sub
            For I = 0 To 6
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and  CodAlmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then COLS = RsGral.Fields("Columna").Value

        'Obtener los valores de las formulas de la configuracion de Tickets.
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= 'CO' and CodAlmacen = " & gintCodAlmacen & " ORDER BY RENGLON "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RENCABEZ = RsGral.RecordCount
        For I = 1 To RENCABEZ
            Encabez(I, 0) = CDbl(RTrim(RsGral.Fields("Etiqueta").Value)) + IIf(Trim(RsGral.Fields("Etiqueta").Value) = "", "", " ")
            Encabez(I, 2) = RsGral.Fields("Columna").Value
            Encabez(I, 3) = RsGral.Fields("Saltos").Value
            If Trim(RsGral.Fields("Formula").Value) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(RsGral.Fields("Formula").Value))
                    If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                    ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                        Encabez(I, 4) = "A"
                        Select Case PALABRA
                            Case "Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                                Encabez(I, 4) = "S"
                            Case "Dirección Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                                Encabez(I, 4) = "S"
                            Case "Ciudad Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                                Encabez(I, 4) = "S"
                            Case "Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                                Encabez(I, 4) = "S"
                            Case "Dirección Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                                Encabez(I, 4) = "S"
                            Case "Ciudad Sucursal"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                                Encabez(I, 4) = "S"
                            Case "RFC"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                                Encabez(I, 4) = "S"
                            Case "Folio"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                                Encabez(I, 4) = "S"
                                ImprimirEncabezadoApartado = True
                                PosEncaApartado = I
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
            RsGral.MoveNext()
        Next I

Continuar:
        '***************************************************************
        'Impresión de la primera parte del Ticket, Encabezado
        '***************************************************************
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        '    Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To RENCABEZ
            If Encabez(I, 4) = "S" Then
                If ImprimirEncabezadoApartado = True And I = PosEncaApartado Then
                    'Se imprimir el Encabezado de un Ticker de Apartado, esto se hará justo antes de la fecha del ticket
                    'Con este mismo código, se Imprime la Fecha del Ticket
                    PosIniApartado = (COLS - Len("** Salida por transferencia **")) \ 2
                    Linea = Left(Linea & Space(PosIniApartado), PosIniApartado) & "" & "** Salida por transferencia **"
                    ImprimirEncabezadoApartado = False
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                    PrintLine(1, Linea)
                    Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                Else
                    Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                End If
                If Encabez(I, 3) > 0 Then
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        gStrSql = "SELECT     M.FolioAlmacen, M.FechaAlmacen, M.CodAlmacen, M.CodAlmacenRef, M.Envia, M.Entrega AS Transporta, M.Recibe, LTRIM(RTRIM(M.Concepto)) " & "AS concepto, C.DescAlmacen AS DescAlmacenOrigen, C_1.DescAlmacen AS DescAlmacenDestino, Ent.FolioAlmacen as  FolioEntrada, M.Estatus  " & "FROM         MovtosAlmacenCab M INNER JOIN " & "CatAlmacen C ON M.CodAlmacen = C.CodAlmacen INNER JOIN " & "CatAlmacen C_1 ON M.CodAlmacenRef = C_1.CodAlmacen " & "Inner Join ( Select MC.FolioAlmacen, MC.CodAlmacen, MC.FechaAlmacen, MC.ReferenciadeOrigen " & "FROM dbo.MovtosAlmacenCab MC (Nolock) Where MC.CodMovtoAlm = 2 ) Ent On Ent.Referenciadeorigen  = M.FolioAlmacen And Ent.CodAlmacen = M.CodAlmacenRef " & "WHERE     (M.FolioAlmacen = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            PosIniApartado = (COLS - Len("** Salida por transferencia **")) \ 2
            Valores(1) = Left(Linea & Space(PosIniApartado), PosIniApartado) & "" & "** Salida por transferencia **"
            Valores(2) = Left("Folio Sal: " & Folio & Space(30), 30) & Space(5) & "Fecha: " & Format(RsGral.Fields("FechaAlmacen").Value, "DD/MMM/YYYY") 'Fecha
            Valores(3) = CDbl(Left("Folio Ent: " + RsGral.Fields("FolioEntrada").Value + Space(30), 30) & Space(12)) + IIf(UCase(RsGral.Fields("Estatus").Value) = "C", "CANCELADA", "")
            Valores(4) = Left("Almacen Salida: " & Space(17), 17) & Trim(RsGral.Fields("DescAlmacenorigen").Value)
            Valores(5) = Left("Almacen Destino: " & Space(17), 17) & Trim(RsGral.Fields("DescAlmacenDestino").Value)
            Valores(6) = Left("Envia: " & Space(17), 17) & Trim(RsGral.Fields("Envia").Value)
            Valores(7) = Left("Transporta: " & Space(17), 17) & Trim(RsGral.Fields("Transporta").Value)
            Valores(8) = Left("Recibe: " & Space(17), 17) & Trim(RsGral.Fields("Recibe").Value)
            Valores(9) = Left("Concepto: " & Space(17), 17) & Trim(RsGral.Fields("Concepto").Value)
        End If

        For I = 1 To 9
            PrintLine(1, Left(Valores(I), COLS))
        Next I
        PrintLine(1, "")

        If gblnTransfCodigoViejo Then
            gStrSql = "SELECT convert(char(1), A.OrigenAnt) + '-' + right('00000'+ltrim(rtrim(convert(char(5), A.CodigoAnt))),5) as CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioVenta, MD.PrecioVenta * MD.Cantidad AS Importe " & "FROM MovtosAlmacenDet MD INNER JOIN CatArticulos A ON MD.CodArticulo = A.CodArticulo " & "INNER JOIN MovtosAlmacenCab MC ON MC.FolioAlmacen = MD.FolioAlmacen WHERE (MD.FolioAlmacen = '" & Folio & "') "
        Else
            gStrSql = "SELECT MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioVenta, MD.PrecioVenta * MD.Cantidad AS Importe " & "FROM MovtosAlmacenDet MD INNER JOIN " & "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN MovtosAlmacenCab MC ON MC.FolioAlmacen = MD.FolioAlmacen " & "WHERE (MD.FolioAlmacen = '" & Folio & "') "
        End If

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= 'CO'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        RDETALLE = RsGral.RecordCount
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()


        Dim Espacio As Integer
        For H = 1 To recAux.RecordCount
            Valores(0) = recAux.Fields("CodArticulo").Value
            Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
            Valores(2) = recAux.Fields("Cantidad").Value
            Valores(3) = Format(System.Math.Round(recAux.Fields("PrecioVenta").Value, 2), gstrFormatoCantidad) 'pRECIO
            Valores(4) = Format(System.Math.Round(recAux.Fields("importe").Value, 2), gstrFormatoCantidad) 'pRECIO

            RsGral.MoveFirst()
            For I = 0 To 16 + 1
                Detalle(I, 0) = ""
                Detalle(I, 1) = ""
                Detalle(I, 2) = ""
                Detalle(I, 3) = ""
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            Detalle(1, 0) = Right(Space(10) & "ARTICULO", 10)
            Detalle(1, 1) = Detalle(1, 1) + Right(Space(10) & Trim(CStr(Valores(0))), 10) + "  "
            Detalle(1, 2) = 0
            Detalle(1, 3) = 0
            Detalle(1, 4) = "CE"
            For I = 2 To RDETALLE + 1
                Detalle(I, 0) = Right(Space(10) & Trim(RsGral.Fields("Etiqueta").Value), 10)
                Detalle(I, 2) = RsGral.Fields("Columna").Value
                Detalle(I, 3) = RsGral.Fields("Saltos").Value
                If Trim(RsGral.Fields("Formula").Value) <> "" Then
                    PALABRA = ""
                    For J = 1 To Len(Trim(RsGral.Fields("Formula").Value) & " ")
                        FinPal = False
                        If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> ")" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "+" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "(" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "-" And Mid(Trim(RsGral.Fields("Formula").Value), J, 1) <> "*" Then
                            PALABRA = PALABRA & Mid(Trim(RsGral.Fields("Formula").Value), J, 1)
                        ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Descripción"
                                    Detalle(I, 0) = Trim(RsGral.Fields("Etiqueta").Value)
                                    Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                    Detalle(I, 2) = 22
                                    Detalle(I, 4) = "C"
                                Case "Cantidad"
                                    Valor = Valores(2)
                                    Detalle(I, 2) = 10
                                    Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                Case "Precio Público"
                                    Valor = Valores(3)
                                    Detalle(I, 4) = Detalle(I, 4) + "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                            If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Or Detalle(I, 4) = "CE" Then
                                If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                If SIMBOLO = "+" Then
                                    Detalle(I, 1) = Detalle(I, 1) + Valor
                                ElseIf SIMBOLO = "-" Then
                                    Detalle(I, 1) = Detalle(I, 1) - Valor
                                ElseIf SIMBOLO = "*" Then
                                    Detalle(I, 1) = Detalle(I, 1) * Valor
                                End If
                            End If
                            If Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "+" Or Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "" Then
                                SIMBOLO = "+"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "-" Then
                                SIMBOLO = "-"
                            ElseIf Mid(Trim(RsGral.Fields("Formula").Value), J, 1) = "x" Then
                                SIMBOLO = "*"
                            End If
                        End If
                    Next J
                End If
                RsGral.MoveNext()
            Next I
            '*** Encabezado del Detalle
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = 1 To RDETALLE + 1
                    '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    Select Case Trim(Detalle(I, 0))
                        Case "IMPORTE"
                            Espacio = 45
                        Case "ARTICULO"
                            Espacio = 0
                        Case "DESCRIPCION"
                            Espacio = 22
                        Case "CANTIDAD"
                            Espacio = 10
                        Case "PRECIO"
                            Espacio = 30
                    End Select
                    Linea = Left(Linea & Space(COLS), Espacio) + Detalle(I, 0)
                    If Detalle(I, 3) > 0 Then
                        For J = 1 To Detalle(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
            Espacio = 0
            For I = 1 To RDETALLE + 1
                Select Case Trim(Detalle(I, 0))
                    Case "IMPORTE"
                        Espacio = 45
                    Case "ARTICULO"
                        Espacio = 0
                    Case "DESCRIPCION"
                        Espacio = 22
                    Case "CANTIDAD"
                        Espacio = 10
                    Case "PRECIO"
                        Espacio = 30
                End Select

                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
                    Linea = Left(Linea & Space(COLS), Espacio) & Trim(Detalle(I, 1))
                ElseIf Detalle(I, 4) = "CE" Then
                    'Se trata de un dato caracter
                    '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
                    Linea = Left(Linea & Space(COLS), Espacio) + Detalle(I, 1)
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
                    Linea = Left(Linea & Space(COLS), Espacio) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
                Else
                    '''LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), "###,###,##0.00"), 10)
                    Linea = Left(Linea & Space(COLS), Espacio) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                If Detalle(I, 3) > 0 Then
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()
        Next H

        PrintLine(1, "")
        PrintLine(1, "")

        Linea = Left(Linea & Space(COLS), 1) & "_______________"
        Linea = Left(Linea & Space(COLS), 21) & "_______________"
        Linea = Left(Linea & Space(COLS), 42) & "_______________"
        PrintLine(1, Left(RTrim(Linea), COLS))
        Linea = ""
        Linea = Left(Linea & Space(COLS), 7) & "ENVIA"
        Linea = Left(Linea & Space(COLS), 23) & "TRANSPORTA"
        Linea = Left(Linea & Space(COLS), 45) & "RECIBE"
        PrintLine(1, Left(RTrim(Linea), COLS))

        For I = 1 To 5
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    '''Original Reps Corpo - 29 ABR 2004
    '''Sub TicketSalidaporTransferencia(Folio As String)  ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
    '''    On Local Error GoTo Errores
    '''    'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
    '''    'Caja  : Número de Caja, que imprime el Ticket
    '''
    '''    Dim ImprimirEncabezadoApartado As Boolean
    '''    Dim PosEncaApartado As Integer
    '''    Dim PosIniApartado As Integer
    '''    Dim I As Byte
    '''    Dim J As Byte
    '''    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '''    Dim recAux As Recordset
    '''    Dim recTotPzas As Recordset
    '''    Dim RENCABEZ As Byte
    '''    Dim RDETALLE As Byte
    '''    Dim RTOTALES As Byte
    '''    Dim x As Variant
    '''
    '''    Dim Encabez(20, 4) As Variant   'Arreglo que contiene los Datos del Encabezado del Ticket
    '''    Dim Detalle(20, 4) As Variant   'Arreglo que contiene los Datos del Detalle del Ticket
    '''    Dim Totales(25, 4) As Variant   'Arreglo que contiene los Datos de los Totales del Ticket
    '''
    '''    Dim Valores(19) As Variant      'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '''
    '''    Dim PosIniCodigo As Integer
    '''    Dim PosIni
    '''    Dim PALABRA As String
    '''    Dim TipoCambio As Double
    '''    Dim FormatoCantidad As String       'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.
    '''
    '''    ' ** Obtiene Valores para la Fórmula
    '''    '***** ENCABEZADO *****'
    '''    For I = 0 To 19
    '''        Valores(I) = ""
    '''    Next I
    '''
    '''    gStrSql = "SELECT     ConfiguracionGeneral.NombreEmp AS NomEmpresa, ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & _
    ''''                "ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, CatAlmacen.DescAlmacen AS NomSucursal, CatAlmacen.Domicilio AS DirSucursal, " & _
    ''''                "M.TipoCambio " & _
    ''''            "FROM         CatAlmacen INNER JOIN " & _
    ''''                "ConfiguracionGralPV ON CatAlmacen.CodAlmacen = ConfiguracionGralPV.CodAlmacen INNER JOIN " & _
    ''''                "MovtosAlmacenCab M ON CatAlmacen.CodAlmacen = M.CodAlmacen CROSS JOIN " & _
    ''''                "ConfiguracionGeneral " & _
    ''''            "WHERE     (M.FolioAlmacen = '" & Folio & "')"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        TipoCambio = RsGral!TipoCambio
    '''        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '''        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '''        Valores(2) = ""                                                     'Ciudad Empresa
    '''        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '''        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '''        Valores(5) = ""                                                     'Ciudad Sucursal
    '''        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '''    Else
    '''        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '''        Exit Sub
    '''        For I = 0 To 6
    '''            Valores(I) = RsGral.Fields(Val(I))
    '''        Next I
    '''    End If
    '''
    '''    gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and  CodAlmacen = " & gintCodAlmacen
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''     If RsGral.RecordCount > 0 Then COLS = RsGral!Columna
    '''
    '''    'Obtener los valores de las formulas de la configuracion de Tickets.
    '''    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= 'CO' and CodAlmacen = " & gintCodAlmacen & " ORDER BY RENGLON "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    RENCABEZ = RsGral.RecordCount
    '''    For I = 1 To RENCABEZ
    '''        Encabez(I, 0) = RTrim(RsGral!Etiqueta) + IIf(Trim(RsGral!Etiqueta) = "", "", " ")
    '''        '''Encabez(I, 0) = RTrim(RsGral!Etiqueta) + " "
    '''        Encabez(I, 2) = RsGral!Columna
    '''        Encabez(I, 3) = RsGral!Saltos
    ''''        Encabez(I, 4) = "A"
    '''        If Trim(RsGral!Formula) <> "" Then
    '''            PALABRA = ""
    '''            For J = 1 To Len(Trim(RsGral!Formula))
    '''                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" Then
    '''                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '''                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '''                    Encabez(I, 4) = "A"
    '''                    Select Case PALABRA
    '''                        Case "Empresa"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Dirección Empresa"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Ciudad Empresa"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Sucursal"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Dirección Sucursal"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Ciudad Sucursal"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "RFC"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                        Case "Folio"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    ''''                            Encabez(I, 4) = "S"
    '''                        Case "Fecha"
    '''                            Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '''                            Encabez(I, 4) = "S"
    '''                            ImprimirEncabezadoApartado = True
    '''                            PosEncaApartado = I
    ''''                        Case "Hora"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
    ''''                        Case "Tipo de Venta"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
    ''''                        Case "Cajero"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
    ''''                        Case "Vendedor"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
    ''''                        Case "Cliente"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
    ''''                        Case "Tipo de Cambio"
    ''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(14)
    '''                    End Select
    '''                    PALABRA = ""
    '''                End If
    '''            Next J
    '''        End If
    '''        RsGral.MoveNext
    '''    Next I
    '''
    '''Continuar:
    '''    '***************************************************************
    '''    'Impresión de la primera parte del Ticket, Encabezado
    '''    '***************************************************************
    '''    Open gstrTicketPrinter For Output As #1
    ''''    Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '''    Dim LINEA As String
    '''    Print #1, Chr(27) + Chr(33) + Chr(1)
    '''    For I = 1 To RENCABEZ
    '''        If Encabez(I, 4) = "S" Then
    '''            If ImprimirEncabezadoApartado = True And I = PosEncaApartado Then
    '''                'Se imprimir el Encabezado de un Ticker de Apartado, esto se hará justo antes de la fecha del ticket
    '''                'Con este mismo código, se Imprime la Fecha del Ticket
    '''                PosIniApartado = (COLS - Len("** Salida por transferencia **")) \ 2
    '''                LINEA = Left(LINEA + Space(PosIniApartado), PosIniApartado) + "" + "** Salida por transferencia **"
    '''                ImprimirEncabezadoApartado = False
    '''                Print #1, Left(RTrim(LINEA), COLS)
    '''                LINEA = ""
    '''                Print #1, LINEA
    '''                LINEA = Left(LINEA + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''            Else
    '''                LINEA = Left(LINEA + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''            End If
    '''            If Encabez(I, 3) > 0 Then
    '''                For J = 1 To Encabez(I, 3)
    '''                    Print #1, Left(RTrim(LINEA), COLS)
    '''                    LINEA = ""
    '''                Next J
    '''            End If
    '''        End If
    '''    Next I
    '''
    '''    gStrSql = "SELECT     M.FolioAlmacen, M.FechaAlmacen, M.CodAlmacen, M.CodAlmacenRef, M.Envia, M.Entrega AS Transporta, M.Recibe, LTRIM(RTRIM(M.Concepto)) " & _
    ''''                    "AS concepto, C.DescAlmacen AS DescAlmacenOrigen, C_1.DescAlmacen AS DescAlmacenDestino  " & _
    ''''                "FROM         MovtosAlmacenCab M INNER JOIN " & _
    ''''                    "CatAlmacen C ON M.CodAlmacen = C.CodAlmacen INNER JOIN " & _
    ''''                    "CatAlmacen C_1 ON M.CodAlmacenRef = C_1.CodAlmacen " & _
    ''''                "WHERE     (M.FolioAlmacen = '" & Folio & "')"
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        Valores(2) = Left("Folio: " + Folio + Space(25), 25) + Space(5) + "Fecha: " + Format(RsGral!FechaAlmacen, "DD/MMM/YYYY")  'Fecha
    '''        Valores(3) = Left("Almacen Salida: " + Space(17), 17) + Trim(RsGral!DescAlmacenorigen)
    '''        Valores(4) = Left("Almacen Destino: " + Space(17), 17) + Trim(RsGral!DescAlmacenDestino)
    '''        Valores(5) = Left("Envia: " + Space(17), 17) + Trim(RsGral!Envia)
    '''        Valores(6) = Left("Transporta: " + Space(17), 17) + Trim(RsGral!Transporta)
    '''        Valores(7) = Left("Recibe: " + Space(17), 17) + Trim(RsGral!Recibe)
    '''        Valores(8) = Left("Concepto: " + Space(17), 17) + Trim(RsGral!Concepto)
    '''    End If
    '''
    '''    For I = 2 To 8
    '''        Print #1, Left(Valores(I), COLS)
    '''    Next I
    '''    Print #1, ""
    '''    Print #1, ""
    '''
    '''    gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioVenta, MD.PrecioVenta * MD.Cantidad AS Importe " & _
    ''''            "FROM         MovtosAlmacenDet MD INNER JOIN " & _
    ''''                "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & _
    ''''                "MovtosAlmacenCab MC ON MC.FolioAlmacen = MD.FolioAlmacen " & _
    ''''            "WHERE     (MD.FolioAlmacen = '" & Folio & "') "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= 'CO'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    RDETALLE = RsGral.RecordCount
    '''    Dim SIMBOLO As String
    '''    Dim Valor As Double
    '''    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '''    Dim Encabezado As Boolean
    '''    Dim H As Byte
    '''    SIMBOLO = "+"
    '''    Encabezado = True
    '''    recAux.MoveFirst
    '''
    '''
    '''    For H = 1 To recAux.RecordCount
    '''        Valores(0) = recAux!CodArticulo
    '''        Valores(1) = Trim(recAux!DescArticulo)
    '''        Valores(2) = recAux!Cantidad
    '''        Valores(3) = Format(Round(recAux!PrecioVenta, 2), gstrFormatoCantidad)   'pRECIO
    '''        Valores(4) = Format(Round(recAux!Importe, 2), gstrFormatoCantidad)   'pRECIO
    '''
    '''        RsGral.MoveFirst
    '''        For I = 0 To 16
    '''            Detalle(I, 0) = ""
    '''            Detalle(I, 1) = ""
    '''            Detalle(I, 2) = ""
    '''            Detalle(I, 3) = ""
    '''            Detalle(I, 4) = ""
    '''        Next I
    '''
    '''        'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
    '''        For I = 1 To RDETALLE
    '''            Detalle(I, 0) = Right(Space(10) + Trim(RsGral!Etiqueta), 10)
    '''            Detalle(I, 2) = RsGral!Columna
    '''            Detalle(I, 3) = RsGral!Saltos
    '''            If Trim(RsGral!Formula) <> "" Then
    '''                PALABRA = ""
    '''                For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '''                    FinPal = False
    '''                    If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '''                        PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '''                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '''                        FinPal = True
    '''                        Select Case PALABRA
    '''                            Case "Código"
    '''                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '''                                Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
    '''                                Detalle(I, 4) = "C"
    '''                            Case "Descripción"
    '''                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '''                                Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
    '''                                Detalle(I, 4) = "C"
    '''                            Case "Cantidad"
    '''                                Valor = Valores(2)
    '''                                Detalle(I, 4) = Detalle(I, 4) + "E"   'SIGNIFICA QUE ES UN DATO ENTERO
    '''                            Case "Precio Público"
    '''                                Valor = Valores(3)
    '''                                Detalle(I, 4) = Detalle(I, 4) + "D"
    '''                            Case "% Descuento"
    '''                                Valor = Valores(4)
    '''                                Detalle(I, 4) = "D"
    '''                            Case "$ Descuento"
    '''                                Valor = Valores(5)
    '''                                Detalle(I, 4) = "D"
    '''                            Case "$ IVA"
    '''                                Valor = Valores(6)
    '''                                Detalle(I, 4) = "D"
    '''                            Case "% IVA"
    '''                                Valor = Valores(7)
    '''                                Detalle(I, 4) = "D"
    '''                        End Select
    '''                        PALABRA = ""
    '''                        J = J + 1
    '''                        If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
    '''                            If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
    '''                            If SIMBOLO = "+" Then
    '''                                Detalle(I, 1) = Detalle(I, 1) + Valor
    '''                            ElseIf SIMBOLO = "-" Then
    '''                                Detalle(I, 1) = Detalle(I, 1) - Valor
    '''                            ElseIf SIMBOLO = "*" Then
    '''                                Detalle(I, 1) = Detalle(I, 1) * Valor
    '''                            End If
    '''                        End If
    '''                        If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '''                            SIMBOLO = "+"
    '''                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '''                            SIMBOLO = "-"
    '''                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "x" Then
    '''                            SIMBOLO = "*"
    '''                        End If
    '''                    End If
    '''                Next J
    '''            End If
    '''            RsGral.MoveNext
    '''        Next I
    '''        '*** Encabezado del Detalle
    '''        If Encabezado Then
    '''            Encabezado = False
    '''            Print #1, LineaSepara(COLS)
    '''            For I = 1 To RDETALLE
    '''                LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
    '''                If Detalle(I, 3) > 0 Then
    '''                    For J = 1 To Detalle(I, 3)
    '''                        Print #1, Left(RTrim(LINEA), COLS)
    '''                        LINEA = ""
    '''                    Next J
    '''                End If
    '''            Next I
    '''            Print #1, LineaSepara(COLS)
    '''        End If
    '''
    '''        ''''***** DETALLE *****
    '''        For I = 1 To RDETALLE
    '''            If Detalle(I, 4) = "C" Then
    '''                'Se trata de un dato caracter
    '''                LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
    '''            ElseIf Detalle(I, 4) = "E" Then
    '''                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
    '''                If gbytPosicionesDecimal = 0 Then
    '''                    FormatoCantidad = 0
    '''                Else
    '''                    FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '''                End If
    '''                LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
    '''            Else
    '''                LINEA = Left(LINEA + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), "###,###,##0.00"), 10)
    '''            End If
    '''            If Detalle(I, 3) > 0 Then
    '''                For J = 1 To Detalle(I, 3)
    '''                    Print #1, Left(RTrim(LINEA), COLS)
    '''                    LINEA = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        recAux.MoveNext
    '''    Next H
    '''
    '''    Print #1, ""
    '''
    '''    LINEA = Left(LINEA + Space(COLS), 1) + "_______________"
    '''    LINEA = Left(LINEA + Space(COLS), 21) + "_______________"
    '''    LINEA = Left(LINEA + Space(COLS), 42) + "_______________"
    '''    Print #1, Left(RTrim(LINEA), COLS)
    '''    LINEA = ""
    '''    LINEA = Left(LINEA + Space(COLS), 7) + "ENVIA"
    '''    LINEA = Left(LINEA + Space(COLS), 23) + "TRANSPORTA"
    '''    LINEA = Left(LINEA + Space(COLS), 45) + "RECIBE"
    '''    Print #1, Left(RTrim(LINEA), COLS)
    '''
    '''    For I = 1 To 4
    '''        Print #1, ""
    '''    Next I
    '''
    '''    '''Cortar Papel
    '''    Print #1, Chr(27) + Chr(105)
    '''    Close #1
    '''    'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
    '''    Erase Encabez
    '''    Erase Detalle
    '''    Erase Totales
    '''    Erase Valores
    '''    Set recAux = Nothing
    '''Errores:
    '''    If Err.Number = 55 Then
    '''        Close #1
    '''        Err.Clear
    '''        GoTo Continuar
    '''    End If
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    ''''
    '''End Sub

    '''''Sub TicketSalidaporTransferencia(Folio As String)  ', FolioSAD As String, CodCaja As Integer, Reimpresion As Boolean)
    '''''    On Local Error GoTo Errores
    '''''    'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
    '''''    'Caja  : Número de Caja, que imprime el Ticket
    '''''
    '''''    Dim ImprimirEncabezadoApartado As Boolean
    '''''    Dim PosEncaApartado As Integer
    '''''    Dim PosIniApartado As Integer
    '''''    Dim I As Byte
    '''''    Dim J As Byte
    '''''    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '''''    Dim recAux As Recordset
    '''''    Dim recTotPzas As Recordset
    '''''    Dim RENCABEZ As Byte
    '''''    Dim RDETALLE As Byte
    '''''    Dim RTOTALES As Byte
    '''''    Dim x As Variant
    '''''
    '''''    Dim Encabez(20, 4) As Variant   'Arreglo que contiene los Datos del Encabezado del Ticket
    '''''    Dim Detalle(20, 4) As Variant   'Arreglo que contiene los Datos del Detalle del Ticket
    '''''    Dim Totales(25, 4) As Variant   'Arreglo que contiene los Datos de los Totales del Ticket
    '''''
    '''''    Dim Valores(19) As Variant      'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '''''
    '''''    Dim PosIniCodigo As Integer
    '''''    Dim PosIni
    '''''    Dim PALABRA As String
    '''''    Dim TipoCambio As Double
    '''''    Dim FormatoCantidad As String       'Contiene el Formato de DEcimales que se dará a la CAntidad de Artículos, de acuerdo al Parametro de Configuración Gral del PV.
    '''''
    '''''    ' ** Obtiene Valores para la Fórmula
    '''''    '***** ENCABEZADO *****'
    '''''    For I = 0 To 19
    '''''        Valores(I) = ""
    '''''    Next I
    '''''
    '''''    gStrSql = "SELECT     ConfiguracionGeneral.NombreEmp AS NomEmpresa, ConfiguracionGeneral.RFCEmp AS RFCEmpresa, " & _
    ''''''                "ConfiguracionGeneral.DomicilioEmp AS DirEmpresa, CatAlmacen.DescAlmacen AS NomSucursal, CatAlmacen.Domicilio AS DirSucursal, " & _
    ''''''                "M.TipoCambio " & _
    ''''''            "FROM         CatAlmacen INNER JOIN " & _
    ''''''                "ConfiguracionGralPV ON CatAlmacen.CodAlmacen = ConfiguracionGralPV.CodAlmacen INNER JOIN " & _
    ''''''                "MovtosAlmacenCab M ON CatAlmacen.CodAlmacen = M.CodAlmacen CROSS JOIN " & _
    ''''''                "ConfiguracionGeneral " & _
    ''''''            "WHERE     (M.FolioAlmacen = '" & Folio & "')"
    '''''
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set RsGral = Cmd.Execute
    '''''    If RsGral.RecordCount > 0 Then
    '''''        TipoCambio = RsGral!TipoCambio
    '''''        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '''''        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '''''        Valores(2) = ""                                                     'Ciudad Empresa
    '''''        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '''''        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '''''        Valores(5) = ""                                                     'Ciudad Sucursal
    '''''        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '''''    Else
    '''''        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '''''        Exit Sub
    '''''        For I = 0 To 6
    '''''            Valores(I) = RsGral.Fields(Val(I))
    '''''        Next I
    '''''    End If
    '''''
    '''''    gStrSql = "Select * From ConfigTicketVenta Where Grupo= 'C' and  CodAlmacen = " & gintCodAlmacen
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set RsGral = Cmd.Execute
    '''''     If RsGral.RecordCount > 0 Then COLS = RsGral!Columna
    '''''
    '''''    'Obtener los valores de las formulas de la configuracion de Tickets.
    '''''    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'E' and  Tipo= 'CO' and CodAlmacen = " & gintCodAlmacen & " ORDER BY RENGLON "
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set RsGral = Cmd.Execute
    '''''    RENCABEZ = RsGral.RecordCount
    '''''    For I = 1 To RENCABEZ
    '''''        Encabez(I, 0) = RTrim(RsGral!Etiqueta) + IIf(Trim(RsGral!Etiqueta) = "", "", " ")
    '''''        '''Encabez(I, 0) = RTrim(RsGral!Etiqueta) + " "
    '''''        Encabez(I, 2) = RsGral!Columna
    '''''        Encabez(I, 3) = RsGral!Saltos
    ''''''        Encabez(I, 4) = "A"
    '''''        If Trim(RsGral!Formula) <> "" Then
    '''''            PALABRA = ""
    '''''            For J = 1 To Len(Trim(RsGral!Formula))
    '''''                If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" Then
    '''''                    PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '''''                ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '''''                    Encabez(I, 4) = "A"
    '''''                    Select Case PALABRA
    '''''                        Case "Empresa"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Dirección Empresa"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Ciudad Empresa"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Sucursal"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Dirección Sucursal"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Ciudad Sucursal"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "RFC"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                        Case "Folio"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    ''''''                            Encabez(I, 4) = "S"
    '''''                        Case "Fecha"
    '''''                            Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '''''                            Encabez(I, 4) = "S"
    '''''                            ImprimirEncabezadoApartado = True
    '''''                            PosEncaApartado = I
    '''''                    End Select
    '''''                    PALABRA = ""
    '''''                End If
    '''''            Next J
    '''''        End If
    '''''        RsGral.MoveNext
    '''''    Next I
    '''''
    '''''Continuar:
    '''''    '***************************************************************
    '''''    'Impresión de la primera parte del Ticket, Encabezado
    '''''    '***************************************************************
    '''''    Open gstrTicketPrinter For Output As #1
    ''''''    Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '''''    Dim Linea As String
    '''''    Print #1, Chr(27) + Chr(33) + Chr(1)
    '''''    For I = 1 To RENCABEZ
    '''''        If Encabez(I, 4) = "S" Then
    '''''            If ImprimirEncabezadoApartado = True And I = PosEncaApartado Then
    '''''                'Se imprimir el Encabezado de un Ticker de Apartado, esto se hará justo antes de la fecha del ticket
    '''''                'Con este mismo código, se Imprime la Fecha del Ticket
    '''''                PosIniApartado = (COLS - Len("** Salida por transferencia **")) \ 2
    '''''                Linea = Left(Linea + Space(PosIniApartado), PosIniApartado) + "" + "** Salida por transferencia **"
    '''''                ImprimirEncabezadoApartado = False
    '''''                Print #1, Left(RTrim(Linea), COLS)
    '''''                Linea = ""
    '''''                Print #1, Linea
    '''''                Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''''            Else
    '''''                Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''''            End If
    '''''            If Encabez(I, 3) > 0 Then
    '''''                For J = 1 To Encabez(I, 3)
    '''''                    Print #1, Left(RTrim(Linea), COLS)
    '''''                    Linea = ""
    '''''                Next J
    '''''            End If
    '''''        End If
    '''''    Next I
    '''''
    '''''    gStrSql = "SELECT     M.FolioAlmacen, M.FechaAlmacen, M.CodAlmacen, M.CodAlmacenRef, M.Envia, M.Entrega AS Transporta, M.Recibe, LTRIM(RTRIM(M.Concepto)) " & _
    ''''''                    "AS concepto, C.DescAlmacen AS DescAlmacenOrigen, C_1.DescAlmacen AS DescAlmacenDestino  " & _
    ''''''                "FROM         MovtosAlmacenCab M INNER JOIN " & _
    ''''''                    "CatAlmacen C ON M.CodAlmacen = C.CodAlmacen INNER JOIN " & _
    ''''''                    "CatAlmacen C_1 ON M.CodAlmacenRef = C_1.CodAlmacen " & _
    ''''''                "WHERE     (M.FolioAlmacen = '" & Folio & "')"
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set RsGral = Cmd.Execute
    '''''    If RsGral.RecordCount > 0 Then
    '''''        PosIniApartado = (COLS - Len("** Salida por transferencia **")) \ 2
    '''''        Valores(1) = Left(Linea + Space(PosIniApartado), PosIniApartado) + "" + "** Salida por transferencia **"
    '''''        Valores(2) = Left("Folio: " + Folio + Space(25), 25) + Space(5) + "Fecha: " + Format(RsGral!FechaAlmacen, "DD/MMM/YYYY")  'Fecha
    '''''        Valores(3) = Left("Almacen Salida: " + Space(17), 17) + Trim(RsGral!DescAlmacenorigen)
    '''''        Valores(4) = Left("Almacen Destino: " + Space(17), 17) + Trim(RsGral!DescAlmacenDestino)
    '''''        Valores(5) = Left("Envia: " + Space(17), 17) + Trim(RsGral!Envia)
    '''''        Valores(6) = Left("Transporta: " + Space(17), 17) + Trim(RsGral!Transporta)
    '''''        Valores(7) = Left("Recibe: " + Space(17), 17) + Trim(RsGral!Recibe)
    '''''        Valores(8) = Left("Concepto: " + Space(17), 17) + Trim(RsGral!Concepto)
    '''''    End If
    '''''
    '''''    For I = 1 To 8
    '''''        Print #1, Left(Valores(I), COLS)
    '''''    Next I
    '''''    Print #1, ""
    '''''    Print #1, ""
    '''''
    '''''    gStrSql = "SELECT     MD.CodArticulo, A.DescArticulo, MD.Cantidad, MD.PrecioVenta, MD.PrecioVenta * MD.Cantidad AS Importe " & _
    ''''''            "FROM         MovtosAlmacenDet MD INNER JOIN " & _
    ''''''                "CatArticulos A ON MD.CodArticulo = A.CodArticulo INNER JOIN " & _
    ''''''                "MovtosAlmacenCab MC ON MC.FolioAlmacen = MD.FolioAlmacen " & _
    ''''''            "WHERE     (MD.FolioAlmacen = '" & Folio & "') "
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set recAux = Cmd.Execute
    '''''    gStrSql = "SELECT * FROM CONFIGTICKETVENTA WHERE (ETIQUETA <> '' OR FORMULA <> '') AND Grupo = 'D' and  Tipo= 'CO'  and CodAlmacen = " & gintCodAlmacen & "  ORDER BY RENGLON"
    '''''    ModEstandar.BorraCmd
    '''''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''''    Cmd.CommandType = adCmdStoredProc
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''''    Set RsGral = Cmd.Execute
    '''''    RDETALLE = RsGral.RecordCount
    '''''    Dim SIMBOLO As String
    '''''    Dim Valor As Double
    '''''    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '''''    Dim Encabezado As Boolean
    '''''    Dim H As Byte
    '''''    SIMBOLO = "+"
    '''''    Encabezado = True
    '''''    recAux.MoveFirst
    '''''
    '''''
    '''''    For H = 1 To recAux.RecordCount
    '''''        Valores(0) = recAux!CodArticulo
    '''''        Valores(1) = Trim(recAux!DescArticulo)
    '''''        Valores(2) = recAux!Cantidad
    '''''        Valores(3) = Format(Round(recAux!PrecioVenta, 2), gstrFormatoCantidad)   'pRECIO
    '''''        Valores(4) = Format(Round(recAux!Importe, 2), gstrFormatoCantidad)   'pRECIO
    '''''
    '''''        RsGral.MoveFirst
    '''''        For I = 0 To 16
    '''''            Detalle(I, 0) = ""
    '''''            Detalle(I, 1) = ""
    '''''            Detalle(I, 2) = ""
    '''''            Detalle(I, 3) = ""
    '''''            Detalle(I, 4) = ""
    '''''        Next I
    '''''
    '''''        'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
    '''''        For I = 1 To RDETALLE
    '''''            Detalle(I, 0) = Right(Space(10) + Trim(RsGral!Etiqueta), 10)
    '''''            Detalle(I, 2) = RsGral!Columna
    '''''            Detalle(I, 3) = RsGral!Saltos
    '''''            If Trim(RsGral!Formula) <> "" Then
    '''''                PALABRA = ""
    '''''                For J = 1 To Len(Trim(RsGral!Formula) + " ")
    '''''                    FinPal = False
    '''''                    If Mid(Trim(RsGral!Formula), J, 1) <> ")" And Mid(Trim(RsGral!Formula), J, 1) <> "+" And Mid(Trim(RsGral!Formula), J, 1) <> "(" And Mid(Trim(RsGral!Formula), J, 1) <> "-" And Mid(Trim(RsGral!Formula), J, 1) <> "*" Then
    '''''                        PALABRA = PALABRA + Mid(Trim(RsGral!Formula), J, 1)
    '''''                    ElseIf Mid(Trim(RsGral!Formula), J, 1) = ")" Then
    '''''                        FinPal = True
    '''''                        Select Case PALABRA
    '''''                            Case "Código"
    '''''                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '''''                                Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
    '''''                                Detalle(I, 4) = "C"
    '''''                            Case "Descripción"
    '''''                                Detalle(I, 0) = Trim(RsGral!Etiqueta)
    '''''                                Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
    '''''                                Detalle(I, 4) = "C"
    '''''                            Case "Cantidad"
    '''''                                Valor = Valores(2)
    '''''                                Detalle(I, 4) = Detalle(I, 4) + "E"   'SIGNIFICA QUE ES UN DATO ENTERO
    '''''                            Case "Precio Público"
    '''''                                Valor = Valores(3)
    '''''                                Detalle(I, 4) = Detalle(I, 4) + "D"
    '''''                            Case "% Descuento"
    '''''                                Valor = Valores(4)
    '''''                                Detalle(I, 4) = "D"
    '''''                            Case "$ Descuento"
    '''''                                Valor = Valores(5)
    '''''                                Detalle(I, 4) = "D"
    '''''                            Case "$ IVA"
    '''''                                Valor = Valores(6)
    '''''                                Detalle(I, 4) = "D"
    '''''                            Case "% IVA"
    '''''                                Valor = Valores(7)
    '''''                                Detalle(I, 4) = "D"
    '''''                        End Select
    '''''                        PALABRA = ""
    '''''                        J = J + 1
    '''''                        If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
    '''''                            If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
    '''''                            If SIMBOLO = "+" Then
    '''''                                Detalle(I, 1) = Detalle(I, 1) + Valor
    '''''                            ElseIf SIMBOLO = "-" Then
    '''''                                Detalle(I, 1) = Detalle(I, 1) - Valor
    '''''                            ElseIf SIMBOLO = "*" Then
    '''''                                Detalle(I, 1) = Detalle(I, 1) * Valor
    '''''                            End If
    '''''                        End If
    '''''                        If Mid(Trim(RsGral!Formula), J, 1) = "+" Or Mid(Trim(RsGral!Formula), J, 1) = "" Then
    '''''                            SIMBOLO = "+"
    '''''                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "-" Then
    '''''                            SIMBOLO = "-"
    '''''                        ElseIf Mid(Trim(RsGral!Formula), J, 1) = "x" Then
    '''''                            SIMBOLO = "*"
    '''''                        End If
    '''''                    End If
    '''''                Next J
    '''''            End If
    '''''            RsGral.MoveNext
    '''''        Next I
    '''''        '*** Encabezado del Detalle
    '''''        If Encabezado Then
    '''''            Encabezado = False
    '''''            Print #1, LineaSepara(COLS)
    '''''            For I = 1 To RDETALLE
    '''''                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
    '''''                If Detalle(I, 3) > 0 Then
    '''''                    For J = 1 To Detalle(I, 3)
    '''''                        Print #1, Left(RTrim(Linea), COLS)
    '''''                        Linea = ""
    '''''                    Next J
    '''''                End If
    '''''            Next I
    '''''            Print #1, LineaSepara(COLS)
    '''''        End If
    '''''
    '''''        ''''***** DETALLE *****
    '''''        For I = 1 To RDETALLE
    '''''            If Detalle(I, 4) = "C" Then
    '''''                'Se trata de un dato caracter
    '''''                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Trim(Detalle(I, 1))
    '''''            ElseIf Detalle(I, 4) = "E" Then
    '''''                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
    '''''                If gbytPosicionesDecimal = 0 Then
    '''''                    FormatoCantidad = 0
    '''''                Else
    '''''                    FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '''''                End If
    '''''                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
    '''''            Else
    '''''                Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), "###,###,##0.00"), 10)
    '''''            End If
    '''''            If Detalle(I, 3) > 0 Then
    '''''                For J = 1 To Detalle(I, 3)
    '''''                    Print #1, Left(RTrim(Linea), COLS)
    '''''                    Linea = ""
    '''''                Next J
    '''''            End If
    '''''        Next I
    '''''        recAux.MoveNext
    '''''    Next H
    '''''
    '''''    Print #1, ""
    '''''
    '''''    Linea = Left(Linea + Space(COLS), 1) + "_______________"
    '''''    Linea = Left(Linea + Space(COLS), 21) + "_______________"
    '''''    Linea = Left(Linea + Space(COLS), 42) + "_______________"
    '''''    Print #1, Left(RTrim(Linea), COLS)
    '''''    Linea = ""
    '''''    Linea = Left(Linea + Space(COLS), 7) + "ENVIA"
    '''''    Linea = Left(Linea + Space(COLS), 23) + "TRANSPORTA"
    '''''    Linea = Left(Linea + Space(COLS), 45) + "RECIBE"
    '''''    Print #1, Left(RTrim(Linea), COLS)
    '''''
    '''''    For I = 1 To 4
    '''''        Print #1, ""
    '''''    Next I
    '''''
    '''''    '''Cortar Papel
    '''''    Print #1, Chr(27) + Chr(105)
    '''''    Close #1
    '''''    'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
    '''''    Erase Encabez
    '''''    Erase Detalle
    '''''    Erase Totales
    '''''    Erase Valores
    '''''    Set recAux = Nothing
    '''''Errores:
    '''''    If Err.Number = 55 Then
    '''''        Close #1
    '''''        Err.Clear
    '''''        GoTo Continuar
    '''''    End If
    '''''    If Err.Number <> 0 Then ModEstandar.MostrarError
    ''''''
    '''''End Sub

    '''Sub TicketReparacion(Folio As String, lNvo As Boolean, lTipo As String)
    '''    On Error GoTo Errores
    '''    'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
    '''    'Caja  : Número de Caja, que imprime el Ticket
    '''    Dim I As Byte
    '''    Dim J As Byte
    '''    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '''    Dim recAux As Recordset
    '''    Dim recTotPzas As Recordset
    '''    Dim RENCABEZ As Byte
    '''    Dim RDETALLE As Byte
    '''    Dim RTOTALES As Byte
    '''    Dim x As Variant
    '''    Dim LineaInicial As String
    '''    Dim Inicio As Integer
    '''
    '''    Dim Encabez(27, 4) As Variant       'Arreglo que contiene los Datos del Encabezado del Ticket
    '''    Dim Detalle(27, 4) As Variant       'Arreglo que contiene los Datos del Detalle del Ticket
    '''    Dim Totales(28, 4) As Variant       'Arreglo que contiene los Datos de los Totales del Ticket
    '''    Dim ConfigReparacion(28, 5) As Variant 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
    '''                                        ' De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.
    '''
    '''    Dim Valores(19) As Variant      'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '''    Dim PALABRA As String
    '''    Dim TipoPrecio As String
    '''    Dim ImpteIVACtes As Double
    '''    Dim TipoCambio As Double
    '''    Dim DesgloceFormas As Boolean
    '''    Dim RenIniDesg As Integer
    '''    Dim ColIniDesg As Integer
    '''    Dim FormatoCantidad  As String  'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
    '''    Dim TotalAbonos As Currency
    '''    Const C_TamañoEncabezado = 19
    '''    Const C_TamañoDetalle = 0
    '''    Const C_TamañoTotales = 9
    '''
    '''    '***************************************************************
    '''    ' ** Obtiene Valores para la Fórmula
    '''    '***** ENCABEZADO *****'
    '''    For I = 0 To 19
    '''        Valores(I) = ""
    '''    Next I
    '''    ''Llenar el Vector de COnfiguración del Tickect
    '''
    '''    ConfigReparacion(0, 0) = "":                              ConfigReparacion(0, 1) = " ":                                     ConfigReparacion(0, 2) = 56:      ConfigReparacion(0, 3) = 0:       ConfigReparacion(0, 4) = "C"
    '''
    '''    ConfigReparacion(1, 0) = "MARIO RAMOS":                   ConfigReparacion(1, 1) = "":                                      ConfigReparacion(1, 2) = -1:      ConfigReparacion(1, 3) = 2:       ConfigReparacion(1, 4) = "E"
    '''
    '''    ConfigReparacion(2, 0) = "SUCURSAL ":                     ConfigReparacion(2, 1) = "(Sucursal)":                            ConfigReparacion(2, 2) = -1:      ConfigReparacion(2, 3) = 1:       ConfigReparacion(2, 4) = "E"
    '''
    '''    ConfigReparacion(3, 0) = "":                              ConfigReparacion(3, 1) = "(Dirección Sucursal)":                  ConfigReparacion(3, 2) = -1:      ConfigReparacion(3, 3) = 2:       ConfigReparacion(3, 4) = "E"
    '''
    '''    ConfigReparacion(4, 0) = "MATRIZ":                        ConfigReparacion(4, 1) = "":                                      ConfigReparacion(4, 2) = -1:      ConfigReparacion(4, 3) = 1:       ConfigReparacion(4, 4) = "E"
    '''
    '''    ConfigReparacion(5, 0) = "":                              ConfigReparacion(5, 1) = "(Empresa)":                             ConfigReparacion(5, 2) = -1:      ConfigReparacion(5, 3) = 1:       ConfigReparacion(5, 4) = "E"
    '''
    '''    ConfigReparacion(6, 0) = "":                              ConfigReparacion(6, 1) = "(Dirección Empresa)+(Ciudad Empresa)":  ConfigReparacion(6, 2) = -1:      ConfigReparacion(6, 3) = 1:       ConfigReparacion(6, 4) = "E"
    '''
    '''    ConfigReparacion(7, 0) = "RFC:":                          ConfigReparacion(7, 1) = "(RFC)":                                 ConfigReparacion(7, 2) = -1:      ConfigReparacion(7, 3) = 2:       ConfigReparacion(7, 4) = "E"
    '''
    '''    ConfigReparacion(8, 0) = "***  R E P A R A C I O N  ***": ConfigReparacion(8, 1) = "":                                      ConfigReparacion(8, 2) = -1:      ConfigReparacion(8, 3) = 2:       ConfigReparacion(8, 4) = "E"
    '''
    '''    ConfigReparacion(9, 0) = "FECHA: ":                       ConfigReparacion(9, 1) = "(Fecha)+(Hora)":                        ConfigReparacion(9, 2) = 1:       ConfigReparacion(9, 3) = 0:       ConfigReparacion(9, 4) = "E"
    '''
    '''    ConfigReparacion(10, 0) = "FOLIO: ":                      ConfigReparacion(10, 1) = "(Folio)":                              ConfigReparacion(10, 2) = 30:     ConfigReparacion(10, 3) = 1:      ConfigReparacion(10, 4) = "E"
    '''
    '''    ConfigReparacion(11, 0) = "VENDEDOR: ":                   ConfigReparacion(11, 1) = "(Vendedor)":                           ConfigReparacion(11, 2) = 1:      ConfigReparacion(0, 3) = 1:       ConfigReparacion(11, 4) = "E"
    '''
    '''    ConfigReparacion(12, 0) = "CLIENTE: ":                    ConfigReparacion(12, 1) = "(Cliente)":                            ConfigReparacion(12, 2) = 1:      ConfigReparacion(12, 3) = 1:      ConfigReparacion(12, 4) = "E"
    '''
    '''    ConfigReparacion(13, 0) = "TEL. CLIENTE: ":               ConfigReparacion(13, 1) = "(Teléfono Cliente)":                   ConfigReparacion(13, 2) = 1:      ConfigReparacion(13, 3) = 0:      ConfigReparacion(13, 4) = "E"
    '''
    '''    ConfigReparacion(14, 0) = "":                             ConfigReparacion(14, 1) = "(BlnCredito)":                         ConfigReparacion(14, 2) = 38:     ConfigReparacion(14, 3) = 1:      ConfigReparacion(14, 4) = "E"
    '''
    '''    ConfigReparacion(15, 0) = "":                             ConfigReparacion(15, 1) = "(strLugar)":                           ConfigReparacion(15, 2) = 38:     ConfigReparacion(15, 3) = 2:      ConfigReparacion(15, 4) = "E"
    '''
    '''
    '''    ConfigReparacion(16, 0) = "MOTIVO DE LA REPARACION ":     ConfigReparacion(16, 1) = "":                                     ConfigReparacion(16, 2) = 1:      ConfigReparacion(16, 3) = 1:      ConfigReparacion(16, 4) = "E"
    '''
    '''    ConfigReparacion(17, 0) = "":                             ConfigReparacion(17, 1) = "(Linea Separa)":                       ConfigReparacion(17, 2) = 1:      ConfigReparacion(17, 3) = 1:      ConfigReparacion(17, 4) = "E"
    '''
    '''    ConfigReparacion(18, 0) = "":                             ConfigReparacion(18, 1) = "(Motivo Reparacion)":                  ConfigReparacion(18, 2) = 1:      ConfigReparacion(18, 3) = 1:      ConfigReparacion(18, 4) = "E"
    '''
    '''    ConfigReparacion(19, 0) = "":                             ConfigReparacion(19, 1) = "(Linea Separa)":                       ConfigReparacion(19, 2) = 1:      ConfigReparacion(19, 3) = 2:      ConfigReparacion(19, 4) = "E"
    '''
    '''
    '''    ConfigReparacion(20, 0) = "IMP. REPARACION:":             ConfigReparacion(20, 1) = "(Importe Reparacion)":                 ConfigReparacion(20, 2) = 30:     ConfigReparacion(20, 3) = 1:      ConfigReparacion(20, 4) = "T"
    '''
    '''    ConfigReparacion(21, 0) = "ANTICIPO:":                    ConfigReparacion(21, 1) = "(Anticipo)":                           ConfigReparacion(21, 2) = 30:     ConfigReparacion(21, 3) = 1:      ConfigReparacion(21, 4) = "T"
    '''
    '''    ConfigReparacion(22, 0) = "ABONOS:":                      ConfigReparacion(22, 1) = "(Abonos)":                             ConfigReparacion(22, 2) = 30:     ConfigReparacion(22, 3) = 1:      ConfigReparacion(22, 4) = "T"
    '''
    '''    ConfigReparacion(23, 0) = "-------------------------":    ConfigReparacion(23, 1) = " ":                                    ConfigReparacion(23, 2) = 30:     ConfigReparacion(23, 3) = 1:      ConfigReparacion(23, 4) = "T"
    '''
    '''    ConfigReparacion(24, 0) = "SALDO:":                       ConfigReparacion(24, 1) = "(Saldo)":                              ConfigReparacion(24, 2) = 30:     ConfigReparacion(24, 3) = 6:      ConfigReparacion(24, 4) = "T"
    '''
    '''    ConfigReparacion(25, 0) = "____________________":         ConfigReparacion(25, 1) = " ":                                    ConfigReparacion(25, 2) = 6:      ConfigReparacion(25, 3) = 0:      ConfigReparacion(25, 4) = "T"
    '''
    '''    ConfigReparacion(26, 0) = "____________________":         ConfigReparacion(26, 1) = " ":                                    ConfigReparacion(26, 2) = 35:     ConfigReparacion(26, 3) = 1:      ConfigReparacion(26, 4) = "T"
    '''
    '''    ConfigReparacion(27, 0) = "ENCARGADO":                    ConfigReparacion(27, 1) = " ":                                    ConfigReparacion(27, 2) = 12:     ConfigReparacion(27, 3) = 0:      ConfigReparacion(27, 4) = "T"
    '''
    '''    ConfigReparacion(28, 0) = "CLIENTE":                      ConfigReparacion(28, 1) = " ":                                    ConfigReparacion(28, 2) = 43:     ConfigReparacion(28, 3) = 1:      ConfigReparacion(28, 4) = "T"
    '''
    '''
    '''    gStrSql = "SELECT  CG.NombreEmp AS NomEmpresa, CG.RFCEmp AS RFCEmpresa, CG.DomicilioEmp AS DirEmpresa, A.DescAlmacen AS NomSucursal, " & _
    ''''              "A.Domicilio AS DirSucursal, R.TipoCambio ,Ltrim(Rtrim(R.MotivoReparacion)) As MotivoReparacion, Credito " & _
    ''''              "FROM dbo.CatAlmacen A INNER JOIN " & _
    ''''              "dbo.ConfiguracionGralPV CPV ON A.CodAlmacen = CPV.CodAlmacen INNER JOIN " & _
    ''''              "dbo.Reparaciones R ON A.CodAlmacen = R.CodSucursal CROSS JOIN " & _
    ''''              "dbo.ConfiguracionGeneral CG " & _
    ''''              "WHERE (R.FolioReparacion = '" & Folio & "')"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        TipoCambio = RsGral!TipoCambio
    '''        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '''        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '''        Valores(2) = ""                                                     'Ciudad Empresa
    '''        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '''        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '''        Valores(5) = ""                                                     'Ciudad Sucursal
    '''        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '''        Valores(11) = ModEstandar.QuitaEnter(RsGral!MotivoReparacion)
    '''        Valores(14) = IIf(RsGral!Credito, "CREDITO", "")
    '''    Else
    '''        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '''        For I = 0 To 6
    '''            Valores(I) = RsGral.Fields(Val(I))
    '''        Next I
    '''    End If
    '''
    '''    gStrSql = "SELECT LTRIM(RTRIM(C.TelCasa)) + SPACE(2) + C.TelOficina AS TelCliente, V.DescVendedor AS DescVendedor, " & _
    ''''              "R.FolioReparacion , R.FechaReparacion, R.Nombre " & _
    ''''              "FROM dbo.CatClientes C INNER JOIN " & _
    ''''              "dbo.Reparaciones R ON C.CodCliente = R.CodCliente INNER JOIN " & _
    ''''              "dbo.CatVendedores V ON R.CodVendedor = V.CodVendedor " & _
    ''''              "WHERE (R.FolioReparacion = '" & Folio & "')"
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        Valores(7) = Folio
    '''        Valores(8) = Format(RsGral!FechaReparacion, "DD/MMM/YYYY")      'Fecha
    '''        Valores(9) = Format(Date, "HH:MM")                'Hora
    '''        Valores(10) = Trim(RsGral!TelCliente)                           'Telefono del CLiente
    '''        Valores(12) = Trim(RsGral!DescVendedor)                         'Vendedor
    '''        Valores(13) = Trim(RsGral!Nombre)                               'Cliente
    '''    End If
    '''
    '''    COLS = ConfigReparacion(0, 2)
    '''
    '''    For I = 1 To C_TamañoEncabezado  'Tamaño del Vector de Configuracion del Ticket
    '''       If ConfigReparacion(I, 4) <> "E" Then Exit For
    '''            Encabez(I, 0) = ConfigReparacion(I, 0)
    '''            Encabez(I, 2) = ConfigReparacion(I, 2)
    '''            Encabez(I, 3) = ConfigReparacion(I, 3)
    '''            Encabez(I, 4) = "S"
    '''            If ConfigReparacion(I, 1) <> "" Then
    '''                PALABRA = ""
    '''                For J = 1 To Len(Trim(ConfigReparacion(I, 1)))
    '''                    If Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "(" Then
    '''                        PALABRA = PALABRA + Mid(Trim(ConfigReparacion(I, 1)), J, 1)
    '''                    ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = ")" Then
    '''                        Select Case PALABRA
    '''                            Case "Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '''                            Case "Dirección Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '''                            Case "Ciudad Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '''                            Case "Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '''                            Case "Dirección Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '''                            Case "Ciudad Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '''                            Case "RFC"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '''                            Case "Folio"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    '''                            Case "Fecha"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '''                            Case "Hora"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
    '''                            Case "Teléfono Cliente"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
    '''                            Case "Vencimiento"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
    '''                            Case "Vendedor"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
    '''                            Case "Cliente"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
    '''                            Case "Motivo Reparacion"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
    '''                                Encabez(I, 4) = "M"
    '''                            Case "Linea Separa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + LineaSepara(COLS)
    '''                            Case "BlnCredito"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(14) + "  "
    '''                            Case "strLugar"
    '''                                Encabez(I, 1) = Encabez(I, 1) + IIf(lTipo = "C", "ENVIO CORPORATIVO", IIf(lTipo = "T", "ENVIO TALLER", IIf(lTipo = "RP", "REGRESO PTO VTA", "")))
    '''                        End Select
    '''                        PALABRA = ""
    '''                    End If
    '''                Next J
    '''            End If
    '''   Next I
    '''Continuar:
    '''    'Impresión de la primera parte del Ticket, Encabezado
    '''    ''Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '''
    '''    Open gstrTicketPrinter For Output As #1
    '''
    '''    Dim Linea As String
    '''    Print #1, Chr(27) + Chr(33) + Chr(1)
    '''    For I = 1 To C_TamañoEncabezado
    '''        If Encabez(I, 4) = "S" Then
    '''            If CDbl(ConfigReparacion(I, 2)) = -1 Then
    '''                Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
    '''                If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
    '''            End If
    '''            Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''            For J = 1 To Encabez(I, 3)
    '''                Print #1, Left(RTrim(Linea), COLS)
    '''                Linea = ""
    '''            Next J
    '''        Else
    '''             If CDbl(ConfigReparacion(I, 2)) = -1 Then
    '''                Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
    '''                If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
    '''            End If
    '''            Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''            LineaInicial = Linea
    '''            Inicio = 1
    '''            While Inicio <= Len(LineaInicial)
    '''                Linea = " " + Mid(Trim(LineaInicial), Inicio, COLS - 1)
    '''                Inicio = Inicio + COLS
    '''                Print #1, " " + Left(RTrim(Trim(Linea)), COLS - 1)
    '''            Wend
    '''        End If
    '''    Next I
    '''
    '''    Dim SIMBOLO As String
    '''    Dim Valor As Double
    '''    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '''    Dim Encabezado As Boolean
    '''    Dim H As Byte
    '''    SIMBOLO = "+"
    '''
    '''    '''Cuando es nuevo no muestra las totales.  Estos salen en 0.00, y es para que no cree confucion con el cliente
    '''    '''en el importe total de la reparación
    '''    '***** TOTALES *****}
    '''    gStrSql = "SELECT     R.ImporteVta, R.Anticipo, R.TipoCambio, ISNULL(SUM(I.Total), 0) AS Abonos " & _
    ''''              "FROM         dbo.Reparaciones R LEFT OUTER JOIN " & _
    ''''              "dbo.Ingresos I ON I.FolioMovto = R.FolioReparacion AND I.TipoIngreso <> 'A' " & _
    ''''              "WHERE     (R.FolioReparacion = '" & Trim(Folio) & "') " & _
    ''''              "GROUP BY R.ImporteVta, R.Anticipo, R.TipoCambio "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''       Valores(0) = Format(Round(RsGral!Abonos * TipoCambio, 1), gstrFormatoCantidad)            'Abonos
    '''       Valores(1) = Format(Round(RsGral!ImporteVta * RsGral!TipoCambio, 1), gstrFormatoCantidad)      'Imoprte total
    '''       Valores(2) = Format(Round(RsGral!Anticipo * RsGral!TipoCambio, 1), gstrFormatoCantidad)            'Anticipo
    '''       TotalAbonos = (CCur(Numerico(CStr(Valores(2)))) + CCur(Numerico(CStr(Valores(0)))))
    '''       Valores(3) = Format(Valores(1) - TotalAbonos, gstrFormatoCantidad)      'Saldo
    '''    End If
    '''
    '''    gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV Where CodAlmacen = " & gintCodAlmacen
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''    If recAux.RecordCount > 0 Then
    '''       Valores(4) = Trim(recAux!MsgNormal)
    '''       Valores(5) = Trim(recAux!MsgFiscal)
    '''       Valores(6) = Trim(recAux!MsgCredito)
    '''    End If
    '''
    '''    For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
    '''       If lNvo Then
    '''          Select Case UCase(Trim(ConfigReparacion(I, 0)))
    '''                 Case "IMP. REPARACION:", "ANTICIPO:", "ABONOS:", "-------------------------", "SALDO:"
    '''                      Totales(I, 0) = ""
    '''                 Case Else
    '''                      Totales(I, 0) = ConfigReparacion(I, 0)
    '''          End Select
    '''       Else
    '''          Totales(I, 0) = ConfigReparacion(I, 0)
    '''       End If
    '''       Totales(I, 2) = ConfigReparacion(I, 2)
    '''       Totales(I, 3) = ConfigReparacion(I, 3)
    '''       Totales(I, 4) = "C"
    '''
    '''       If Trim(ConfigReparacion(I, 1)) <> "" Then
    '''           PALABRA = ""
    '''           For J = 1 To Len(Trim(ConfigReparacion(I, 1)) + " ")
    '''               FinPal = False
    '''               If Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "*" Then
    '''                   PALABRA = PALABRA + Mid(Trim(ConfigReparacion(I, 1)), J, 1)
    '''               ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = ")" Then
    '''                   FinPal = True
    '''                   Select Case PALABRA
    '''                       Case "Importe Reparacion"
    '''                           If Not lNvo Then Valor = Valores(1)
    '''                           Totales(I, 4) = "N"
    '''                       Case "Mensaje Normal"
    '''                           Totales(I, 1) = Totales(I, 1) + Valores(4) + "  "
    '''                           Totales(I, 4) = "C"
    '''                       Case "Mensaje Fiscal"
    '''                           Totales(I, 1) = Totales(I, 1) + Valores(5) + "  "
    '''                           Totales(I, 4) = "C"
    '''                       Case "Formas de Pago"
    '''                           Totales(I, 1) = "FORPAG"
    '''                           Totales(I, 4) = "C"
    '''                       Case "Anticipo"
    '''                           If Not lNvo Then Valor = Valores(2)
    '''                           Totales(I, 4) = "N"
    '''                       Case "Saldo"
    '''                           If Not lNvo Then Valor = Valores(3)
    '''                           Totales(I, 4) = "N"
    '''                       Case "Abonos"
    '''                           If Not lNvo Then Valor = Valores(0)
    '''                           Totales(I, 4) = "N"
    '''                       Case "Mensaje Crédito"
    '''                           Totales(I, 1) = Totales(I, 1) + Valores(6) + "  "
    '''                           Totales(I, 4) = "C"
    '''                   End Select
    '''                   PALABRA = ""
    '''                   J = J + 1
    '''                   If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
    '''                       If Totales(I, 1) = "" Then Totales(I, 1) = 0
    '''                       If SIMBOLO = "+" Then
    '''                           Totales(I, 1) = Totales(I, 1) + Valor
    '''                       ElseIf SIMBOLO = "-" Then
    '''                           Totales(I, 1) = Totales(I, 1) - Valor
    '''                       ElseIf SIMBOLO = "*" Then
    '''                           Totales(I, 1) = Totales(I, 1) * Valor
    '''                       End If
    '''                   End If
    '''                   If Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "" Then
    '''                       SIMBOLO = "+"
    '''                   ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "-" Then
    '''                       SIMBOLO = "-"
    '''                   ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "*" Then
    '''                       SIMBOLO = "*"
    '''                   End If
    '''               End If
    '''           Next J
    '''       End If
    '''    Next I
    '''
    '''    For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
    '''        If Totales(I, 4) = "C" Then
    '''            If Totales(I, 1) = "FORPAG" Then
    '''                Dim D As Byte
    '''                Dim recDesg As Recordset
    '''                gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & _
    ''''                            "FROM         dbo.CatFormasPago INNER JOIN " & _
    ''''                            "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & _
    ''''                            "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & _
    ''''                            "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & _
    ''''                            "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
    '''                ModEstandar.BorraCmd
    '''                Cmd.CommandText = "dbo.Up_Select_Datos"
    '''                Cmd.CommandType = adCmdStoredProc
    '''                Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''                Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''                Set recDesg = Cmd.Execute
    '''                For D = 1 To recDesg.RecordCount
    '''                    Linea = Space(Totales(I, 2)) + Left(recDesg!DescFormaPago + Space(16), 16) + Right(Space(10) + Format(recDesg!importe, "###,###,##0.00"), 10)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    recDesg.MoveNext
    '''                Next D
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
    '''            End If
    '''        ElseIf Detalle(I, 4) = "E" Then
    '''            'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
    '''            If gbytPosicionesDecimal = 0 Then
    '''                FormatoCantidad = 0
    '''            Else
    '''                FormatoCantidad = "0." + String(gbytPosicionesDecimal, "0")
    '''            End If
    '''            Linea = Left(Linea + Space(COLS), Detalle(I, 2)) + Right(Space(10) + Format(Detalle(I, 1), FormatoCantidad), 10)
    '''        Else
    '''            If Trim(CStr(Totales(I, 0))) = "" Then
    '''               Linea = ""
    '''            Else
    '''               Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Right(Space(10) + Format(Totales(I, 1), "###,###,##0.00"), 10)
    '''            End If
    '''        End If
    '''        If CCur(Numerico(Trim(CStr(Totales(I, 3))))) > 0 Then
    '''            For J = 1 To Totales(I, 3)
    '''                If Totales(I, 1) = "FORPAG" Then Linea = ""
    '''                If Linea = "      ____________________         ____________________" Then
    '''                   Print #1, ""
    '''                   Print #1, ""
    '''                End If
    '''                If Trim(Linea) <> "" Then Print #1, Left(RTrim(Linea), COLS)
    '''                Linea = ""
    '''            Next J
    '''        End If
    '''    Next I
    '''
    '''    For I = 1 To 6
    '''        Print #1, ""
    '''    Next I
    '''
    '''    '''Cortar Papel
    '''    Print #1, Chr(27) + Chr(105)
    '''    Close #1
    '''
    '''    'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
    '''    ''x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
    '''    Erase Encabez
    '''    Erase Detalle
    '''    Erase Totales
    '''    Erase Valores
    '''    Set recAux = Nothing
    '''    Exit Sub
    '''
    '''Errores:
    '''    If Err.Number = 55 Then
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''        Close #1
    '''        Err.Clear
    '''        GoTo Continuar
    '''    End If
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''End Sub

    Sub TicketReparacion(ByRef Folio As String, ByRef lNvo As Boolean, ByRef lTipo As String)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim recTotPzas As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object
        Dim LineaInicial As String
        Dim Inicio As Integer

        Dim Encabez(27, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(27, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(30, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket
        Dim ConfigReparacion(30, 5) As Object 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
        ' De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.

        Dim Valores(19) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
        Dim TotalAbonos As Decimal
        Const C_TamañoEncabezado As Integer = 20
        Const C_TamañoDetalle As Integer = 0
        Const C_TamañoTotales As Integer = 10

        '***************************************************************
        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 19
            Valores(I) = ""
        Next I
        ''Llenar el Vector de COnfiguración del Tickect

        ConfigReparacion(0, 0) = ""
        ConfigReparacion(0, 1) = " "
        ConfigReparacion(0, 2) = 56
        ConfigReparacion(0, 3) = 0
        ConfigReparacion(0, 4) = "C"

        ConfigReparacion(1, 0) = "MARIO RAMOS"
        ConfigReparacion(1, 1) = ""
        ConfigReparacion(1, 2) = -1
        ConfigReparacion(1, 3) = 2
        ConfigReparacion(1, 4) = "E"

        ConfigReparacion(2, 0) = "SUCURSAL "
        ConfigReparacion(2, 1) = "(Sucursal)"
        ConfigReparacion(2, 2) = -1
        ConfigReparacion(2, 3) = 1
        ConfigReparacion(2, 4) = "E"
        ConfigReparacion(3, 0) = ""
        ConfigReparacion(3, 1) = "(Dirección Sucursal)"
        ConfigReparacion(3, 2) = -1
        ConfigReparacion(3, 3) = 2
        ConfigReparacion(3, 4) = "E"

        ConfigReparacion(4, 0) = "MATRIZ"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(4, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(4, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(4, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(4, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(5, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(5, 1) = "(Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(5, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(5, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(5, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(6, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(6, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(6, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(6, 1) = "(Dirección Empresa)+(Ciudad Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(6, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(6, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(6, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(6, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(6, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(6, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(7, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(7, 0) = "RFC:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(7, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(7, 1) = "(RFC)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(7, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(7, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(7, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(7, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(7, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(7, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(8, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(8, 0) = "***  R E P A R A C I O N  ***"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(8, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(8, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(8, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(8, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(8, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(8, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(8, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(8, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(9, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(9, 0) = "FECHA: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(9, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(9, 1) = "(Fecha)+(Hora)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(9, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(9, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(9, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(9, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(9, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(9, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(10, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(10, 0) = "FOLIO: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(10, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(10, 1) = "(Folio)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(10, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(10, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(10, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(10, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(10, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(10, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(11, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(11, 0) = "VENDEDOR: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(11, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(11, 1) = "(Vendedor)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(11, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(11, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(0, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(0, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(11, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(11, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(12, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(12, 0) = "CLIENTE: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(12, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(12, 1) = "(Cliente)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(12, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(12, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(12, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(12, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(12, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(12, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(13, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(13, 0) = "TEL. CLIENTE: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(13, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(13, 1) = "(Teléfono Cliente)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(13, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(13, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(13, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(13, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(13, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(13, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(14, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(14, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(14, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(14, 1) = "(BlnCredito)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(14, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(14, 2) = 38
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(14, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(14, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(14, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(14, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(15, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(15, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(15, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(15, 1) = "(strLugar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(15, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(15, 2) = 38
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(15, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(15, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(15, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(15, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(16, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(16, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(16, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(16, 1) = "(strTaller)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(16, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(16, 2) = 38
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(16, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(16, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(16, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(16, 4) = "E"


        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(17, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(17, 0) = "MOTIVO DE LA REPARACION "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(17, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(17, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(17, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(17, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(17, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(17, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(17, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(17, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(18, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(18, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(18, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(18, 1) = "(Linea Separa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(18, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(18, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(18, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(18, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(18, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(18, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(19, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(19, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(19, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(19, 1) = "(Motivo Reparacion)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(19, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(19, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(19, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(19, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(19, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(19, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(20, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(20, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(20, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(20, 1) = "(Linea Separa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(20, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(20, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(20, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(20, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(20, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(20, 4) = "E"


        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(21, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(21, 0) = "IMP. REPARACION:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(21, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(21, 1) = "(Importe Reparacion)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(21, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(21, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(21, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(21, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(21, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(21, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(22, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(22, 0) = "ANTICIPO:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(22, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(22, 1) = "(Anticipo)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(22, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(22, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(22, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(22, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(22, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(22, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(23, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(23, 0) = "ABONOS:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(23, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(23, 1) = "(Abonos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(23, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(23, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(23, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(23, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(23, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(23, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(24, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(24, 0) = "-------------------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(24, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(24, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(24, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(24, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(24, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(24, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(24, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(24, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(25, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(25, 0) = "SALDO:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(25, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(25, 1) = "(Saldo)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(25, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(25, 2) = 30
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(25, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(25, 3) = 6
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(25, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(25, 4) = "T"

        If lTipo = "SC" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 0) = "REPARACION SIN CTO P/CTE"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 2) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 3) = 2
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 4) = "T"
        Else
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 0) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 2) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(26, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(26, 4) = "T"
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(27, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(27, 0) = "____________________"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(27, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(27, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(27, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(27, 2) = 6
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(27, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(27, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(27, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(27, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(28, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(28, 0) = "____________________"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(28, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(28, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(28, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(28, 2) = 35
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(28, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(28, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(28, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigReparacion(28, 4) = "T"

        If lTipo = "RP" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 0) = "CORPORATIVO"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 2) = 12
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 0) = "PTO VTA"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 2) = 43
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 4) = "T"
        ElseIf lTipo = "C" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 0) = "PTO VTA"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 2) = 12
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 0) = "CORPORATIVO"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 2) = 43
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 4) = "T"
        ElseIf lTipo = "T" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 0) = "CORPORATIVO"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 2) = 12
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 0) = "TALLER"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 2) = 43
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 4) = "T"
        ElseIf lTipo = "" Or lTipo = "P" Or lTipo = "SC" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 0) = "ENCARGADO"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 2) = 12
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(29, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(29, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 0) = "CLIENTE"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 2) = 43
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(30, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigReparacion(30, 4) = "T"
        End If

        gStrSql = "SELECT  CG.NombreEmp AS NomEmpresa, CG.RFCEmp AS RFCEmpresa, CG.DomicilioEmp AS DirEmpresa, A.DescAlmacen AS NomSucursal, " & "A.Domicilio AS DirSucursal, R.TipoCambio, ltrim(rtrim(IsNull(T.DescTaller,''))) as Taller, Ltrim(Rtrim(R.MotivoReparacion)) As MotivoReparacion, Credito " & "FROM dbo.CatAlmacen A INNER JOIN " & "dbo.ConfiguracionGralPV CPV ON A.CodAlmacen = CPV.CodAlmacen INNER JOIN " & "dbo.Reparaciones R ON A.CodAlmacen = R.CodSucursal CROSS JOIN " & "dbo.ConfiguracionGeneral CG Left Outer Join CatTalleres T On R.CodTaller = T.CodTaller " & "WHERE (R.FolioReparacion = '" & Folio & "')"

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = ModEstandar.QuitaEnter(RsGral.Fields("MotivoReparacion").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(14) = IIf(RsGral.Fields("Credito").Value, "CREDITO", "")
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(15) = UCase(Trim(RsGral.Fields("Taller").Value))
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            For I = 0 To 19
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = "SELECT LTRIM(RTRIM(C.TelCasa)) + SPACE(2) + C.TelOficina AS TelCliente, V.DescVendedor AS DescVendedor, " & "R.FolioReparacion , R.FechaReparacion, R.Nombre " & "FROM dbo.CatClientes C INNER JOIN " & "dbo.Reparaciones R ON C.CodCliente = R.CodCliente INNER JOIN " & "dbo.CatVendedores V ON R.CodVendedor = V.CodVendedor " & "WHERE (R.FolioReparacion = '" & Folio & "')"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Folio
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(RsGral.Fields("FechaReparacion").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM") 'Hora
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = Trim(RsGral.Fields("TelCliente").Value) 'Telefono del CLiente
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(12) = Trim(RsGral.Fields("DescVendedor").Value) 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(13) = Trim(RsGral.Fields("Nombre").Value) 'Cliente
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        COLS = ConfigReparacion(0, 2)

        For I = 1 To C_TamañoEncabezado 'Tamaño del Vector de Configuracion del Ticket
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigReparacion(I, 4) <> "E" Then Exit For
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = ConfigReparacion(I, 0)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = ConfigReparacion(I, 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = ConfigReparacion(I, 3)
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigReparacion(I, 1) <> "" Then
                PALABRA = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Len(Trim(ConfigReparacion(I, 1)))
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "(" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        PALABRA = PALABRA & Mid(Trim(ConfigReparacion(I, 1)), J, 1)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = ")" Then
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Teléfono Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Vencimiento"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(12) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(13) + "  "
                            Case "Motivo Reparacion"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(11) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 4) = "M"
                            Case "Linea Separa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + LineaSepara(COLS)
                            Case "BlnCredito"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(14). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(14) + "  "
                            Case "strLugar"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + IIf(lTipo = "C", "ENVIO CORPORATIVO", IIf(lTipo = "T", "ENVIO TALLER", IIf(lTipo = "RP", "REGRESO PTO VTA", "")))
                            Case "strTaller"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(15). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If lTipo = "T" Then Encabez(I, 1) = Encabez(I, 1) + Valores(15) + "  "
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
        Next I
Continuar:
        'Impresión de la primera parte del Ticket, Encabezado
        ''Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.

        FileOpen(1, gstrTicketPrinter, OpenMode.Output)

        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To C_TamañoEncabezado
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If CDbl(ConfigReparacion(I, 2)) = -1 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Encabez(I, 3)
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            Else
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If CDbl(ConfigReparacion(I, 2)) = -1 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                LineaInicial = Linea
                Inicio = 1
                While Inicio <= Len(LineaInicial)
                    Linea = " " & Mid(Trim(LineaInicial), Inicio, COLS - 1)
                    Inicio = Inicio + COLS
                    PrintLine(1, " " & Left(RTrim(Trim(Linea)), COLS - 1))
                End While
            End If
        Next I

        For I = 0 To 19
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"

        '''Cuando es nuevo no muestra las totales.  Estos salen en 0.00, y es para que no cree confucion con el cliente
        '''en el importe total de la reparación
        '***** TOTALES *****}
        gStrSql = "SELECT     R.ImporteVta, R.Anticipo, R.TipoCambio, ISNULL(SUM(I.Total), 0) AS Abonos " & "FROM         dbo.Reparaciones R LEFT OUTER JOIN " & "dbo.Ingresos I ON I.FolioMovto = R.FolioReparacion AND I.TipoIngreso <> 'A' " & "WHERE     (R.FolioReparacion = '" & Trim(Folio) & "') " & "GROUP BY R.ImporteVta, R.Anticipo, R.TipoCambio "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Format(System.Math.Round(RsGral.Fields("Abonos").Value * TipoCambio, 1), gstrFormatoCantidad) 'Abonos
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Format(System.Math.Round(RsGral.Fields("ImporteVta").Value * RsGral.Fields("TipoCambio").Value, 1), gstrFormatoCantidad) 'Imoprte total
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = Format(System.Math.Round(RsGral.Fields("Anticipo").Value * RsGral.Fields("TipoCambio").Value, 1), gstrFormatoCantidad) 'Anticipo
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            TotalAbonos = (CDec(Numerico(CStr(Valores(2)))) + CDec(Numerico(CStr(Valores(0)))))
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(Valores(1) - TotalAbonos, gstrFormatoCantidad) 'Saldo
        End If

        gStrSql = "SELECT MsgFiscal, MsgNormal , msgCredito FROM dbo.ConfiguracionGralPV Where CodAlmacen = " & gintCodAlmacen
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        If recAux.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(recAux.Fields("MsgNormal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = Trim(recAux.Fields("MsgFiscal").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(recAux.Fields("MsgCredito").Value)
        End If

        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            If lNvo Then
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Select Case UCase(Trim(ConfigReparacion(I, 0)))
                    Case "IMP. REPARACION:", "ANTICIPO:", "ABONOS:", "-------------------------", "SALDO:"
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Totales(I, 0) = ""
                    Case Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Totales(I, 0) = ConfigReparacion(I, 0)
                End Select
            Else
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 0) = ConfigReparacion(I, 0)
            End If
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

            Totales(I, 2) = ConfigReparacion(I, 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

            Totales(I, 3) = ConfigReparacion(I, 3)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 4) = "C"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Trim(ConfigReparacion(I, 1)) <> "" Then
                PALABRA = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Len(Trim(ConfigReparacion(I, 1)) & " ")
                    FinPal = False
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigReparacion(I, 1)), J, 1) <> "*" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        PALABRA = PALABRA & Mid(Trim(ConfigReparacion(I, 1)), J, 1)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "Importe Reparacion"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Not lNvo Then Valor = Valores(1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Normal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(4) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Mensaje Fiscal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(5) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Formas de Pago"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = "FORPAG"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                            Case "Anticipo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Not lNvo Then Valor = Valores(2)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Saldo"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Not lNvo Then Valor = Valores(3)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Abonos"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Not lNvo Then Valor = Valores(0)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Mensaje Crédito"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valores(6) + "  "
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "" Then
                            SIMBOLO = "+"
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "-" Then
                            SIMBOLO = "-"
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigReparacion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        ElseIf Mid(Trim(ConfigReparacion(I, 1)), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
        Next I

        Dim D As Byte
        Dim recDesg As ADODB.Recordset
        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Totales(I, 1) = "FORPAG" Then
                    gStrSql = "SELECT     dbo.CatFormasPago.DescCorta AS DescFormaPago, dbo.CatFormasPago.EsDolar AS EsDolar, SUM(dbo.IngresosFormaDePago.Importe) AS Importe " & "FROM         dbo.CatFormasPago INNER JOIN " & "dbo.IngresosFormaDePago ON dbo.CatFormasPago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago " & "Where (dbo.IngresosFormaDePago.CodFormaPago = dbo.IngresosFormaDePago.CodFormaPago) " & "GROUP BY dbo.CatFormasPago.DescCorta, dbo.IngresosFormaDePago.FolioMovto, dbo.CatFormasPago.EsDolar " & "HAVING      (dbo.IngresosFormaDePago.FolioMovto = '" & Folio & "') "
                    ModEstandar.BorraCmd()
                    Cmd.CommandText = "dbo.Up_Select_Datos"
                    Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
                    Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
                    Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
                    recDesg = Cmd.Execute
                    For D = 1 To recDesg.RecordCount

                        Linea = Space(Totales(I, 2)) & Left(recDesg.Fields("DescFormaPago").Value + Space(16), 16) & Right(Space(10) & Format(recDesg.Fields("importe").Value, "###,###,##0.00"), 10)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        recDesg.MoveNext()
                    Next D
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Detalle(I, 4) = "E" Then
                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
            Else

                If Trim(CStr(Totales(I, 0))) = "" Then
                    Linea = ""
                Else


                    Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), "###,###,##0.00"), 10)
                End If
            End If

            If CDec(Numerico(Trim(CStr(Totales(I, 3))))) > 0 Then

                For J = 1 To Totales(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Totales(I, 1) = "FORPAG" Then Linea = ""
                    If Linea = "      ____________________         ____________________" Then
                        PrintLine(1, "")
                        PrintLine(1, "")
                    End If
                    If Trim(Linea) <> "" Then PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 6
            PrintLine(1, "")
        Next I

        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)

        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        ''x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
        Exit Sub

Errores:
        If Err.Number = 55 Then
            If Err.Number <> 0 Then ModEstandar.MostrarError()
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub TicketNotaCredito(ByRef Folio As String, ByRef FolioAdicional As String, ByRef CodCaja As Integer)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim RENCABEZ As Byte
        Dim RDETALLE As Byte
        Dim RTOTALES As Byte
        Dim x As Object

        Dim Encabez(21, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(21, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(21, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket
        Dim ConfigDevolucion(21, 5) As Object 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
        ' De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.

        Dim Valores(21) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
        Const C_TamañoEncabezado As Integer = 9
        Const C_TamañoDetalle As Integer = 4
        Const C_TamañoTotales As Integer = 6

        '***************************************************************
        ' ** Obtiene Valores para la Fórmula **
        '***** ENCABEZADO *****'
        For I = 0 To 16
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I
        ''Llenar el Vector de Configuración del Tickect

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 2) = 56
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 4) = "C"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 1) = "(Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 1) = "(Dirección Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 0) = "RFC:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 1) = "(RFC)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 0) = "***  SOLICITUD DE NOTA DE CREDITO  ***"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 3) = 3
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 0) = "FECHA: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 1) = "(Fecha)+(Hora)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 0) = "FOLIO: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 1) = "(Folio Devolucion)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 2) = 32
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 0) = "FOLIO VENTA: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 1) = "(Folio Venta)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 0) = "TIPO DE CAMBIO: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 1) = "(Tipo de Cambio)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 2) = 35
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 0) = "CLIENTE: "
        ConfigDevolucion(9, 1) = "(Cliente)"
        ConfigDevolucion(9, 2) = 1
        ConfigDevolucion(9, 3) = 2
        ConfigDevolucion(9, 4) = "E"

        ConfigDevolucion(10, 0) = "CANTIDAD"
        ConfigDevolucion(10, 1) = "(Cantidad)"
        ConfigDevolucion(10, 2) = 1
        ConfigDevolucion(10, 3) = 0
        ConfigDevolucion(10, 4) = "D"
        ConfigDevolucion(11, 0) = "ARTICULO"
        ConfigDevolucion(11, 1) = "(Descripción)"
        ConfigDevolucion(11, 2) = 11
        ConfigDevolucion(11, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 4) = "D"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 0) = "PRECIO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 1) = "(Precio Real)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 2) = 34
        ConfigDevolucion(12, 3) = 0
        ConfigDevolucion(12, 4) = "D"

        ConfigDevolucion(13, 0) = "IMPORTE"
        ConfigDevolucion(13, 1) = "(Importe)"
        ConfigDevolucion(13, 2) = 46
        ConfigDevolucion(13, 3) = 1
        ConfigDevolucion(13, 4) = "D"

        ConfigDevolucion(14, 0) = "TOTAL:"
        ConfigDevolucion(14, 1) = "(Total)"
        ConfigDevolucion(14, 2) = 31
        ConfigDevolucion(14, 3) = 1
        ConfigDevolucion(14, 4) = "T"

        ConfigDevolucion(15, 0) = "TOTAL PESOS:"
        ConfigDevolucion(15, 1) = "(Total Pesos)"
        ConfigDevolucion(15, 2) = 31
        ConfigDevolucion(15, 3) = 3
        ConfigDevolucion(15, 4) = "T"

        ConfigDevolucion(16, 0) = "________________"
        ConfigDevolucion(16, 1) = " "
        ConfigDevolucion(16, 2) = 8
        ConfigDevolucion(16, 3) = 0
        ConfigDevolucion(16, 4) = "T"

        ConfigDevolucion(17, 0) = "________________"
        ConfigDevolucion(17, 1) = " "
        ConfigDevolucion(17, 2) = 32
        ConfigDevolucion(17, 3) = 1
        ConfigDevolucion(17, 4) = "T"

        ConfigDevolucion(18, 0) = "ELABORO"
        ConfigDevolucion(18, 1) = " "
        ConfigDevolucion(18, 2) = 12
        ConfigDevolucion(18, 3) = 0
        ConfigDevolucion(18, 4) = "T"

        ConfigDevolucion(19, 0) = "CLIENTE"
        ConfigDevolucion(19, 1) = " "
        ConfigDevolucion(19, 2) = 36
        ConfigDevolucion(19, 3) = 1
        ConfigDevolucion(19, 4) = "T"


        gStrSql = "SELECT     NombreEmp, DomicilioEmp, RFCEmp " & "From dbo.ConfiguracionGeneral GROUP BY NombreEmp, DomicilioEmp, RFCEmp"

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            Valores(0) = Trim(RsGral.Fields("NombreEmp").Value) 'Nombre Empresa
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DomicilioEmp").Value)) 'Direccion Empresa                                                     'Ciudad Sucursal
            Valores(2) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RFCEmp").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            For I = 0 To 2
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = "SELECT     TipoCambio, FolioDevolucion, FechaDevolucion, FolioVenta, Nombre, Titular, TipoDevol " & "From dbo.DevolucionesCab " & "WHERE     (FolioDevolucion = '" & Folio & "')  and Codcaja= " & CodCaja
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            Valores(3) = Folio 'Folio Devoluvion
            Valores(4) = Format(RsGral.Fields("FechaDevolucion").Value, "DD/MMM/YYYY") 'Fecha
            Valores(5) = FolioAdicional 'Folio de Venta
            Valores(6) = Trim(RsGral.Fields("Titular").Value) 'Nombre de la Persona a quien se le Dará la Nota de Crédito, en este Caso debe ser la misma que realizó la compra
            Valores(7) = Format(RsGral.Fields("TipoCambio").Value, gstrFormatoCantidad)
            Valores(8) = Format(Now, "HH:MM")
        End If

        COLS = ConfigDevolucion(0, 2)
        For I = 1 To C_TamañoEncabezado 'Tamaño del Vector de Configurqcion del Ticket
            If ConfigDevolucion(I, 4) <> "E" Then Exit For
            Encabez(I, 0) = ConfigDevolucion(I, 0)
            Encabez(I, 2) = ConfigDevolucion(I, 2)
            Encabez(I, 3) = ConfigDevolucion(I, 3)
            Encabez(I, 4) = "S"
            If ConfigDevolucion(I, 1) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(ConfigDevolucion(I, 1)))
                    If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" Then
                        PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                        Select Case PALABRA
                            Case "Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "RFC"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Folio Devolucion"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Fecha"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Hora"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Folio Venta"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "Cliente"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Tipo de Cambio"
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
        Next I
Continuar:
        'Impresión de la primera parte del Ticket, Encabezado
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        'Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        'Open "C:\FILETICKET.TXT" For Output As #1
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To C_TamañoEncabezado
            If Encabez(I, 4) = "S" Then
                If CDbl(ConfigDevolucion(I, 2)) = -1 Then
                    Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
                    If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
                End If
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                If Encabez(I, 3) > 0 Then
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT     DD.FolioDevolucion, DD.CodArticulo, A.DescArticuloAdicional, DD.CantidadDevol, Round(DD.PrecioReal,2) as PrecioReal, " & "ROUND(DD.PrecioReal * DD.CantidadDevol, 2) AS ImporteD " & "FROM         dbo.DevolucionesDet DD INNER JOIN " & "(SELECT * FROM dbo.MovimientosVentasDet WHERE FolioAdicional = '" & FolioAdicional & "') A ON DD.CodArticulo = A.CodArticulo INNER JOIN " & "dbo.DevolucionesCab DC ON DD.FolioDevolucion = DC.FolioDevolucion " & "WHERE     (DD.FolioDevolucion = '" & Folio & "') AND (DC.CodCaja =" & CodCaja & ")"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Byte
        SIMBOLO = "+"
        Encabezado = True
        recAux.MoveFirst()
        For H = 1 To recAux.RecordCount
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = recAux.Fields("CodArticulo").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(recAux.Fields("DescArticuloAdicional").Value)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = recAux.Fields("CantidadDevol").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Format(recAux.Fields("PrecioReal").Value, gstrFormatoCantidad) 'pRECIO Real
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(recAux.Fields("ImporteD").Value, gstrFormatoCantidad) 'Importe
            'RsGral.MoveFirst
            '        recAux.MoveFirst
            For I = 0 To 16
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 0) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 1) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 2) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 3) = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle) '30. Tamaño del VEctro de Configuracion
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If ConfigDevolucion(I, 4) = "D" Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 0) = Right(Space(8) & Trim(ConfigDevolucion(I, 0)), 8)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 2) = ConfigDevolucion(I, 2)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 3) = ConfigDevolucion(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Trim(ConfigDevolucion(I, 1)) <> "" Then
                        PALABRA = ""
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                            FinPal = False
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                                FinPal = True
                                Select Case PALABRA
                                    Case "Código"
                                        Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                        Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                        Detalle(I, 4) = "C"
                                    Case "Descripción"
                                        Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                        Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                        Detalle(I, 4) = "C"
                                    Case "Cantidad"
                                        Valor = Valores(2)
                                        Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                    Case "Precio Real"
                                        Valor = Valores(3)
                                        Detalle(I, 4) = Detalle(I, 4) + "D"
                                    Case "Importe"
                                        Valor = Valores(4)
                                        Detalle(I, 4) = "D"
                                End Select
                                PALABRA = ""
                                J = J + 1
                                If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                    '                                Detalle(i, 1) = ""
                                    If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                    If SIMBOLO = "+" Then
                                        Detalle(I, 1) = Detalle(I, 1) + Valor
                                    ElseIf SIMBOLO = "-" Then
                                        Detalle(I, 1) = Detalle(I, 1) - Valor
                                    ElseIf SIMBOLO = "*" Then
                                        Detalle(I, 1) = Detalle(I, 1) * Valor
                                    End If
                                End If
                                If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                                    SIMBOLO = "+"
                                ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                                    SIMBOLO = "-"
                                ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "x" Then
                                    SIMBOLO = "*"
                                End If
                            End If
                        Next J
                    End If
                    '                RsGral.MoveNext
                End If
            Next I
            '*** Encabezado del Detalle
            '        Encabezado = True
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    If Detalle(I, 3) > 0 Then
                        For J = 1 To 1 'Detalle(i, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(8) & Format(Detalle(I, 1), FormatoCantidad), 8)
                Else
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                If Detalle(I, 3) > 0 Then
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()

            System.Array.Clear(Detalle, 0, Detalle.Length)
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT     DD.FolioDevolucion, ROUND(DC.TotalDevol, 2) AS TotalD, ROUND(DC.TotalDevol * DC.TipoCambio, 1) AS TotalP " & "FROM         dbo.DevolucionesDet DD INNER JOIN " & "dbo.DevolucionesCab DC ON DD.FolioDevolucion = DC.FolioDevolucion " & "WHERE     (DD.FolioDevolucion = '" & Folio & "') " & "GROUP BY DD.FolioDevolucion, ROUND(DC.TotalDevol, 2), ROUND(DC.TotalDevol * DC.TipoCambio, 1)"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            Valores(0) = Format(RsGral.Fields("TotalD").Value, gstrFormatoCantidad) 'Total Devolucion Dólares
            Valores(1) = Format(RsGral.Fields("TotalP").Value, gstrFormatoCantidad) 'Total Devolucion Pesos
        End If

        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            Totales(I, 0) = ConfigDevolucion(I, 0)

            Totales(I, 2) = ConfigDevolucion(I, 2)

            Totales(I, 3) = ConfigDevolucion(I, 3)
            Totales(I, 4) = "C"
            If Trim(ConfigDevolucion(I, 1)) <> "" Then
                PALABRA = ""
                For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                    FinPal = False
                    If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                        PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "Total"
                                Valor = Valores(0)
                                Totales(I, 4) = "N"
                            Case "Total Pesos"
                                Valor = Valores(1)
                                Totales(I, 4) = "N"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                            SIMBOLO = "+"
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                            SIMBOLO = "-"
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
        Next I
        'Imprimir 3 Lineas en Blanco, para separar el Total de el Detalle.
        For I = 1 To 3
            Linea = ""
            PrintLine(1, Left(RTrim(Linea), COLS))
        Next
        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Detalle(I, 4) = "E" Then
                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Right(Space(10) & Format(Totales(I, 1), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then

                For J = 1 To Totales(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Totales(I, 1) = "FORPAG" Then Linea = ""
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        'x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)
        'x = Shell("E:\WINNT\NOTEPAD.EXE C:\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing
Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub TicketCorteFinalDia(ByRef FechaCorte As Date, ByRef CodSucursal As Integer, ByRef CodCaja As Integer, ByRef TipoCorte As String, ByRef Reimpresion As Boolean)
        'TipoCorte : Especifica si es un Corte Final del Día (F) o un Corte de Auditoria (A)
        'Reimpresión : Indica si se trata de una Reimpresion, Sólo par COrte Final de Día
        On Error GoTo Errores
        'Fecha: Fecha de Corte
        'Sucursal : Número de Sucursal donde se Hace el COrte
        'Caja  : Número de Caja, que imprime el COrte

        Dim I As Byte
        Dim J As Byte
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim TotalPiezasVendidas As Integer
        Dim TotalPiezasDevueltas As Integer
        Dim TotalDocumentos As Decimal
        Dim TotalVentasD As Decimal
        Dim TotalVentasP As Decimal
        Dim TotalDevolD As Decimal
        Dim TotalDevolP As Decimal
        Dim TotalApartadosD As Decimal
        Dim TotalApartadosP As Decimal
        Dim TotalReparacionesD As Decimal
        Dim TotalReparacionesP As Decimal
        Dim TotalRetirosD As Decimal
        Dim TotalRetirosP As Decimal

        Dim TotalAbonosD As Decimal
        Dim TotalAbonosP As Decimal
        Dim TotalAntciposD As Decimal
        Dim TotalAntciposP As Decimal
        Dim DiferenciaFPSistemaUsuario As Decimal 'Diferencia entre lo que proporciona el sistema y los datos que proporcionó el usuario
        Dim x As Object

        Dim Encabez(10, 5) As Object 'Arreglo que contiene los Datos del Encabezado del corte
        Dim VENTAS(25, 5) As Object 'Arreglo que contiene los Datos de las Ventas
        Dim Devoluciones(52, 5) As Object 'Arreglo que contiene los Datos de las devoluciones
        Dim Apartados(60, 5) As Object 'Arreglo que contiene los Datos de los Apartados
        Dim Reparaciones(79, 5) As Object 'Arreglo que contiene los Datos de las Reparaciones
        Dim Retiros(98, 5) As Object 'Arreglo que contiene los Datos de los Retiros
        Dim Abonos(117, 5) As Object 'Arreglo que contiene los Datos de los Abonos
        Dim Anticipos(129, 5) As Object 'Arreglo que contiene los Datos de los Anticipos
        Dim Totales(129, 5) As Object 'Arreglo que contiene los Datos de los Anticipos

        Dim ConfigCorte(130, 5) As Object 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
        'De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.

        Dim Valores(20) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim TipoCambio As Decimal

        Dim FormatoCantidad As String 'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
        'uno para las columnas
        Const C_TamañoEncabezado As Integer = 10
        Const C_TamañoVentas As Integer = 15
        Const C_TamañoDevoluciones As Integer = 21
        Const C_TamañoApartados As Integer = 7
        Const C_TamañoReparaciones As Integer = 7
        Const C_TamañoRetiros As Integer = 19
        Const C_TamañoAbonos As Integer = 19
        Const C_TamañoAnticipos As Integer = 19
        Const C_TamañoTotales As Integer = 7

        For I = 0 To 20
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I

        ''Llenar el Vector de COnfiguración

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(0, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(0, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(0, 2) = 56
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(0, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(0, 4) = "C"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(1, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(1, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(1, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(1, 1) = "(Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(1, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(1, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(1, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(1, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(1, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(1, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(2, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(2, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(2, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(2, 1) = "(Dirección Empresa)+(Ciudad Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(2, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(2, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(2, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(2, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(2, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(2, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(3, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(3, 0) = "RFC:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(3, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(3, 1) = "(RFC)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(3, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(3, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(3, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(3, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(3, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(3, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(4, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(4, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(4, 1) = "(Sucursal)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(4, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(4, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(4, 4) = "E"

        ' Si es Reimpresióm , Cambia el Encabezado del Ticket'
        ' Al igual que si es Corte Auditoria

        If TipoCorte = "F" Then
            If Reimpresion = True Then
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 0) = "*** REIMPRESION DE CORTE FINAL DE CAJA  ***"
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 1) = " "
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 2) = -1
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 3) = 2
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 4) = "E"
            Else
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 0) = "***  CORTE FINAL DE CAJA  ***"
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 1) = " "
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 2) = -1
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 3) = 2
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ConfigCorte(5, 4) = "E"
            End If
        ElseIf TipoCorte = "A" Then

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(5, 0) = "*** CORTE DE AUDITORIA ***"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(5, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(5, 2) = -1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(5, 3) = 2
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(5, 4) = "E"

        End If

        If TipoCorte = "F" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(6, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(6, 0) = "FECHA: "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(6, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(6, 1) = "(Fecha)+(Hora)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(6, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(6, 2) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(6, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(6, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(6, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(6, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(7, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(7, 0) = "FOLIO: "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(7, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(7, 1) = "(Folio)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(7, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(7, 2) = 28
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(7, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(7, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(7, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(7, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(8, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(8, 0) = "VENDEDOR: "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(8, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(8, 1) = "(Vendedor)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(8, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(8, 2) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(0, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(8, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(8, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(9, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(9, 0) = "CAJA: "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(9, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(9, 1) = "(Caja)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(9, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(9, 2) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(9, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(9, 3) = 2
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(9, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(9, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(10, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(10, 0) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(10, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(10, 1) = "(Linea Separa)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(10, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(10, 2) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(10, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(10, 3) = 2
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(10, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(10, 4) = "E"

        End If

        'Ventas

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(11, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(11, 0) = "VENTAS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(11, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(11, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(11, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(11, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(11, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(11, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(11, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(11, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(12, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(12, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(12, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(12, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(12, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(12, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(12, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(12, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(12, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(12, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(13, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(13, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(13, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(13, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(13, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(13, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(13, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(13, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(13, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(13, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(14, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(14, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(14, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(14, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(14, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(14, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(14, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(14, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(14, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(14, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(15, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(15, 0) = "CONTADO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(15, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(15, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(15, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(15, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(15, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(15, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(15, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(15, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(16, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(16, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(16, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(16, 1) = "(Ventas Contado Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(16, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(16, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(16, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(16, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(16, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(16, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(17, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(17, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(17, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(17, 1) = "(Ventas Contado Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(17, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(17, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(17, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(17, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(17, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(17, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(18, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(18, 0) = "CREDITO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(18, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(18, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(18, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(18, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(18, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(18, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(18, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(18, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(19, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(19, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(19, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(19, 1) = "(Ventas Credito Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(19, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(19, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(19, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(19, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(19, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(19, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(20, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(20, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(20, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(20, 1) = "(Ventas Credito Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(20, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(20, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(20, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(20, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(20, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(20, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(21, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(21, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(21, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(21, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(21, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(21, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(21, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(21, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(21, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(21, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(22, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(22, 0) = "------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(22, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(22, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(22, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(22, 2) = 44
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(22, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(22, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(22, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(22, 4) = "S"

        '    ConfigCorte(22, 0) = "TOTAL":                                                  ConfigCorte(22, 1) = "":                                        ConfigCorte(22, 2) = 15:    ConfigCorte(22, 3) = 0: ConfigCorte(22, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(23, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(23, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(23, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(23, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(23, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(23, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(23, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(23, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(23, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(23, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(24, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(24, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(24, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(24, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(24, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(24, 2) = 40
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(24, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(24, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(24, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(24, 4) = "S"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(25, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(25, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(25, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(25, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(25, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(25, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(25, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(25, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(25, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(25, 4) = "S"

        'Devoluciones

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(26, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(26, 0) = "DEVOLUCIONES"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(26, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(26, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(26, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(26, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(26, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(26, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(26, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(26, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(27, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(27, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(27, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(27, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(27, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(27, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(27, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(27, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(27, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(27, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(28, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(28, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(28, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(28, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(28, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(28, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(28, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(28, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(28, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(28, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(29, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(29, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(29, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(29, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(29, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(29, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(29, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(29, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(29, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(29, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(30, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(30, 0) = "DEVOLUCION"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(30, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(30, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(30, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(30, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(30, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(30, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(30, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(30, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(31, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(31, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(31, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(31, 1) = "(Devol Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(31, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(31, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(31, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(31, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(31, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(31, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(32, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(32, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(32, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(32, 1) = "(Devol Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(32, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(32, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(32, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(32, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(32, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(32, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(33, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(33, 0) = "VALES DEVOLUCION"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(33, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(33, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(33, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(33, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(33, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(33, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(33, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(33, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(34, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(34, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(34, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(34, 1) = "(Vale Devol Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(34, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(34, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(34, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(34, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(34, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(34, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(35, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(35, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(35, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(35, 1) = "(Vale Devol Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(35, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(35, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(35, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(35, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(35, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(35, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(36, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(36, 0) = "NOTAS CRÉDITO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(36, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(36, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(36, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(36, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(36, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(36, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(36, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(36, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(37, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(37, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(37, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(37, 1) = "(Notas Credito Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(37, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(37, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(37, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(37, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(37, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(37, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(38, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(38, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(38, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(38, 1) = "(Notas Credito Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(38, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(38, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(38, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(38, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(38, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(38, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(39, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(39, 0) = "EFECTIVO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(39, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(39, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(39, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(39, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(39, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(39, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(39, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(39, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(40, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(40, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(40, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(40, 1) = "(Devol Efectivo Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(40, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(40, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(40, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(40, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(40, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(40, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(41, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(41, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(41, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(41, 1) = "(Devol Efectivo Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(41, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(41, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(41, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(41, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(41, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(41, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(42, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(42, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(42, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(42, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(42, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(42, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(42, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(42, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(42, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(42, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(43, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(43, 0) = "------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(43, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(43, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(43, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(43, 2) = 46
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(43, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(43, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(43, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(43, 4) = "V"

        '    ConfigCorte(41, 0) = "TOTAL":                                                  ConfigCorte(41, 1) = "":                                        ConfigCorte(41, 2) = 15:    ConfigCorte(41, 3) = 0: ConfigCorte(41, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(44, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(44, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(44, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(44, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(44, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(44, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(44, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(44, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(44, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(44, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(45, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(45, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(45, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(45, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(45, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(45, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(45, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(45, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(45, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(45, 4) = "V"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(46, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(46, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(46, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(46, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(46, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(46, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(46, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(46, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(46, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(46, 4) = "V"

        ''APARTADOS

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(47, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(47, 0) = "APARTADOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(47, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(47, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(47, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(47, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(47, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(47, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(47, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(47, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(48, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(48, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(48, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(48, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(48, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(48, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(48, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(48, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(48, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(48, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(49, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(49, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(49, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(49, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(49, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(49, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(49, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(49, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(49, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(49, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(50, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(50, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(50, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(50, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(50, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(50, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(50, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(50, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(50, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(50, 4) = "A"

        '    ConfigCorte(49, 0) = "TOTAL":                                                  ConfigCorte(49, 1) = "":                                        ConfigCorte(49, 2) = 15:    ConfigCorte(49, 3) = 0: ConfigCorte(49, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(51, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(51, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(51, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(51, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(51, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(51, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(51, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(51, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(51, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(51, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(52, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(52, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(52, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(52, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(52, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(52, 2) = 38
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(52, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(52, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(52, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(52, 4) = "A"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(53, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(53, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(53, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(53, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(53, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(53, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(53, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(53, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(53, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(53, 4) = "A"

        'REPARACIONES

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(54, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(54, 0) = "REPARACIONES"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(54, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(54, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(54, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(54, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(54, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(54, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(54, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(54, 4) = "R"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(55, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(55, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(55, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(55, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(55, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(55, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(55, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(55, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(55, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(55, 4) = "R"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(56, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(56, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(56, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(56, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(56, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(56, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(56, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(56, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(56, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(56, 4) = "R"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(57, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(57, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(57, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(57, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(57, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(57, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(57, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(57, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(57, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(57, 4) = "R"

        '    ConfigCorte(57, 0) = "TOTAL":                                                  ConfigCorte(57, 1) = "":                                        ConfigCorte(57, 2) = 15:    ConfigCorte(57, 3) = 0: ConfigCorte(57, 4) = "R"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(58, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(58, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(58, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(58, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(58, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(58, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(58, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(58, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(58, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(58, 4) = "R"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(59, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(59, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(59, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(59, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(59, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(59, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(59, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(59, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(59, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(59, 4) = "X"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(60, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(60, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(60, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(60, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(60, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(60, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(60, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(60, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(60, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(60, 4) = "R"

        ''RETIROS

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(61, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(61, 0) = "RETIROS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(61, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(61, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(61, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(61, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(61, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(61, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(61, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(61, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(62, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(62, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(62, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(62, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(62, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(62, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(62, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(62, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(62, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(62, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(63, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(63, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(63, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(63, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(63, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(63, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(63, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(63, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(63, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(63, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(64, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(64, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(64, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(64, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(64, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(64, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(64, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(64, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(64, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(64, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(65, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(65, 0) = "TERCEROS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(65, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(65, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(65, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(65, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(65, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(65, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(65, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(65, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(66, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(66, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(66, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(66, 1) = "(Retiro Terceros Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(66, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(66, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(66, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(66, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(66, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(66, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(67, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(67, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(67, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(67, 1) = "(Retiro Terceros Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(67, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(67, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(67, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(67, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(67, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(67, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(68, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(68, 0) = "A DEPOSITOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(68, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(68, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(68, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(68, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(68, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(68, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(68, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(68, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(69, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(69, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(69, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(69, 1) = "(Retiro Deposito Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(69, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(69, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(69, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(69, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(69, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(69, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(70, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(70, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(70, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(70, 1) = "(Retiro Deposito Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(70, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(70, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(70, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(70, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(70, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(70, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(71, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(71, 0) = "A CAJA GRAL."
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(71, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(71, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(71, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(71, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(71, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(71, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(71, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(71, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(72, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(72, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(72, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(72, 1) = "(Retiro Envio Caja Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(72, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(72, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(72, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(72, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(72, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(72, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(73, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(73, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(73, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(73, 1) = "(Retiro Envio Caja Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(73, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(73, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(73, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(73, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(73, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(73, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(74, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(74, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(74, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(74, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(74, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(74, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(74, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(74, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(74, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(74, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(75, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(75, 0) = "------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(75, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(75, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(75, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(75, 2) = 44
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(75, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(75, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(75, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(75, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(76, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(76, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(76, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(76, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(76, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(76, 2) = 15
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(76, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(76, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(76, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(76, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(77, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(77, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(77, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(77, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(77, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(77, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(77, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(77, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(77, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(77, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(78, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(78, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(78, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(78, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(78, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(78, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(78, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(78, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(78, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(78, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(79, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(79, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(79, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(79, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(79, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(79, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(79, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(79, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(79, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(79, 4) = "T"

        ''ABONOS A DOCUMENTOS

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(80, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(80, 0) = "ABONOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(80, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(80, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(80, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(80, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(80, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(80, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(80, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(80, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(81, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(81, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(81, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(81, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(81, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(81, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(81, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(81, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(81, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(81, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(82, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(82, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(82, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(82, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(82, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(82, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(82, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(82, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(82, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(82, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(83, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(83, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(83, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(83, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(83, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(83, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(83, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(83, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(83, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(83, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(84, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(84, 0) = "VENTAS CREDITO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(84, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(84, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(84, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(84, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(84, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(84, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(84, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(84, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(85, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(85, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(85, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(85, 1) = "(Abono Ventas Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(85, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(85, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(85, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(85, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(85, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(85, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(86, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(86, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(86, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(86, 1) = "(Abono Ventas Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(86, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(86, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(86, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(86, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(86, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(86, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(87, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(87, 0) = "REPARACIONES"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(87, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(87, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(87, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(87, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(87, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(87, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(87, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(87, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(88, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(88, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(88, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(88, 1) = "(Abono Reparaciones Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(88, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(88, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(88, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(88, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(88, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(88, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(89, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(89, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(89, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(89, 1) = "(Abono Reparaciones Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(89, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(89, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(89, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(89, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(89, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(89, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(90, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(90, 0) = "APARTADOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(90, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(90, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(90, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(90, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(90, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(90, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(90, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(90, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(91, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(91, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(91, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(91, 1) = "(Abono Apartados Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(91, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(91, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(91, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(91, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(91, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(91, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(92, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(92, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(92, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(92, 1) = "(Abono Apartados Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(92, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(92, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(92, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(92, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(92, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(92, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(93, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(93, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(93, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(93, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(93, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(93, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(93, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(93, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(93, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(93, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(94, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(94, 0) = "------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(94, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(94, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(94, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(94, 2) = 44
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(94, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(94, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(94, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(94, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(95, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(95, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(95, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(95, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(95, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(95, 2) = 15
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(95, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(95, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(95, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(95, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(96, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(96, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(96, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(96, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(96, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(96, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(96, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(96, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(96, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(96, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(97, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(97, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(97, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(97, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(97, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(97, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(97, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(97, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(97, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(97, 4) = "G"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(98, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(98, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(98, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(98, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(98, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(98, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(98, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(98, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(98, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(98, 4) = "G"

        ''ANTICIPOS

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(99, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(99, 0) = "ANTICIPOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(99, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(99, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(99, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(99, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(99, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(99, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(99, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(99, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(100, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(100, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(100, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(100, 1) = "(Total Movimientos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(100, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(100, 2) = 17
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(100, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(100, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(100, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(100, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(101, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(101, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(101, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(101, 1) = "(Folio Inicial)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(101, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(101, 2) = 18
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(101, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(101, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(101, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(101, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(102, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(102, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(102, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(102, 1) = "(Folio Final)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(102, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(102, 2) = 37
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(102, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(102, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(102, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(102, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(103, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(103, 0) = "VENTAS CREDITO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(103, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(103, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(103, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(103, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(103, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(103, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(103, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(103, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(104, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(104, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(104, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(104, 1) = "(Anticipo Ventas Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(104, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(104, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(104, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(104, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(104, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(104, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(105, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(105, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(105, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(105, 1) = "(Anticipo Ventas Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(105, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(105, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(105, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(105, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(105, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(105, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(106, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(106, 0) = "REPARACIONES"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(106, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(106, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(106, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(106, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(106, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(106, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(106, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(106, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(107, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(107, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(107, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(107, 1) = "(Anticipo Reparaciones Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(107, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(107, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(107, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(107, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(107, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(107, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(108, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(108, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(108, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(108, 1) = "(Anticipo Reparaciones Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(108, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(108, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(108, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(108, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(108, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(108, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(109, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(109, 0) = "APARTADOS"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(109, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(109, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(109, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(109, 2) = 5
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(109, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(109, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(109, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(109, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(110, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(110, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(110, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(110, 1) = "(Anticipo Apartados Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(110, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(110, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(110, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(110, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(110, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(110, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(111, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(111, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(111, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(111, 1) = "(Anticipo Apartados Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(111, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(111, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(111, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(111, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(111, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(111, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(112, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(112, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(112, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(112, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(112, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(112, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(112, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(112, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(112, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(112, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(113, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(113, 0) = "------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(113, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(113, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(113, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(113, 2) = 44
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(113, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(113, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(113, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(113, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(114, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(114, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(114, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(114, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(114, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(114, 2) = 15
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(114, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(114, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(114, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(114, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(115, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(115, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(115, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(115, 1) = "(Total Dolar)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(115, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(115, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(115, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(115, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(115, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(115, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(116, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(116, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(116, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(116, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(116, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(116, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(116, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(116, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(116, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(116, 4) = "N"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(117, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(117, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(117, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(117, 1) = "(Total Pesos)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(117, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(117, 2) = 39
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(117, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(117, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(117, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(117, 4) = "N"

        'TOTALES

        If TipoCorte = "F" Then
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(118, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(118, 0) = "PIEZAS VENDIDAS      "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(118, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(118, 1) = "(Piezas Vendidas)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(118, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(118, 2) = 31
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(118, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(118, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(118, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(118, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(119, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(119, 0) = "PIEZAS DEVUELTAS     "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(119, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(119, 1) = "(Piezas Devueltas)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(119, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(119, 2) = 31
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(119, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(119, 3) = 2
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(119, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigCorte(119, 4) = "T"
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(120, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(120, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(120, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(120, 1) = "(Linea Separa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(120, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(120, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(120, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(120, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(120, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(120, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(121, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(121, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(121, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(121, 1) = "(Formas de Pago)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(121, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(121, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(121, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(121, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(121, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(121, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(122, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(122, 0) = "--------------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(122, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(122, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(122, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(122, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(122, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(122, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(122, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(122, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(123, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(123, 0) = "SUPERVISOR"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(123, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(123, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(123, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(123, 2) = 25
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(123, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(123, 3) = 4
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(123, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(123, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(124, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(124, 0) = "** FIN DEL CORTE **"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(124, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(124, 1) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(124, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(124, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(124, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(124, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(124, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigCorte(124, 4) = "T"



        gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp as  NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp as RFCEmpresa, dbo.ConfiguracionGeneral.DomicilioEmp as DirEmpresa , dbo.CatAlmacen.DescAlmacen as NomSucursal, " & "dbo.CatAlmacen.Domicilio as DirSucursal , dbo.ConfiguracionGeneral.TipoCambio  " & "FROM         dbo.ConfiguracionGeneral CROSS JOIN  " & "dbo.CatAlmacen  " & "Where (dbo.CatAlmacen.CodAlmacen = " & CodSucursal & " )"

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            TipoCambio = RsGral.Fields("TipoCambio").Value '''no se utilizara en ninguna operacion del corte
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NomEmpresa").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirEmpresa").Value)) 'Direccion Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = "" 'Ciudad Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Trim(RsGral.Fields("NomSucursal").Value) 'Nombre Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DirSucursal").Value)) 'Dirección Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = "" 'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RfcEmpresa").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            For I = 0 To 6
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        gStrSql = "SELECT     FolioCorte FROM         dbo.CorteZ " & "wHERE FechaCorte ='" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'  and CodSucursal =" & CodSucursal & " and CodCaja= " & CodCaja & " "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = RsGral.Fields("FolioCorte").Value
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(FechaCorte, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(9) = Format(Now, "HH:MM") 'Hora
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(10) = "" 'Vendedor
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(11) = CodCaja 'Caja
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        COLS = ConfigCorte(0, 2)

        For I = 1 To C_TamañoEncabezado
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigCorte(I, 4) <> "E" Then Exit For
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = ConfigCorte(I, 0)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = ConfigCorte(I, 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = ConfigCorte(I, 3)
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigCorte(I, 1) <> "" Then
                PALABRA = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Len(Trim(ConfigCorte(I, 1)))
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                        '                        Encabez(i, 4) = "S"
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Dirección Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Ciudad Sucursal"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Folio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
                            Case "Vendedor"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
                            Case "Caja"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + CStr(Valores(11)) + "  "
                            Case "Linea Separa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 0) = Trim(ConfigCorte(I, 0))
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + New String("-", 60)
                                '                                Encabez(i, 4) = "C"
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
        Next I

Continuar:

        '''Open "C:\SISTEMA\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To C_TamañoEncabezado
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Encabez(I, 4) = "S" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If CDbl(ConfigCorte(I, 2)) = -1 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Encabez(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Si se trata de un Corte de Auditoria, no se Imprime Esta Parte, se va Directamente a los Totales.
        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean
        Dim Encabezado As Boolean
        Dim H As Byte
        Dim lTipoCambio As Decimal 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        If TipoCorte = "F" Then

            ''IMPRESION DE LOS DATOS DE VENTAS

            'Obtener los valores para la formula, para la impresión de los Datos de VEntas

            gStrSql = "SELECT DISTINCT FolioMovto AS FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoCambio, " & "(SELECT     MAX(FolioMovto) " & "FROM          dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ") CorteFinalCaja " & "WHERE      (Movimiento = 'S')) AS FolioFinal, " & "(SELECT     MIN(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'S')) AS FolioInicial " & "FROM          dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE     (Movimiento = 'S') " & "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            If recAux.RecordCount > 0 Then
                Linea = Left(Space(20) & "MOVIMIENTOS DIARIOS" & Space(COLS), COLS)
                PrintLine(1, Left(RTrim(Linea), COLS))
                Linea = Left(Space(20) & New String("-", COLS), COLS)
                PrintLine(1, Left(RTrim(Linea), COLS))
            End If


            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(1) = Trim(recAux.Fields("FolioInicial").Value) 'FolioInicial
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(2) = Trim(recAux.Fields("FolioFinal").Value) 'Folio Final
                    If recAux.Fields("Condicion").Value = "CO" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(5) = Valores(5) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(6) = Valores(5) * recAux.Fields("TipoCambio").Value
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(9) = Valores(9) + recAux.Fields("CantidadArticulos").Value
                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalPiezasVendidas = Valores(9)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Valores(3) + Valores(5)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalVentasD = Valores(7)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Valores(4) + Valores(6)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalVentasP = CDec(Valores(8))

                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(5) = Format(System.Math.Round(Valores(5), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(6) = Format(System.Math.Round(Valores(6), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Format(System.Math.Round(Valores(7), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Format(System.Math.Round(Valores(8), 1), gstrFormatoCantidad)

                'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
                'y se le Asigna el Valor obtenido en la consulta para las ventas
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoVentas) '30. Tamaño del VEctro de Configuracion
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "S" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        VENTAS(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        VENTAS(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        VENTAS(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "C"
                                        Case "Folio Inicial"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = Valores(1)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "F"
                                        Case "Folio Final"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = Valores(2)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "F" 'F = Identifica a los Folios
                                        Case "Ventas Contado Dolar"
                                            '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Ventas(I, 1) = Ventas(I, 1) + Valores(3) + "  "
                                            '''Ventas(I, 4) = "D"
                                        Case "Ventas Contado Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = VENTAS(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "D"
                                        Case "Ventas Credito Dolar"
                                            '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Ventas(I, 1) = Ventas(I, 1) + Valores(5) + "  "
                                            '''Ventas(I, 4) = "D"
                                        Case "Ventas Credito Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = VENTAS(I, 1) + Valores(6) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "D"
                                        Case "Total Dolar"
                                            '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Ventas(I, 1) = Ventas(I, 1) + Valores(7) + "  "
                                            '''Ventas(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 1) = VENTAS(I, 1) + Valores(8) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            VENTAS(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoVentas)
                    'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If VENTAS(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), VENTAS(I, 2)) + VENTAS(I, 0) + CStr(VENTAS(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf VENTAS(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), VENTAS(I, 2)) & Right(Space(19) + VENTAS(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), VENTAS(I, 2)) & Right(Space(19) + VENTAS(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If VENTAS(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object VENTAS(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To VENTAS(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(VENTAS, 0, VENTAS.Length)

                recAux = Nothing
            End If

            ''IMPRESION DE LOS DATOS DE DEVOLUIONES
            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
            '''gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, TotalProceso, CantidadArticulos, Condicion, TipoCambio, " & _
            '"(SELECT     MAX(FolioMovto) " & _
            '"FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
            '"WHERE      (Movimiento = 'V')) AS FolioFinal, " & _
            '"(SELECT     MIN(FolioMovto) " & _
            '"FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
            '"WHERE      (Movimiento = 'v')) AS FolioInicial " & _
            '"FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
            '"WHERE     (Movimiento = 'v') " & _
            '"GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto, TotalProceso, TipoCambio "

            gStrSql = "SELECT DISTINCT TipoMovto, sum(TotalMovto) as TotalMovto, sum((TotalMovto*IsNull(TipoCambio,1))) as TotalMovtoP, sum(TotalProceso) as TotalProceso, sum(TotalProceso*IsNull(TipoCambio,1)) as TotalProcesoP, sum(CantidadArticulos) as CantidadArticulos, Condicion, " & "(SELECT     MAX(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'V')) AS FolioFinal, " & "(SELECT     MIN(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'v')) AS FolioInicial " & "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE     (Movimiento = 'V') " & "GROUP    BY Condicion, TipoMovto "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()

                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(1) = Trim(recAux.Fields("FolioInicial").Value) 'FolioInicial
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(2) = Trim(recAux.Fields("FolioFinal").Value) 'Folio Final

                    If recAux.Fields("TipoMovto").Value = "V" Then 'Vales de Devolucion
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalProceso").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(4) = Valores(4) + CDec(Numerico(recAux.Fields("TotalProcesoP").Value))
                    ElseIf recAux.Fields("TipoMovto").Value = "N" Then  'Notas de Crédito
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(5) = Valores(5) + CDec(Numerico(recAux.Fields("TotalProceso").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(6) = Valores(6) + CDec(Numerico(recAux.Fields("TotalProcesoP").Value))
                    ElseIf recAux.Fields("TipoMovto").Value = "E" Then  'then Devolución de Efectivo
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(7) = Valores(7) + CDec(Numerico(recAux.Fields("TotalProceso").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(8) = Valores(8) + CDec(Numerico(recAux.Fields("TotalProcesoP").Value))
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(12) = Valores(12) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(13) = Valores(13) + CDec(Numerico(recAux.Fields("TotalMovtoP").Value))
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(11) = Valores(11) + recAux.Fields("CantidadArticulos").Value
                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(11). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalPiezasDevueltas = Valores(11)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Valores(3) + Valores(5) + Valores(7) + Valores(12)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalDevolD = Valores(9)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Valores(4) + Valores(6) + Valores(8) + Valores(13)

                If IsDBNull(Valores(10)) Then
                    TotalDevolP = 0
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    TotalDevolP = CDec(Valores(10))
                End If

                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(5) = Format(System.Math.Round(Valores(5), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(6) = Format(System.Math.Round(Valores(6), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Format(System.Math.Round(Valores(7), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Format(System.Math.Round(Valores(8), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Format(System.Math.Round(Valores(9), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Format(System.Math.Round(Valores(10), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(12). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(12) = Format(System.Math.Round(Valores(12), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(13) = Format(System.Math.Round(Valores(13), 1), gstrFormatoCantidad)

                'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
                'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
                For I = (C_TamañoEncabezado + C_TamañoVentas + 1) To (C_TamañoEncabezado + C_TamañoDevoluciones + C_TamañoDevoluciones) - 1
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "V" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Devoluciones(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Devoluciones(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Devoluciones(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "C"
                                        Case "Folio Inicial"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Valores(1)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "F"
                                        Case "Folio Final"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Valores(2)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "F" 'F = Identifica a los Folios
                                        Case "Vale Devol Dolar"
                                            '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(3) + "  "
                                            '''Devoluciones(I, 4) = "D"
                                        Case "Vale Devol Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "D"
                                        Case "Notas Credito Dolar"
                                            '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(5) + "  "
                                            '''Devoluciones(I, 4) = "D"
                                        Case "Notas Credito Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(6) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "D"
                                        Case "Devol Efectivo Dolar"
                                            '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(7) + "  "
                                            '''Devoluciones(I, 4) = "D"
                                        Case "Devol Efectivo Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(8) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "D"
                                        Case "Total Dolar"
                                            '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(9) + "  "
                                            '''Devoluciones(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(10) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "D"
                                        Case "Devol Dolar"
                                            '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(12) + "  "
                                            '''Devoluciones(I, 4) = "D"
                                        Case "Devol Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(13). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(13) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Devoluciones(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Devoluciones(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Devoluciones(I, 2)) + Devoluciones(I, 0) + CStr(Devoluciones(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Devoluciones(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Devoluciones(I, 2)) & Right(Space(19) + Devoluciones(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Devoluciones(I, 2)) & Right(Space(19) + Devoluciones(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Devoluciones(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Devoluciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Devoluciones(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Devoluciones, 0, Devoluciones.Length)

                recAux = Nothing
            End If

            ''IMPRESION DE LOS DATOS DE APARTADOS

            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones

            gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, TipoCambio, " & "(SELECT     MAX(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'A')) AS FolioFinal, " & "(SELECT     MIN(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'A')) AS FolioInicial " & "FROM          dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE     (Movimiento = 'A') " & "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(1) = Trim(recAux.Fields("FolioInicial").Value) 'FolioInicial
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(2) = Trim(recAux.Fields("FolioFinal").Value) 'Folio Final                           'Vales de Devolucion
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalApartadosD = Valores(3)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalApartadosP = Valores(4)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "A" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Apartados(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Apartados(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Apartados(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 4) = "C"
                                        Case "Folio Inicial"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 1) = Valores(1)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 4) = "F"
                                        Case "Folio Final"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 1) = Valores(2)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 4) = "F" 'F = Identifica a los Folios
                                        Case "Total Dolar"
                                            '''Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Apartados(I, 1) = Apartados(I, 1) + Valores(3) + "  "
                                            '''Apartados(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 1) = Apartados(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Apartados(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Apartados(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Apartados(I, 2)) + Apartados(I, 0) + CStr(Apartados(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Apartados(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Apartados(I, 2)) & Right(Space(19) + Apartados(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Apartados(I, 2)) & Right(Space(19) + Apartados(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Apartados(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Apartados(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Apartados(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Apartados, 0, Apartados.Length)

                recAux = Nothing
            End If

            ''IMPRESION DE LOS DATOS DE REPARACIONES

            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones

            gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, TipoCambio, " & "(SELECT     MAX(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'R')) AS FolioFinal, " & "(SELECT     MIN(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'R')) AS FolioInicial " & "FROM          dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE     (Movimiento = 'R') " & "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute


            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(1) = Trim(recAux.Fields("FolioInicial").Value) 'FolioInicial
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(2) = Trim(recAux.Fields("FolioFinal").Value) 'Folio Final                           'Vales de Devolucion
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    '''Valores(4) = Valores(3) * TipoCambio
                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalReparacionesD = Valores(3)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalReparacionesP = Valores(4)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoReparaciones + C_TamañoApartados)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "R" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Reparaciones(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Reparaciones(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Reparaciones(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 4) = "C"
                                        Case "Folio Inicial"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 1) = Valores(1)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 4) = "F"
                                        Case "Folio Final"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 1) = Valores(2)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 4) = "F" 'F = Identifica a los Folios
                                        Case "Total Dolar"
                                            '''Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Reparaciones(I, 1) = Reparaciones(I, 1) + Valores(3) + "  "
                                            '''Reparaciones(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 1) = Reparaciones(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Reparaciones(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoReparaciones + C_TamañoApartados)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Reparaciones(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Reparaciones(I, 2)) + Reparaciones(I, 0) + CStr(Reparaciones(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Reparaciones(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Reparaciones(I, 2)) & Right(Space(19) + Reparaciones(I, 1), 19)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Reparaciones(I, 4) = "F" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Reparaciones(I, 2)) & Right(Space(19) + Reparaciones(I, 1), 19)
                    Else
                        Linea = Linea
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Reparaciones(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Reparaciones(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Reparaciones(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Reparaciones, 0, Reparaciones.Length)

                recAux = Nothing
            End If

            'IMPRESION DE LOS DATOS DE RETIROS

            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones

            gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, TipoCambio, " & "(SELECT     MAX(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'T')) AS FolioFinal, " & "(SELECT     MIN(FolioMovto) " & "FROM           dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE      (Movimiento = 'T')) AS FolioInicial " & "FROM          dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & "WHERE     (Movimiento = 'T') " & "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(1) = Trim(recAux.Fields("FolioInicial").Value) 'FolioInicial
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(2) = Trim(recAux.Fields("FolioFinal").Value) 'Folio Final
                    If recAux.Fields("TipoMovto").Value = "T" Then 'Vales de Devolucion
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    ElseIf recAux.Fields("TipoMovto").Value = "D" Then  'Notas de Crédito
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(5) = Valores(5) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(6) = Valores(5) * recAux.Fields("TipoCambio").Value
                    Else 'Devolución de Efectivo
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(7) = Valores(7) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(8) = Valores(7) * recAux.Fields("TipoCambio").Value
                    End If

                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Valores(3) + Valores(5) + Valores(7)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalRetirosD = Valores(9)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Valores(4) + Valores(6) + Valores(8)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalRetirosP = Valores(10)

                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(5) = Format(System.Math.Round(Valores(5), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(6) = Format(System.Math.Round(Valores(6), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Format(System.Math.Round(Valores(7), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Format(System.Math.Round(Valores(8), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Format(System.Math.Round(Valores(9), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Format(System.Math.Round(Valores(10), 1), gstrFormatoCantidad)

                'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
                'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "T" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Retiros(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Retiros(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Retiros(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "C"
                                        Case "Folio Inicial"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Valores(1)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "F"
                                        Case "Folio Final"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Valores(2)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "F" 'F = Identifica a los Folios
                                        Case "Retiro Terceros Dolar"
                                            '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Retiros(I, 1) = Retiros(I, 1) + Valores(3) + "  "
                                            '''Retiros(I, 4) = "D"
                                        Case "Retiro Terceros Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Retiros(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "D"
                                        Case "Retiro Deposito Dolar"
                                            '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Retiros(I, 1) = Retiros(I, 1) + Valores(5) + "  "
                                            '''Retiros(I, 4) = "D"
                                        Case "Retiro Deposito Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Retiros(I, 1) + Valores(6) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "D"
                                        Case "Retiro Envio Caja Dolar"
                                            '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Retiros(I, 1) = Retiros(I, 1) + Valores(7) + "  "
                                            '''Retiros(I, 4) = "D"
                                        Case "Retiro Envio Caja Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Retiros(I, 1) + Valores(8) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "D"
                                        Case "Total Dolar"
                                            '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Retiros(I, 1) = Retiros(I, 1) + Valores(9) + "  "
                                            '''Retiros(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 1) = Retiros(I, 1) + Valores(10) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Retiros(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Retiros(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Retiros(I, 2)) + Retiros(I, 0) + CStr(Retiros(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Retiros(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Retiros(I, 2)) & Right(Space(19) + Retiros(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Retiros(I, 2)) & Right(Space(19) + Retiros(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Retiros(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Retiros(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Retiros(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Retiros, 0, Retiros.Length)

                recAux = Nothing
            End If
            ''IMPRESION DE LOS DATOS DE ABONOS A DOCUMENTOS

            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones

            gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, TotalProceso, TipoCambio " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & " , " & CodCaja & " ) CorteFinalCaja " & "WHERE     (Movimiento = 'G') " & "GROUP BY FolioMovto, TotalMovto, TipoMovto, TotalProceso, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute


            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    If recAux.Fields("TipoMovto").Value = "V" Then 'Ventas de Crédito
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    ElseIf recAux.Fields("TipoMovto").Value = "A" Then  'Apartados
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(5) = Valores(5) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(6) = Valores(5) * recAux.Fields("TipoCambio").Value
                    Else 'Reparaciones
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(7) = Valores(7) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(8) = Valores(7) * recAux.Fields("TipoCambio").Value
                    End If

                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Valores(3) + Valores(5) + Valores(7) 'Total Dolares
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalAbonosD = Valores(9)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Valores(4) + Valores(6) + Valores(8) 'Total Pesos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalAbonosP = Valores(10)

                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(5) = Format(System.Math.Round(Valores(5), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(6) = Format(System.Math.Round(Valores(6), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Format(System.Math.Round(Valores(7), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Format(System.Math.Round(Valores(8), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Format(System.Math.Round(Valores(9), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Format(System.Math.Round(Valores(10), 1), gstrFormatoCantidad)

                'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
                'y se le Asigna el Valor obtenido en la consulta para los Abonos
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + C_TamañoAbonos)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "G" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Abonos(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Abonos(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Abonos(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 4) = "C"
                                        Case "Abono Ventas Dolar"
                                            '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Abonos(I, 1) = Abonos(I, 1) + Valores(3) + "  "
                                            '''Abonos(I, 4) = "D"
                                        Case "Abono Ventas Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 1) = Abonos(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 4) = "D"
                                        Case "Abono Reparaciones Dolar"
                                            '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Abonos(I, 1) = Abonos(I, 1) + Valores(7) + "  "
                                            '''Abonos(I, 4) = "D"
                                        Case "Abono Reparaciones Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 1) = Abonos(I, 1) + Valores(8) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 4) = "D"
                                        Case "Abono Apartados Dolar"
                                            '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Abonos(I, 1) = Abonos(I, 1) + Valores(5) + "  "
                                            '''Abonos(I, 4) = "D"
                                        Case "Abono Apartados Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 1) = Abonos(I, 1) + Valores(6) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 4) = "D"
                                        Case "Total Dolar"
                                            '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Abonos(I, 1) = Abonos(I, 1) + Valores(9) + "  "
                                            '''Abonos(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 1) = Abonos(I, 1) + Valores(10) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Abonos(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + C_TamañoAbonos)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Abonos(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Abonos(I, 2)) + Abonos(I, 0) + CStr(Abonos(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Abonos(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Abonos(I, 2)) & Right(Space(19) + Abonos(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Abonos(I, 2)) & Right(Space(19) + Abonos(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Abonos(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Abonos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Abonos(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Abonos, 0, Abonos.Length)
            End If

            ''IMPRESION DE LOS DATOS DE ANTICIPOS

            'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones

            gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, TipoCambio " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & " , " & CodCaja & " ) CorteFinalCaja " & "WHERE     (Movimiento = 'N') " & "GROUP BY FolioMovto, TotalMovto, TipoMovto, TipoCambio "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            recAux = Cmd.Execute

            For I = 0 To 20
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = 0
            Next
            If recAux.RecordCount > 0 Then
                recAux.MoveFirst()
                For H = 1 To recAux.RecordCount
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Valores(0) = CShort(Valores(0)) + 1 'Total de Movimientos
                    If recAux.Fields("TipoMovto").Value = "V" Then 'Ventas de Crédito
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(3) = Valores(3) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(4) = Valores(3) * recAux.Fields("TipoCambio").Value
                    ElseIf recAux.Fields("TipoMovto").Value = "A" Then  'Apartados
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(5) = Valores(5) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(6) = Valores(5) * recAux.Fields("TipoCambio").Value
                    Else 'Reparaciones
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(7) = Valores(7) + CDec(Numerico(recAux.Fields("TotalMovto").Value))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Valores(8) = Valores(7) * recAux.Fields("TipoCambio").Value
                    End If

                    recAux.MoveNext()
                Next H
                'Redondear los Importe y Formatearlos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Valores(3) + Valores(5) + Valores(7) 'Total Dolares
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalAntciposD = Valores(9)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Valores(4) + Valores(6) + Valores(8) 'Total Pesos
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                TotalAntciposP = Valores(10)

                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(3) = Format(System.Math.Round(Valores(3), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(4) = Format(System.Math.Round(Valores(4), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(5) = Format(System.Math.Round(Valores(5), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(6) = Format(System.Math.Round(Valores(6), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(7) = Format(System.Math.Round(Valores(7), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(8) = Format(System.Math.Round(Valores(8), 1), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(9). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(9) = Format(System.Math.Round(Valores(9), 2), gstrFormatoCantidad)
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(10) = Format(System.Math.Round(Valores(10), 1), gstrFormatoCantidad)

                'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
                'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If ConfigCorte(I, 4) = "N" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Anticipos(I, 2) = ConfigCorte(I, 2)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Anticipos(I, 3) = ConfigCorte(I, 3)
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Anticipos(I, 4) = "C"
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Trim(ConfigCorte(I, 1)) <> "" Then
                            PALABRA = ""
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                                FinPal = False
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                                    FinPal = True
                                    Select Case PALABRA
                                        Case "Total Movimientos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 1) = Valores(0)
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 4) = "C"
                                        Case "Anticipo Ventas Dolar"
                                            '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(3) + "  "
                                            '''Anticipos(I, 4) = "D"
                                        Case "Anticipo Ventas Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 1) = Anticipos(I, 1) + Valores(4) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 4) = "D"
                                        Case "Anticipo Reparaciones Dolar"
                                            '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(7) + "  "
                                            '''Anticipos(I, 4) = "D"
                                        Case "Anticipo Reparaciones Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 1) = Anticipos(I, 1) + Valores(8) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 4) = "D"
                                        Case "Anticipo Apartados Dolar"
                                            '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(5) + "  "
                                            '''Anticipos(I, 4) = "D"
                                        Case "Anticipo Apartados Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 1) = Anticipos(I, 1) + Valores(6) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 4) = "D"
                                        Case "Total Dolar"
                                            '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(9) + "  "
                                            '''Anticipos(I, 4) = "D"
                                        Case "Total Pesos"
                                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(10). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 1) = Anticipos(I, 1) + Valores(10) + "  "
                                            'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                            Anticipos(I, 4) = "D"
                                    End Select
                                    PALABRA = ""
                                    J = J + 1
                                End If
                            Next J
                        End If
                    End If
                Next I
                For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Anticipos(I, 4) = "C" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Anticipos(I, 2)) + Anticipos(I, 0) + CStr(Anticipos(I, 1))
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Anticipos(I, 4) = "D" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Anticipos(I, 2)) & Right(Space(19) + Anticipos(I, 1), 19)
                    Else
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        Linea = Left(Linea & Space(COLS), Anticipos(I, 2)) & Right(Space(19) + Anticipos(I, 1), 19)
                    End If

                    'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Anticipos(I, 3) > 0 Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object Anticipos(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Anticipos(I, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I

                System.Array.Clear(Anticipos, 0, Anticipos.Length)
            End If
        End If

        'Esta Parte de Totales, siempre se Imprime, para los Dos Tipo de COrte
        ''IMPRESION DE LOS TOTALES
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(0) = TotalVentasD - TotalDevolD + TotalApartadosD + TotalReparacionesD - TotalRetirosD + TotalAbonosD + TotalAntciposD
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(1) = TotalVentasP
        '''Valores(1) = Valores(0) * TipoCambio
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(0) = Format(System.Math.Round(Valores(0), 2), gstrFormatoCantidad)
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(1) = Format(System.Math.Round(Valores(1), 1), gstrFormatoCantidad)
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(2) = TotalPiezasVendidas
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(3) = TotalPiezasDevueltas
        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        Valores(4) = "" 'para las formas de Pago
        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
        'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoTotales + C_TamañoAnticipos)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigCorte(I, 4) = "T" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 0) = Trim(ConfigCorte(I, 0))
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Totales(I, 2) = ConfigCorte(I, 2)
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Totales(I, 3) = ConfigCorte(I, 3)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Totales(I, 4) = "C"
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Trim(ConfigCorte(I, 1)) <> "" Then
                    PALABRA = ""
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) & " ")
                        FinPal = False
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            PALABRA = PALABRA & Mid(Trim(ConfigCorte(I, 1)), J, 1)
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
                            FinPal = True
                            Select Case PALABRA
                                Case "Total Dia Pesos"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(1) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "D"
                                Case "Total Dia Dolar"
                                    '''Totales(I, 0) = Trim(ConfigCorte(I, 0))
                                    '''Totales(I, 1) = Totales(I, 1) + Valores(0) + "  "
                                    '''Totales(I, 4) = "D"
                                Case "Piezas Vendidas"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + "   " + CStr(Valores(2)) + "   "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "P" 'IDENTIFICA LAS PIEZAS (vENDIDAS O DEVUELTAS)
                                Case "Piezas Devueltas"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + "   " + CStr(Valores(3)) + "  "
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "P" 'IDENTIFICA LAS PIEZAS (vENDIDAS O DEVUELTAS)
                                Case "Linea Separa"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + New String("-", 60)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "C"
                                Case "Formas de Pago"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + Valores(4)
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "FORMASPAGO"
                                Case "Total Documentos"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigCorte(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 0) = Trim(ConfigCorte(I, 0))

                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 1) = Totales(I, 1) + TotalDocumentos
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    Totales(I, 4) = "D"
                            End Select
                            PALABRA = ""
                            J = J + 1
                        End If
                    Next J
                End If
            End If
        Next I
        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoTotales + C_TamañoAnticipos)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "FORMASPAGO" Then
                mcurImporteCambioDolarP = 0
                ImprimirFP(FechaCorte, CodSucursal, CodCaja, TipoCorte, Reimpresion, CDec(TipoCambio), COLS)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "C" Then

                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + CStr(Totales(I, 1))
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Totales(I, 4) = "D" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Right(Space(19) + Totales(I, 1), 19)
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf (Totales(I, 4) = "P" And TipoCorte = "F") Then


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(16), 16) & Space(5) & Right(Space(4) & Trim(CStr(Totales(I, 1))), 4)
            Else
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Right(Space(19) + Totales(I, 1), 19)
            End If

            If Totales(I, 3) > 0 Then

                For J = 1 To Totales(I, 3)
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        System.Array.Clear(Totales, 0, Totales.Length)

        For I = 1 To 5
            PrintLine(1, "")
        Next I
        '''Cortar Papel
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        '''OJO
        '''x = Shell("C:\WINNT\NOTEPAD.EXE C:\SISTEMA\FILETICKET.TXT", vbNormalFocus)

Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub

    Sub ImprimirFP(ByRef FechaCorte As Date, ByRef CodSucursal As Integer, ByRef CodCaja As Integer, ByRef TipoCorte As String, ByRef Reimpresion As Boolean, ByRef TipoCambio As Decimal, ByRef COLS As Byte)
        On Error GoTo Merr
        'Imprimir el Contenido de las Formas de PAgo.
        Dim FPIngresosD As Decimal
        Dim FPIngresosP As Decimal
        Dim FPDevolucionesEfectivo As Decimal
        Dim FPDevolucionesDolar As Decimal
        Dim FPREtirosD As Decimal
        Dim FPREtirosP As Decimal
        Dim TotalSistema As Decimal
        Dim TotalCajero As Decimal
        Dim TotalDif As Decimal
        Dim SubTotalSistema As Decimal
        Dim SubTotalCajero As Decimal
        Dim SubTotalDif As Decimal

        Dim D As Byte
        Dim rsFP As ADODB.Recordset
        Dim ImporteFPUsuario As Decimal 'Importe de la Forma de Pago ACtual, Proporcionado por el usuario-.
        Dim RsAux As ADODB.Recordset
        Dim CodFP As Integer
        Dim DescFP As String
        Dim EsDolar As Boolean
        Dim Escheque As Boolean
        Dim EsDevolucion As Boolean
        Dim EsTarjeta As Boolean
        Dim EsDocumentoIntreno As Boolean
        Dim EncabezadoEfectivo As Boolean 'Indica si ya se ha impreso el encabezado del TOtal de Efectivo
        Dim PosInicioDolar As Integer
        Dim PosInicioSistema As Integer
        Dim PosInicioCajero As Integer
        Dim PosInicioDif As Integer
        Dim FPCambiosEfectivo As Decimal
        Dim FPCambiosDolar As Decimal
        Dim Linea As String

        PosInicioDolar = 11
        PosInicioSistema = 22
        PosInicioCajero = 33
        PosInicioDif = 44
        mcurImporteCambioDolarP = 0

        gStrSql = "SELECT     CodFormaPago, DescFormaPago, EsDolar, EsCheque, EsDevolucion, EsDocumentoInterno, EsTarjeta " & "From dbo.CatFormasPago (Nolock) "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        rsFP = Cmd.Execute

        If rsFP.RecordCount > 0 Then
            Linea = Left(Space(20) & "FORMAS DE PAGO" & Space(COLS), COLS)
            PrintLine(1, Left(RTrim(Linea), COLS))
            Linea = Left(Space(20) & New String("-", COLS), COLS)
            PrintLine(1, Left(RTrim(Linea), COLS))
        End If

        PrintLine(1, "     DOCTOS              LOGICO       FISICO       DIF")
        PrintLine(1, "")
        '''FPCambiosEfectivo = Round(ImporteCambioEfectivo(FechaCorte, CodSucursal, CodCaja) * TipoCambio, 1)
        mcurImporteCambioDolarP = 0
        FPCambiosEfectivo = System.Math.Round(ImporteCambioEfectivo(FechaCorte, CodSucursal, CodCaja), 1)

        FPCambiosDolar = System.Math.Round(ImporteCambioDolar(FechaCorte, CodSucursal, CodCaja), 2)

        While Not rsFP.EOF
            CodFP = rsFP.Fields("CodFormaPago").Value
            DescFP = rsFP.Fields("DescFormaPago").Value
            EsDolar = rsFP.Fields("EsDolar").Value
            Escheque = rsFP.Fields("Escheque").Value
            EsDevolucion = rsFP.Fields("EsDevolucion").Value
            EsDocumentoIntreno = rsFP.Fields("EsDocumentoInterno").Value
            EsTarjeta = rsFP.Fields("EsTarjeta").Value

            '''se agrego el total del proceso en pesos, por los diversos tipos de cambio
            gStrSql = "SELECT     CodFormaPago, DescFormaPago, SUM(ImporteFP) AS ImporteFP, sum(ImporteFP*TipoCambio) AS ImporteFPP, EsDolar, TipoProceso, " & "isnull((SELECT      SUM(TotalProceso) As TotalProceso " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivo, " & "isnull((SELECT      SUM(TotalProceso*TipoCambio) As TotalProcesoP " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivoP, " & "isnull((SELECT      SUM(TotalProceso) " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolar, " & "isnull((SELECT      SUM(TotalProceso*TipoCambio) as TotalProcesoP " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolarP " & "FROM dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & ") CorteFinalCaja " & "WHERE     (TipoProceso = 'I') AND (CodFormaPago = " & CodFP & ") " & "GROUP BY CodFormaPago, DescFormaPago, EsDolar, TipoProceso "

            gStrSql = gStrSql & "  UNION " & "SELECT     ISNULL(CodFormaPago, 0) AS CodFormaPago, ISNULL(DescFormaPago, '') AS DescFormaPago, SUM(ISNULL(ImporteFP, 0)) AS ImporteFP, sum(IsNull(ImporteFP*TipoCambio,0)) AS ImporteFPP, " & "ISNULL(EsDolar, 0) AS EsDolar, TipoProceso, " & "isnull((SELECT      SUM(TotalProceso) as TotalProceso " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivo, " & "isnull((SELECT SUM(TotalProceso*TipoCambio) as TotalProcesoP " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivoP, " & "isnull((SELECT      SUM(TotalProceso) as TotalProceso " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolar, " & "isnull((SELECT      SUM(TotalProceso*TipoCambio) as TotalProcesoP " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolarP " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & ") CF " & "WHERE     (TipoProceso = 'E') AND (CodFormaPago= " & CodFP & ") " & "GROUP BY CodFormaPago, DescFormaPago, EsDolar, TipoProceso "

            ModEstandar.BorraCmd()
            Cmd.CommandText = "dbo.Up_Select_Datos"
            Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
            Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
            Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
            RsAux = Cmd.Execute

            'Con este Función se Obtiene el Importe que el usuario Proporcionó (como importe Fisico) para la Forma de
            If TipoCorte = "F" And Reimpresion = False Then
                '''ImporteFPUsuario = frmCorteFinalDia.ObtnerImporteUsuarioFP(CodFP)
            ElseIf TipoCorte = "A" Then
                '''ImporteFPUsuario = frmCorteAuditoria.ObtnerImporteUsuarioFP(CodFP)
            End If
            If EsDolar = True Then
                '''este queda al tipo de cambio del dia
                '''antonella - 07/MAY/2004
                ImporteFPUsuario = ImporteFPUsuario * TipoCambio
                ImporteFPUsuario = CDec(Format(System.Math.Round(ImporteFPUsuario, 1), gstrFormatoCantidad))
            End If
            'Clasificar el Importe en Ingresos y Egresos o Retiros
            While Not RsAux.EOF
                '''ojo
                FPDevolucionesEfectivo = CDec(Format(System.Math.Round(RsAux.Fields("DevolEfectivoP").Value, 1), gstrFormatoCantidad))
                '''FPDevolucionesDolar = RsAux!Devoldolar
                FPDevolucionesDolar = RsAux.Fields("DevoldolarP").Value

                If RsAux.Fields("TipoProceso").Value = "I" Then
                    If EsDolar Then
                        FPIngresosD = RsAux.Fields("ImporteFP").Value
                        FPIngresosP = CDec(Format(RsAux.Fields("ImporteFPP").Value, gstrFormatoCantidad))
                    Else
                        FPIngresosD = RsAux.Fields("ImporteFP").Value
                        FPIngresosP = CDec(Format(RsAux.Fields("ImporteFP").Value, gstrFormatoCantidad))
                    End If

                    FPIngresosD = CDec(Format(System.Math.Round(FPIngresosD, 2), gstrFormatoCantidad))
                    FPIngresosP = CDec(Format(System.Math.Round(FPIngresosP, 1), gstrFormatoCantidad))
                ElseIf RsAux.Fields("TipoProceso").Value = "E" Then
                    '''FPREtirosD = RsAux!ImporteFP
                    If EsDolar = True Then
                        FPREtirosD = RsAux.Fields("ImporteFP").Value
                        FPREtirosP = RsAux.Fields("ImporteFPP").Value
                        '''FPREtirosP = FPREtirosD * TipoCambio
                    Else
                        FPREtirosD = RsAux.Fields("ImporteFP").Value
                        FPREtirosP = FPREtirosD
                    End If
                    FPREtirosD = CDec(Format(System.Math.Round(FPREtirosD, 2), gstrFormatoCantidad))
                    FPREtirosP = CDec(Format(System.Math.Round(FPREtirosP, 1), gstrFormatoCantidad))
                End If
                RsAux.MoveNext()
            End While

            If FPIngresosD > 0 Or FPREtirosD > 0 Or ImporteFPUsuario > 0 Then
                If EsDolar = False And Escheque = False And EsDevolucion = False And EsDocumentoIntreno = False And EsTarjeta = False Then
                    'Se trata de Efectivo
                    SubTotalSistema = FPIngresosP - FPREtirosP - FPCambiosEfectivo - FPDevolucionesEfectivo
                    SubTotalCajero = ImporteFPUsuario
                    'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
                    'Por Tanto, el Importe de Diferencia debe ser 0 También
                    If Reimpresion = True Then
                        SubTotalDif = 0
                    Else
                        SubTotalDif = SubTotalCajero - SubTotalSistema
                    End If
                    TotalSistema = TotalSistema + SubTotalSistema
                    TotalCajero = TotalCajero + SubTotalCajero
                    TotalDif = TotalDif + SubTotalDif

                    PrintLine(1, " " & CStr(CodFP) & ") " & UCase(DescFP))
                    PrintLine(1, "")
                    PrintLine(1, " " & Left("(+)Ingresos" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left("(-)Retiros" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left("(-)Devoluciones" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPDevolucionesEfectivo, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left("(-)Cambios" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPCambiosEfectivo, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & New String("-", 10) & Space(COLS), PosInicioCajero) & New String("-", 10) & Space(COLS), PosInicioDif) & New String("-", 11))
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & Right(Space(10) & Format(SubTotalSistema, gstrFormatoCantidad), 10) & Space(COLS), PosInicioCajero) & Right(Space(10) & Format(SubTotalCajero, gstrFormatoCantidad), 10) & Space(COLS), PosInicioDif) & Right(Space(11) & Format(SubTotalDif, gstrFormatoCantidad), 11))
                    PrintLine(1, " ")

                ElseIf EsDolar = True And Escheque = False And EsDevolucion = False And EsDocumentoIntreno = False And EsTarjeta = False Then
                    'Se trata de Forma PAgo Dólar
                    SubTotalSistema = FPIngresosP - FPREtirosP - System.Math.Round(FPDevolucionesDolar, 1) - System.Math.Round(mcurImporteCambioDolarP, 2)
                    '''SubTotalSistema = FPIngresosP - FPREtirosP - Round(FPDevolucionesDolar * RsAux!TipoCambio, 1) - Round(FPCambiosDolar * RsAux!TipoCambio, 2)
                    '''SubTotalSistema = FPIngresosP - FPREtirosP - Round(FPDevolucionesDolar * TipoCambio, 1) - Round(FPCambiosDolar * TipoCambio, 2)
                    SubTotalCajero = ImporteFPUsuario
                    'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
                    'Por Tanto, el Importe de Diferencia debe ser 0 También
                    If Reimpresion = True Then
                        SubTotalDif = 0
                    Else
                        SubTotalDif = SubTotalCajero - SubTotalSistema
                    End If
                    TotalSistema = TotalSistema + SubTotalSistema
                    TotalCajero = TotalCajero + SubTotalCajero
                    TotalDif = TotalDif + SubTotalDif
                    PrintLine(1, " " & CStr(CodFP) & ") " & UCase(DescFP))
                    PrintLine(1, "")

                    PrintLine(1, " " & Left(Left("(+)Ingresos" & Space(COLS), PosInicioDolar) & Right(Space(10) & Format(System.Math.Round(FPIngresosD, 2), gstrFormatoCantidad), 10) & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left(Left("(-)Egresos" & Space(COLS), PosInicioDolar) & Right(Space(10) & Format(System.Math.Round(FPREtirosD, 2), gstrFormatoCantidad), 10) & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left(Left("(-)Devoluciones" & Space(COLS), PosInicioDolar) & Right(Space(10) & Format(System.Math.Round(FPDevolucionesDolar, 2), gstrFormatoCantidad), 10) & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(System.Math.Round(FPDevolucionesDolar, 1), gstrFormatoCantidad)), 10))
                    '''Print #1, " " + Left(Left("(-)Devoluciones" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPDevolucionesDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(Round(FPDevolucionesDolar * RsAux!TipoCambio, 1), gstrFormatoCantidad)), 10)
                    '''Print #1, " " + Left(Left("(-)Devoluciones" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPDevolucionesDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(Round(FPDevolucionesDolar * TipoCambio, 1), gstrFormatoCantidad)), 10)
                    PrintLine(1, " " & Left(Left("(-)Cambios" & Space(COLS), PosInicioDolar) & Right(Space(10) & Format(System.Math.Round(FPCambiosDolar, 2), gstrFormatoCantidad), 10) & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(mcurImporteCambioDolarP, gstrFormatoCantidad)), 10))
                    '''Print #1, " " + Left(Left("(-)Cambios" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPCambiosDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosDolar * RsAux!TipoCambio, gstrFormatoCantidad)), 10)
                    '''Print #1, " " + Left(Left("(-)Cambios" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPCambiosDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosDolar * TipoCambio, gstrFormatoCantidad)), 10)

                    'Print #1, " " + Left("(-)Devoluciones" + Space(Cols), PosInicioSistema) + Right(Space(10) + CStr(Format(FPDevolucionesDolar, gstrFormatoCantidad)), 10)
                    'Print #1, " " + Left("(-)Cambios" + Space(Cols), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosDolar, gstrFormatoCantidad)), 10)
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & New String("-", 10) & Space(COLS), PosInicioCajero) & New String("-", 10) & Space(COLS), PosInicioDif) & New String("-", 11))
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & Right(Space(10) & Format(System.Math.Round(SubTotalSistema, 2), gstrFormatoCantidad), 10) & Space(COLS), PosInicioCajero) & Right(Space(10) & Format(SubTotalCajero, gstrFormatoCantidad), 10) & Space(COLS), PosInicioDif) & Right(Space(11) & Format(SubTotalDif, gstrFormatoCantidad), 11))
                    If EncabezadoEfectivo = False Then
                        '''Print #1, " " & String(COLS - 1, "-")
                        '''Print #1, ""
                        '''Print #1, " " + Left(Left(Left("TOTAL EFECTIVO" + String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(TotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(TotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(TotalDif, gstrFormatoCantidad), 11)
                        '''Print #1, ""
                        EncabezadoEfectivo = True
                    End If
                    '''TotalSistema = 0
                    '''TotalCajero = 0
                    '''TotalDif = 0
                Else
                    'Se trata de el resto de las Formas de Pago
                    SubTotalSistema = FPIngresosP - FPREtirosP
                    SubTotalCajero = ImporteFPUsuario
                    'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
                    'Por Tanto, el Importe de Diferencia debe ser 0 También
                    If Reimpresion = True Then
                        SubTotalDif = 0
                    Else
                        SubTotalDif = SubTotalCajero - SubTotalSistema
                    End If
                    TotalSistema = TotalSistema + SubTotalSistema
                    TotalCajero = TotalCajero + SubTotalCajero
                    TotalDif = TotalDif + SubTotalDif
                    PrintLine(1, " " & CStr(CodFP) & ") " & UCase(DescFP))
                    PrintLine(1, "")
                    PrintLine(1, " " & Left("(+)Ingresos" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left("(-)Retiros" & Space(COLS), PosInicioSistema) & Right(Space(10) & CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10))
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & New String("-", 10) & Space(COLS), PosInicioCajero) & New String("-", 10) & Space(COLS), PosInicioDif) & New String("-", 11))
                    PrintLine(1, " " & Left(Left(Left(New String(" ", COLS), PosInicioSistema) & Right(Space(10) & Format(SubTotalSistema, gstrFormatoCantidad), 10) & Space(COLS), PosInicioCajero) & Right(Space(10) & Format(SubTotalCajero, gstrFormatoCantidad), 10) & Space(COLS), PosInicioDif) & Right(Space(11) & Format(SubTotalDif, gstrFormatoCantidad), 11))
                    PrintLine(1, " ")
                End If
            End If
            rsFP.MoveNext()
            FPIngresosD = 0
            FPIngresosP = 0
            FPREtirosD = 0
            FPREtirosP = 0
            SubTotalCajero = 0
            SubTotalDif = 0
            SubTotalSistema = 0
        End While

        'Impresión de los Totales de Documentos
        PrintLine(1, " " & New String("-", COLS - 1))
        PrintLine(1, "")
        PrintLine(1, " " & Left(Left(Left("TOTAL " & New String(" ", COLS), PosInicioSistema) & Right(Space(10) & Format(TotalSistema, gstrFormatoCantidad), 10) & Space(COLS), PosInicioCajero) & Right(Space(10) & Format(TotalCajero, gstrFormatoCantidad), 10) & Space(COLS), PosInicioDif) & Right(Space(11) & Format(TotalDif, gstrFormatoCantidad), 11))
        '''Print #1, " " + Left(Left(Left("TOTAL DOCUMENTOS" + String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(TotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(TotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(TotalDif, gstrFormatoCantidad), 11)
        PrintLine(1, "")
        PrintLine(1, "")
        PrintLine(1, "")
        EncabezadoEfectivo = True
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub


    '''Sub TicketCorteFinalDia(FechaCorte As Date, CodSucursal As Integer, CodCaja As Integer, TipoCorte As String, Reimpresion As Boolean)
    ''''TipoCorte : Especifica si es un Corte Final del Día (F) o un Corte de Auditoria (A)
    ''''Reimpresión : Indica si se trata de una Reimpresion, Sólo par COrte Final de Día
    '''    On Error GoTo Errores
    '''    'Fecha: Fecha de Corte
    '''    'Sucursal : Número de Sucursal donde se Hace el COrte
    '''    'Caja  : Número de Caja, que imprime el COrte
    '''
    '''    Dim I As Byte
    '''    Dim J As Byte
    '''    Dim COLS As Byte                'Contiene el Número total de COlumnas que abarcará el Ticket
    '''    Dim recAux As Recordset
    '''    Dim TotalPiezasVendidas As Integer
    '''    Dim TotalPiezasDevueltas As Integer
    '''    Dim TotalDocumentos As Currency
    '''    Dim TotalVentasD  As Currency
    '''    Dim TotalDevolD As Currency
    '''    Dim TotalApartadosD As Currency
    '''    Dim TotalReparacionesD As Currency
    '''    Dim TotalRetirosD As Currency
    '''
    '''    Dim TotalAbonosD As Currency
    '''    Dim TotalAntciposD As Currency
    '''    Dim DiferenciaFPSistemaUsuario As Currency  'Diferencia entre lo que proporciona el sistema y los datos que proporcionó el usuario
    '''    Dim x As Variant
    '''
    '''    Dim Encabez(10, 5) As Variant      'Arreglo que contiene los Datos del Encabezado del corte
    '''    Dim VENTAS(25, 5) As Variant       'Arreglo que contiene los Datos de las Ventas
    '''    Dim Devoluciones(52, 5) As Variant 'Arreglo que contiene los Datos de las devoluciones
    '''    Dim Apartados(60, 5) As Variant    'Arreglo que contiene los Datos de los Apartados
    '''    Dim Reparaciones(79, 5) As Variant 'Arreglo que contiene los Datos de las Reparaciones
    '''    Dim Retiros(98, 5) As Variant      'Arreglo que contiene los Datos de los Retiros
    '''    Dim Abonos(117, 5) As Variant      'Arreglo que contiene los Datos de los Abonos
    '''    Dim Anticipos(129, 5) As Variant   'Arreglo que contiene los Datos de los Anticipos
    '''    Dim Totales(129, 5) As Variant     'Arreglo que contiene los Datos de los Anticipos
    '''
    '''    Dim ConfigCorte(130, 5) As Variant 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
    '''                                       'De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.
    '''
    '''    Dim Valores(20) As Variant         'Contiene los Valores de las Tablas que serán los Impresos en el Ticket
    '''
    '''    Dim PALABRA As String
    '''    Dim TipoPrecio As String
    '''    Dim TipoCambio As Currency
    '''    Dim FormatoCantidad  As String  'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
    '''    'uno para las columnas
    '''    Const C_TamañoEncabezado = 10
    '''    Const C_TamañoVentas = 15
    '''    Const C_TamañoDevoluciones = 21
    '''    Const C_TamañoApartados = 7
    '''    Const C_TamañoReparaciones = 7
    '''    Const C_TamañoRetiros = 19
    '''    Const C_TamañoAbonos = 19
    '''    Const C_TamañoAnticipos = 19
    '''    Const C_TamañoTotales = 7
    '''    For I = 0 To 20
    '''        Valores(I) = ""
    '''    Next I
    '''
    '''   ''Llenar el Vector de COnfiguración
    '''
    '''    ConfigCorte(0, 0) = " ":                                                        ConfigCorte(0, 1) = " ":                                        ConfigCorte(0, 2) = 56:     ConfigCorte(0, 3) = 0:       ConfigCorte(0, 4) = "C"
    '''
    '''    ConfigCorte(1, 0) = " ":                                                        ConfigCorte(1, 1) = "(Empresa)":                                ConfigCorte(1, 2) = -1:     ConfigCorte(1, 3) = 1: ConfigCorte(1, 4) = "E"
    '''
    '''    ConfigCorte(2, 0) = " ":                                                        ConfigCorte(2, 1) = "(Dirección Empresa)+(Ciudad Empresa)":     ConfigCorte(2, 2) = -1:     ConfigCorte(2, 3) = 1: ConfigCorte(2, 4) = "E"
    '''
    '''    ConfigCorte(3, 0) = "RFC:":                                                     ConfigCorte(3, 1) = "(RFC)":                                    ConfigCorte(3, 2) = -1:     ConfigCorte(3, 3) = 1: ConfigCorte(3, 4) = "E"
    '''
    '''    ConfigCorte(4, 0) = " ":                                                        ConfigCorte(4, 1) = "(Sucursal)":                               ConfigCorte(4, 2) = -1:     ConfigCorte(4, 3) = 2: ConfigCorte(4, 4) = "E"
    '''
    '''    ' Si es Reimpresióm , Cambia el Encabezado del Ticket'
    '''    ' Al igual que si es Corte Auditoria
    '''
    '''    If TipoCorte = "F" Then
    '''        If Reimpresion = True Then
    '''            ConfigCorte(5, 0) = "*** REIMPRESION DE CORTE FINAL DE CAJA  ***":      ConfigCorte(5, 1) = " ":                                        ConfigCorte(5, 2) = -1:      ConfigCorte(5, 3) = 2: ConfigCorte(5, 4) = "E"
    '''        Else
    '''            ConfigCorte(5, 0) = "***  CORTE FINAL DE CAJA  ***":                    ConfigCorte(5, 1) = " ":                                        ConfigCorte(5, 2) = -1:     ConfigCorte(5, 3) = 2: ConfigCorte(5, 4) = "E"
    '''        End If
    '''    ElseIf TipoCorte = "A" Then
    '''
    '''        ConfigCorte(5, 0) = "*** CORTE DE AUDITORIA ***":                           ConfigCorte(5, 1) = " ":                                        ConfigCorte(5, 2) = -1:     ConfigCorte(5, 3) = 2: ConfigCorte(5, 4) = "E"
    '''
    '''    End If
    '''
    '''    If TipoCorte = "F" Then
    '''        ConfigCorte(6, 0) = "FECHA: ":                                              ConfigCorte(6, 1) = "(Fecha)+(Hora)":                           ConfigCorte(6, 2) = 1:      ConfigCorte(6, 3) = 0: ConfigCorte(6, 4) = "E"
    '''
    '''        ConfigCorte(7, 0) = "FOLIO: ":                                              ConfigCorte(7, 1) = "(Folio)":                                  ConfigCorte(7, 2) = 28:     ConfigCorte(7, 3) = 1: ConfigCorte(7, 4) = "E"
    '''
    '''        ConfigCorte(8, 0) = "VENDEDOR: ":                                           ConfigCorte(8, 1) = "(Vendedor)":                               ConfigCorte(8, 2) = 1:      ConfigCorte(0, 3) = 1: ConfigCorte(8, 4) = "E"
    '''
    '''        ConfigCorte(9, 0) = "CAJA: ":                                               ConfigCorte(9, 1) = "(Caja)":                                   ConfigCorte(9, 2) = 1:      ConfigCorte(9, 3) = 2: ConfigCorte(9, 4) = "E"
    '''
    '''        ConfigCorte(10, 0) = "":                                                    ConfigCorte(10, 1) = "(Linea Separa)":                          ConfigCorte(10, 2) = 1:     ConfigCorte(10, 3) = 2: ConfigCorte(10, 4) = "E"
    '''
    '''    End If
    '''
    '''    'Ventas
    '''
    '''    ConfigCorte(11, 0) = "VENTAS":                                                  ConfigCorte(11, 1) = "":                                         ConfigCorte(11, 2) = 1:    ConfigCorte(11, 3) = 0: ConfigCorte(11, 4) = "S"
    '''
    '''    ConfigCorte(12, 0) = "":                                                        ConfigCorte(12, 1) = "(Total Movimientos)":                      ConfigCorte(12, 2) = 17:   ConfigCorte(12, 3) = 0: ConfigCorte(12, 4) = "S"
    '''
    '''    ConfigCorte(13, 0) = "":                                                        ConfigCorte(13, 1) = "(Folio Inicial)":                          ConfigCorte(13, 2) = 18:   ConfigCorte(13, 3) = 0: ConfigCorte(13, 4) = "S"
    '''
    '''    ConfigCorte(14, 0) = "":                                                        ConfigCorte(14, 1) = "(Folio Final)":                           ConfigCorte(14, 2) = 37:    ConfigCorte(14, 3) = 2: ConfigCorte(14, 4) = "S"
    '''
    '''    ConfigCorte(15, 0) = "CONTADO":                                                 ConfigCorte(15, 1) = "":                                        ConfigCorte(15, 2) = 5:     ConfigCorte(15, 3) = 0: ConfigCorte(15, 4) = "S"
    '''
    '''    ConfigCorte(16, 0) = "":                                                        ConfigCorte(16, 1) = "(Ventas Contado Dolar)":                  ConfigCorte(16, 2) = 20:    ConfigCorte(16, 3) = 0: ConfigCorte(16, 4) = "S"
    '''
    '''    ConfigCorte(17, 0) = "":                                                        ConfigCorte(17, 1) = "(Ventas Contado Pesos)":                  ConfigCorte(17, 2) = 39:    ConfigCorte(17, 3) = 1: ConfigCorte(17, 4) = "S"
    '''
    '''    ConfigCorte(18, 0) = "CREDITO":                                                 ConfigCorte(18, 1) = "":                                        ConfigCorte(18, 2) = 5:     ConfigCorte(18, 3) = 0: ConfigCorte(18, 4) = "S"
    '''
    '''    ConfigCorte(19, 0) = "":                                                        ConfigCorte(19, 1) = "(Ventas Credito Dolar)":                  ConfigCorte(19, 2) = 20:    ConfigCorte(19, 3) = 0: ConfigCorte(19, 4) = "S"
    '''
    '''    ConfigCorte(20, 0) = "":                                                        ConfigCorte(20, 1) = "(Ventas Credito Pesos)":                  ConfigCorte(20, 2) = 39:    ConfigCorte(20, 3) = 1: ConfigCorte(20, 4) = "S"
    '''
    '''    ConfigCorte(21, 0) = "":                                                        ConfigCorte(21, 1) = "":                                        ConfigCorte(21, 2) = 25:    ConfigCorte(21, 3) = 0: ConfigCorte(21, 4) = "S"
    '''
    '''    ConfigCorte(22, 0) = "------------":                                            ConfigCorte(22, 1) = "":                                        ConfigCorte(22, 2) = 44:    ConfigCorte(22, 3) = 1: ConfigCorte(22, 4) = "S"
    '''
    ''''    ConfigCorte(22, 0) = "TOTAL":                                                  ConfigCorte(22, 1) = "":                                        ConfigCorte(22, 2) = 15:    ConfigCorte(22, 3) = 0: ConfigCorte(22, 4) = "S"
    '''
    '''    ConfigCorte(23, 0) = "":                                                        ConfigCorte(23, 1) = "(Total Dolar)":                           ConfigCorte(23, 2) = 20:    ConfigCorte(23, 3) = 0: ConfigCorte(23, 4) = "S"
    '''
    '''    ConfigCorte(24, 0) = "":                                                        ConfigCorte(24, 1) = "":                                        ConfigCorte(24, 2) = 40:    ConfigCorte(24, 3) = 0: ConfigCorte(24, 4) = "S"
    '''
    '''    ConfigCorte(25, 0) = "":                                                        ConfigCorte(25, 1) = "(Total Pesos)":                           ConfigCorte(25, 2) = 39:    ConfigCorte(25, 3) = 2: ConfigCorte(25, 4) = "S"
    '''
    '''    'Devoluciones
    '''
    '''    ConfigCorte(26, 0) = "DEVOLUCIONES":                                            ConfigCorte(26, 1) = "":                                        ConfigCorte(26, 2) = 1:     ConfigCorte(26, 3) = 0: ConfigCorte(26, 4) = "V"
    '''
    '''    ConfigCorte(27, 0) = "":                                                        ConfigCorte(27, 1) = "(Total Movimientos)":                     ConfigCorte(27, 2) = 17:    ConfigCorte(27, 3) = 0: ConfigCorte(27, 4) = "V"
    '''
    '''    ConfigCorte(28, 0) = "":                                                        ConfigCorte(28, 1) = "(Folio Inicial)":                         ConfigCorte(28, 2) = 18:    ConfigCorte(28, 3) = 0: ConfigCorte(28, 4) = "V"
    '''
    '''    ConfigCorte(29, 0) = "":                                                        ConfigCorte(29, 1) = "(Folio Final)":                           ConfigCorte(29, 2) = 37:    ConfigCorte(29, 3) = 2: ConfigCorte(29, 4) = "V"
    '''
    '''    ConfigCorte(30, 0) = "DEVOLUCION":                                              ConfigCorte(30, 1) = "":                                        ConfigCorte(30, 2) = 5:     ConfigCorte(30, 3) = 0: ConfigCorte(30, 4) = "V"
    '''
    '''    ConfigCorte(31, 0) = "":                                                        ConfigCorte(31, 1) = "(Devol Dolar)":                           ConfigCorte(31, 2) = 20:    ConfigCorte(31, 3) = 0: ConfigCorte(31, 4) = "V"
    '''
    '''    ConfigCorte(32, 0) = "":                                                        ConfigCorte(32, 1) = "(Devol Pesos)":                           ConfigCorte(32, 2) = 39:    ConfigCorte(32, 3) = 1: ConfigCorte(32, 4) = "V"
    '''
    '''    ConfigCorte(33, 0) = "VALES DEVOLUCION":                                        ConfigCorte(33, 1) = "":                                        ConfigCorte(33, 2) = 5:     ConfigCorte(33, 3) = 0: ConfigCorte(33, 4) = "V"
    '''
    '''    ConfigCorte(34, 0) = "":                                                        ConfigCorte(34, 1) = "(Vale Devol Dolar)":                      ConfigCorte(34, 2) = 20:    ConfigCorte(34, 3) = 0: ConfigCorte(34, 4) = "V"
    '''
    '''    ConfigCorte(35, 0) = "":                                                        ConfigCorte(35, 1) = "(Vale Devol Pesos)":                      ConfigCorte(35, 2) = 39:    ConfigCorte(35, 3) = 1: ConfigCorte(35, 4) = "V"
    '''
    '''    ConfigCorte(36, 0) = "NOTAS CRÉDITO":                                           ConfigCorte(36, 1) = "":                                        ConfigCorte(36, 2) = 5:     ConfigCorte(36, 3) = 0: ConfigCorte(36, 4) = "V"
    '''
    '''    ConfigCorte(37, 0) = "":                                                        ConfigCorte(37, 1) = "(Notas Credito Dolar)":                   ConfigCorte(37, 2) = 20:    ConfigCorte(37, 3) = 0: ConfigCorte(37, 4) = "V"
    '''
    '''    ConfigCorte(38, 0) = "":                                                        ConfigCorte(38, 1) = "(Notas Credito Pesos)":                   ConfigCorte(38, 2) = 39:    ConfigCorte(38, 3) = 1: ConfigCorte(38, 4) = "V"
    '''
    '''    ConfigCorte(39, 0) = "EFECTIVO":                                                ConfigCorte(39, 1) = "":                                        ConfigCorte(39, 2) = 5:     ConfigCorte(39, 3) = 0: ConfigCorte(39, 4) = "V"
    '''
    '''    ConfigCorte(40, 0) = "":                                                        ConfigCorte(40, 1) = "(Devol Efectivo Dolar)":                  ConfigCorte(40, 2) = 20:    ConfigCorte(40, 3) = 0: ConfigCorte(40, 4) = "V"
    '''
    '''    ConfigCorte(41, 0) = "":                                                        ConfigCorte(41, 1) = "(Devol Efectivo Pesos)":                  ConfigCorte(41, 2) = 39:    ConfigCorte(41, 3) = 1: ConfigCorte(41, 4) = "V"
    '''
    '''    ConfigCorte(42, 0) = "":                                                        ConfigCorte(42, 1) = "":                                        ConfigCorte(42, 2) = 25:    ConfigCorte(42, 3) = 0: ConfigCorte(42, 4) = "V"
    '''
    '''    ConfigCorte(43, 0) = "------------":                                            ConfigCorte(43, 1) = "":                                        ConfigCorte(43, 2) = 46:    ConfigCorte(43, 3) = 1: ConfigCorte(43, 4) = "V"
    '''
    ''''    ConfigCorte(41, 0) = "TOTAL":                                                  ConfigCorte(41, 1) = "":                                        ConfigCorte(41, 2) = 15:    ConfigCorte(41, 3) = 0: ConfigCorte(41, 4) = "V"
    '''
    '''    ConfigCorte(44, 0) = "":                                                        ConfigCorte(44, 1) = "(Total Dolar)":                           ConfigCorte(44, 2) = 20:    ConfigCorte(44, 3) = 0: ConfigCorte(44, 4) = "V"
    '''
    '''    ConfigCorte(45, 0) = "":                                                        ConfigCorte(45, 1) = "":                                        ConfigCorte(45, 2) = 39:    ConfigCorte(45, 3) = 0: ConfigCorte(45, 4) = "V"
    '''
    '''    ConfigCorte(46, 0) = "":                                                        ConfigCorte(46, 1) = "(Total Pesos)":                           ConfigCorte(46, 2) = 39:    ConfigCorte(46, 3) = 2: ConfigCorte(46, 4) = "V"
    '''
    '''    ''APARTADOS
    '''
    '''    ConfigCorte(47, 0) = "APARTADOS":                                               ConfigCorte(47, 1) = "":                                        ConfigCorte(47, 2) = 1:     ConfigCorte(47, 3) = 0: ConfigCorte(47, 4) = "A"
    '''
    '''    ConfigCorte(48, 0) = "":                                                        ConfigCorte(48, 1) = "(Total Movimientos)":                     ConfigCorte(48, 2) = 17:    ConfigCorte(48, 3) = 0: ConfigCorte(48, 4) = "A"
    '''
    '''    ConfigCorte(49, 0) = "":                                                        ConfigCorte(49, 1) = "(Folio Inicial)":                         ConfigCorte(49, 2) = 18:    ConfigCorte(49, 3) = 0: ConfigCorte(49, 4) = "A"
    '''
    '''    ConfigCorte(50, 0) = "":                                                        ConfigCorte(50, 1) = "(Folio Final)":                           ConfigCorte(50, 2) = 37:    ConfigCorte(50, 3) = 2: ConfigCorte(50, 4) = "A"
    '''
    ''''    ConfigCorte(49, 0) = "TOTAL":                                                  ConfigCorte(49, 1) = "":                                        ConfigCorte(49, 2) = 15:    ConfigCorte(49, 3) = 0: ConfigCorte(49, 4) = "A"
    '''
    '''    ConfigCorte(51, 0) = "":                                                        ConfigCorte(51, 1) = "(Total Dolar)":                           ConfigCorte(51, 2) = 20:    ConfigCorte(51, 3) = 0: ConfigCorte(51, 4) = "A"
    '''
    '''    ConfigCorte(52, 0) = "":                                                        ConfigCorte(52, 1) = "":                                        ConfigCorte(52, 2) = 38:    ConfigCorte(52, 3) = 0: ConfigCorte(52, 4) = "A"
    '''
    '''    ConfigCorte(53, 0) = "":                                                        ConfigCorte(53, 1) = "(Total Pesos)":                           ConfigCorte(53, 2) = 39:    ConfigCorte(53, 3) = 2: ConfigCorte(53, 4) = "A"
    '''
    '''    'REPARACIONES
    '''
    '''    ConfigCorte(54, 0) = "REPARACIONES":                                            ConfigCorte(54, 1) = "":                                        ConfigCorte(54, 2) = 1:     ConfigCorte(54, 3) = 0: ConfigCorte(54, 4) = "R"
    '''
    '''    ConfigCorte(55, 0) = "":                                                        ConfigCorte(55, 1) = "(Total Movimientos)":                     ConfigCorte(55, 2) = 17:    ConfigCorte(55, 3) = 0: ConfigCorte(55, 4) = "R"
    '''
    '''    ConfigCorte(56, 0) = "":                                                        ConfigCorte(56, 1) = "(Folio Inicial)":                         ConfigCorte(56, 2) = 18:    ConfigCorte(56, 3) = 0: ConfigCorte(56, 4) = "R"
    '''
    '''    ConfigCorte(57, 0) = "":                                                        ConfigCorte(57, 1) = "(Folio Final)":                           ConfigCorte(57, 2) = 37:    ConfigCorte(57, 3) = 2: ConfigCorte(57, 4) = "R"
    '''
    ''''    ConfigCorte(57, 0) = "TOTAL":                                                  ConfigCorte(57, 1) = "":                                        ConfigCorte(57, 2) = 15:    ConfigCorte(57, 3) = 0: ConfigCorte(57, 4) = "R"
    '''
    '''    ConfigCorte(58, 0) = "":                                                        ConfigCorte(58, 1) = "(Total Dolar)":                           ConfigCorte(58, 2) = 20:    ConfigCorte(58, 3) = 0: ConfigCorte(58, 4) = "R"
    '''
    '''    ConfigCorte(59, 0) = "":                                                        ConfigCorte(59, 1) = "":                                        ConfigCorte(59, 2) = 39:    ConfigCorte(59, 3) = 0: ConfigCorte(59, 4) = "X"
    '''
    '''    ConfigCorte(60, 0) = "":                                                        ConfigCorte(60, 1) = "(Total Pesos)":                           ConfigCorte(60, 2) = 39:    ConfigCorte(60, 3) = 2: ConfigCorte(60, 4) = "R"
    '''
    '''    ''RETIROS
    '''
    '''    ConfigCorte(61, 0) = "RETIROS":                                                 ConfigCorte(61, 1) = "":                                        ConfigCorte(61, 2) = 1:     ConfigCorte(61, 3) = 0: ConfigCorte(61, 4) = "T"
    '''
    '''    ConfigCorte(62, 0) = "":                                                        ConfigCorte(62, 1) = "(Total Movimientos)":                     ConfigCorte(62, 2) = 17:    ConfigCorte(62, 3) = 0: ConfigCorte(62, 4) = "T"
    '''
    '''    ConfigCorte(63, 0) = "":                                                        ConfigCorte(63, 1) = "(Folio Inicial)":                         ConfigCorte(63, 2) = 18:    ConfigCorte(63, 3) = 0: ConfigCorte(63, 4) = "T"
    '''
    '''    ConfigCorte(64, 0) = "":                                                        ConfigCorte(64, 1) = "(Folio Final)":                           ConfigCorte(64, 2) = 37:    ConfigCorte(64, 3) = 2: ConfigCorte(64, 4) = "T"
    '''
    '''    ConfigCorte(65, 0) = "TERCEROS":                                                ConfigCorte(65, 1) = "":                                        ConfigCorte(65, 2) = 5:     ConfigCorte(65, 3) = 0: ConfigCorte(65, 4) = "T"
    '''
    '''    ConfigCorte(66, 0) = "":                                                        ConfigCorte(66, 1) = "(Retiro Terceros Dolar)":                 ConfigCorte(66, 2) = 20:    ConfigCorte(66, 3) = 0: ConfigCorte(66, 4) = "T"
    '''
    '''    ConfigCorte(67, 0) = "":                                                        ConfigCorte(67, 1) = "(Retiro Terceros Pesos)":                 ConfigCorte(67, 2) = 39:    ConfigCorte(67, 3) = 1: ConfigCorte(67, 4) = "T"
    '''
    '''    ConfigCorte(68, 0) = "A DEPOSITOS":                                             ConfigCorte(68, 1) = "":                                        ConfigCorte(68, 2) = 5:     ConfigCorte(68, 3) = 0: ConfigCorte(68, 4) = "T"
    '''
    '''    ConfigCorte(69, 0) = "":                                                        ConfigCorte(69, 1) = "(Retiro Deposito Dolar)":                 ConfigCorte(69, 2) = 20:    ConfigCorte(69, 3) = 0: ConfigCorte(69, 4) = "T"
    '''
    '''    ConfigCorte(70, 0) = "":                                                        ConfigCorte(70, 1) = "(Retiro Deposito Pesos)":                 ConfigCorte(70, 2) = 39:    ConfigCorte(70, 3) = 1: ConfigCorte(70, 4) = "T"
    '''
    '''    ConfigCorte(71, 0) = "A CAJA GRAL.":                                            ConfigCorte(71, 1) = "":                                        ConfigCorte(71, 2) = 5:     ConfigCorte(71, 3) = 0: ConfigCorte(71, 4) = "T"
    '''
    '''    ConfigCorte(72, 0) = "":                                                        ConfigCorte(72, 1) = "(Retiro Envio Caja Dolar)":               ConfigCorte(72, 2) = 20:    ConfigCorte(72, 3) = 0: ConfigCorte(72, 4) = "T"
    '''
    '''    ConfigCorte(73, 0) = "":                                                        ConfigCorte(73, 1) = "(Retiro Envio Caja Pesos)":               ConfigCorte(73, 2) = 39:    ConfigCorte(73, 3) = 1: ConfigCorte(73, 4) = "T"
    '''
    '''    ConfigCorte(74, 0) = "":                                                        ConfigCorte(74, 1) = "":                                        ConfigCorte(74, 2) = 25:    ConfigCorte(74, 3) = 0: ConfigCorte(74, 4) = "T"
    '''
    '''    ConfigCorte(75, 0) = "------------":                                            ConfigCorte(75, 1) = "":                                        ConfigCorte(75, 2) = 44:    ConfigCorte(75, 3) = 1: ConfigCorte(75, 4) = "T"
    '''
    '''    ConfigCorte(76, 0) = "":                                                        ConfigCorte(76, 1) = "":                                        ConfigCorte(76, 2) = 15:    ConfigCorte(76, 3) = 0: ConfigCorte(76, 4) = "T"
    '''
    '''    ConfigCorte(77, 0) = "":                                                        ConfigCorte(77, 1) = "(Total Dolar)":                           ConfigCorte(77, 2) = 20:    ConfigCorte(77, 3) = 0: ConfigCorte(77, 4) = "T"
    '''
    '''    ConfigCorte(78, 0) = "":                                                        ConfigCorte(78, 1) = "":                                        ConfigCorte(78, 2) = 39:    ConfigCorte(78, 3) = 0: ConfigCorte(78, 4) = "T"
    '''
    '''    ConfigCorte(79, 0) = "":                                                        ConfigCorte(79, 1) = "(Total Pesos)":                           ConfigCorte(79, 2) = 39:    ConfigCorte(79, 3) = 2: ConfigCorte(79, 4) = "T"
    '''
    '''
    '''    ''ABONOS A DOCUMENTOS
    '''
    '''    ConfigCorte(80, 0) = "ABONOS A DOCTOS":                                         ConfigCorte(80, 1) = "":                                        ConfigCorte(80, 2) = 1:     ConfigCorte(80, 3) = 0: ConfigCorte(80, 4) = "G"
    '''
    '''    ConfigCorte(81, 0) = "":                                                        ConfigCorte(81, 1) = "(Total Movimientos)":                     ConfigCorte(81, 2) = 17:    ConfigCorte(81, 3) = 1: ConfigCorte(81, 4) = "G"
    '''
    '''    ConfigCorte(82, 0) = "":                                                        ConfigCorte(82, 1) = "(Folio Inicial)":                         ConfigCorte(82, 2) = 18:    ConfigCorte(82, 3) = 0: ConfigCorte(82, 4) = "G"
    '''
    '''    ConfigCorte(83, 0) = "":                                                        ConfigCorte(83, 1) = "(Folio Final)":                           ConfigCorte(83, 2) = 37:    ConfigCorte(83, 3) = 1: ConfigCorte(83, 4) = "G"
    '''
    '''    ConfigCorte(84, 0) = "VENTAS CREDITO":                                          ConfigCorte(84, 1) = "":                                        ConfigCorte(84, 2) = 5:     ConfigCorte(84, 3) = 0: ConfigCorte(84, 4) = "G"
    '''
    '''    ConfigCorte(85, 0) = "":                                                        ConfigCorte(85, 1) = "(Abono Ventas Dolar)":                    ConfigCorte(85, 2) = 20:    ConfigCorte(85, 3) = 0: ConfigCorte(85, 4) = "G"
    '''
    '''    ConfigCorte(86, 0) = "":                                                        ConfigCorte(86, 1) = "(Abono Ventas Pesos)":                    ConfigCorte(86, 2) = 39:    ConfigCorte(86, 3) = 1: ConfigCorte(86, 4) = "G"
    '''
    '''    ConfigCorte(87, 0) = "REPARACIONES":                                            ConfigCorte(87, 1) = "":                                        ConfigCorte(87, 2) = 5:     ConfigCorte(87, 3) = 0: ConfigCorte(87, 4) = "G"
    '''
    '''    ConfigCorte(88, 0) = "":                                                        ConfigCorte(88, 1) = "(Abono Reparaciones Dolar)":              ConfigCorte(88, 2) = 20:    ConfigCorte(88, 3) = 0: ConfigCorte(88, 4) = "G"
    '''
    '''    ConfigCorte(89, 0) = "":                                                        ConfigCorte(89, 1) = "(Abono Reparaciones Pesos)":              ConfigCorte(89, 2) = 39:    ConfigCorte(89, 3) = 1: ConfigCorte(89, 4) = "G"
    '''
    '''    ConfigCorte(90, 0) = "APARTADOS":                                               ConfigCorte(90, 1) = "":                                        ConfigCorte(90, 2) = 5:     ConfigCorte(90, 3) = 0: ConfigCorte(90, 4) = "G"
    '''
    '''    ConfigCorte(91, 0) = "":                                                        ConfigCorte(91, 1) = "(Abono Apartados Dolar)":                 ConfigCorte(91, 2) = 20:    ConfigCorte(91, 3) = 0: ConfigCorte(91, 4) = "G"
    '''
    '''    ConfigCorte(92, 0) = "":                                                        ConfigCorte(92, 1) = "(Abono Apartados Pesos)":                 ConfigCorte(92, 2) = 39:    ConfigCorte(92, 3) = 1: ConfigCorte(92, 4) = "G"
    '''
    '''    ConfigCorte(93, 0) = "":                                                        ConfigCorte(93, 1) = "":                                        ConfigCorte(93, 2) = 25:    ConfigCorte(93, 3) = 0: ConfigCorte(93, 4) = "G"
    '''
    '''    ConfigCorte(94, 0) = "------------":                                            ConfigCorte(94, 1) = "":                                        ConfigCorte(94, 2) = 44:    ConfigCorte(94, 3) = 1: ConfigCorte(94, 4) = "G"
    '''
    '''    ConfigCorte(95, 0) = "":                                                        ConfigCorte(95, 1) = "":                                        ConfigCorte(95, 2) = 15:    ConfigCorte(95, 3) = 0: ConfigCorte(95, 4) = "G"
    '''
    '''    ConfigCorte(96, 0) = "":                                                        ConfigCorte(96, 1) = "(Total Dolar)":                           ConfigCorte(96, 2) = 20:    ConfigCorte(96, 3) = 0: ConfigCorte(96, 4) = "G"
    '''
    '''    ConfigCorte(97, 0) = "":                                                        ConfigCorte(97, 1) = "":                                        ConfigCorte(97, 2) = 39:    ConfigCorte(97, 3) = 0: ConfigCorte(97, 4) = "G"
    '''
    '''    ConfigCorte(98, 0) = "":                                                        ConfigCorte(98, 1) = "(Total Pesos)":                           ConfigCorte(98, 2) = 39:    ConfigCorte(98, 3) = 2: ConfigCorte(98, 4) = "G"
    '''
    '''    ''ANTICIPOS
    '''
    '''     ConfigCorte(99, 0) = "ANTICIPOS":                                              ConfigCorte(99, 1) = "":                                        ConfigCorte(99, 2) = 1:     ConfigCorte(99, 3) = 0: ConfigCorte(99, 4) = "N"
    '''
    '''    ConfigCorte(100, 0) = "":                                                       ConfigCorte(100, 1) = "(Total Movimientos)":                    ConfigCorte(100, 2) = 17:   ConfigCorte(100, 3) = 1: ConfigCorte(100, 4) = "N"
    '''
    '''    ConfigCorte(101, 0) = "":                                                       ConfigCorte(101, 1) = "(Folio Inicial)":                        ConfigCorte(101, 2) = 18:   ConfigCorte(101, 3) = 0: ConfigCorte(101, 4) = "N"
    '''
    '''    ConfigCorte(102, 0) = "":                                                       ConfigCorte(102, 1) = "(Folio Final)":                          ConfigCorte(102, 2) = 37:   ConfigCorte(102, 3) = 1: ConfigCorte(102, 4) = "N"
    '''
    '''    ConfigCorte(103, 0) = "VENTAS CREDITO":                                         ConfigCorte(103, 1) = "":                                       ConfigCorte(103, 2) = 5:    ConfigCorte(103, 3) = 0: ConfigCorte(103, 4) = "N"
    '''
    '''    ConfigCorte(104, 0) = "":                                                       ConfigCorte(104, 1) = "(Anticipo Ventas Dolar)":                ConfigCorte(104, 2) = 20:   ConfigCorte(104, 3) = 0: ConfigCorte(104, 4) = "N"
    '''
    '''    ConfigCorte(105, 0) = "":                                                       ConfigCorte(105, 1) = "(Anticipo Ventas Pesos)":                ConfigCorte(105, 2) = 39:   ConfigCorte(105, 3) = 1: ConfigCorte(105, 4) = "N"
    '''
    '''    ConfigCorte(106, 0) = "REPARACIONES":                                           ConfigCorte(106, 1) = "":                                       ConfigCorte(106, 2) = 5:    ConfigCorte(106, 3) = 0: ConfigCorte(106, 4) = "N"
    '''
    '''    ConfigCorte(107, 0) = "":                                                       ConfigCorte(107, 1) = "(Anticipo Reparaciones Dolar)":          ConfigCorte(107, 2) = 20:   ConfigCorte(107, 3) = 0: ConfigCorte(107, 4) = "N"
    '''
    '''    ConfigCorte(108, 0) = "":                                                       ConfigCorte(108, 1) = "(Anticipo Reparaciones Pesos)":          ConfigCorte(108, 2) = 39:   ConfigCorte(108, 3) = 1: ConfigCorte(108, 4) = "N"
    '''
    '''    ConfigCorte(109, 0) = "APARTADOS":                                              ConfigCorte(109, 1) = "":                                       ConfigCorte(109, 2) = 5:    ConfigCorte(109, 3) = 0: ConfigCorte(109, 4) = "N"
    '''
    '''    ConfigCorte(110, 0) = "":                                                       ConfigCorte(110, 1) = "(Anticipo Apartados Dolar)":             ConfigCorte(110, 2) = 20:   ConfigCorte(110, 3) = 0: ConfigCorte(110, 4) = "N"
    '''
    '''    ConfigCorte(111, 0) = "":                                                       ConfigCorte(111, 1) = "(Anticipo Apartados Pesos)":             ConfigCorte(111, 2) = 39:   ConfigCorte(111, 3) = 1: ConfigCorte(111, 4) = "N"
    '''
    '''    ConfigCorte(112, 0) = "":                                                       ConfigCorte(112, 1) = "":                                       ConfigCorte(112, 2) = 25:   ConfigCorte(112, 3) = 0: ConfigCorte(112, 4) = "N"
    '''
    '''    ConfigCorte(113, 0) = "------------":                                           ConfigCorte(113, 1) = "":                                       ConfigCorte(113, 2) = 44:   ConfigCorte(113, 3) = 1: ConfigCorte(113, 4) = "N"
    '''
    '''    ConfigCorte(114, 0) = "":                                                       ConfigCorte(114, 1) = "":                                       ConfigCorte(114, 2) = 15:   ConfigCorte(114, 3) = 0: ConfigCorte(114, 4) = "N"
    '''
    '''    ConfigCorte(115, 0) = "":                                                       ConfigCorte(115, 1) = "(Total Dolar)":                          ConfigCorte(115, 2) = 20:   ConfigCorte(115, 3) = 0: ConfigCorte(115, 4) = "N"
    '''
    '''    ConfigCorte(116, 0) = "":                                                       ConfigCorte(116, 1) = "":                                       ConfigCorte(116, 2) = 39:   ConfigCorte(116, 3) = 0: ConfigCorte(116, 4) = "N"
    '''
    '''    ConfigCorte(117, 0) = "":                                                       ConfigCorte(117, 1) = "(Total Pesos)":                          ConfigCorte(117, 2) = 39:   ConfigCorte(117, 3) = 2: ConfigCorte(117, 4) = "N"
    '''
    '''    'TOTALES
    '''
    '''    If TipoCorte = "F" Then
    '''        ConfigCorte(118, 0) = "PIEZAS VENDIDAS      ":                              ConfigCorte(118, 1) = "(Piezas Vendidas)":                      ConfigCorte(118, 2) = 31:   ConfigCorte(118, 3) = 1: ConfigCorte(118, 4) = "T"
    '''
    '''        ConfigCorte(119, 0) = "PIEZAS DEVUELTAS     ":                              ConfigCorte(119, 1) = "(Piezas Devueltas)":                     ConfigCorte(119, 2) = 31:   ConfigCorte(119, 3) = 2: ConfigCorte(119, 4) = "T"
    '''    End If
    '''
    '''    ConfigCorte(120, 0) = "":                                                       ConfigCorte(120, 1) = "(Linea Separa)":                         ConfigCorte(120, 2) = 1:    ConfigCorte(120, 3) = 2: ConfigCorte(120, 4) = "T"
    '''
    '''    ConfigCorte(121, 0) = "":                                                       ConfigCorte(121, 1) = "(Formas de Pago)":                       ConfigCorte(121, 2) = 1:    ConfigCorte(121, 3) = 1: ConfigCorte(121, 4) = "T"
    '''
    '''    ConfigCorte(122, 0) = "--------------------":                                   ConfigCorte(122, 1) = "":                                       ConfigCorte(122, 2) = 20:   ConfigCorte(122, 3) = 1: ConfigCorte(122, 4) = "T"
    '''
    '''    ConfigCorte(123, 0) = "SUPERVISOR":                                             ConfigCorte(123, 1) = "":                                       ConfigCorte(123, 2) = 25:   ConfigCorte(123, 3) = 4: ConfigCorte(123, 4) = "T"
    '''
    '''    ConfigCorte(124, 0) = "** FIN DEL CORTE **":                                    ConfigCorte(124, 1) = "":                                       ConfigCorte(124, 2) = 20:   ConfigCorte(124, 3) = 1: ConfigCorte(124, 4) = "T"
    '''
    '''
    '''
    '''    gStrSql = "SELECT     dbo.ConfiguracionGeneral.NombreEmp as  NomEmpresa, dbo.ConfiguracionGeneral.RFCEmp as RFCEmpresa, dbo.ConfiguracionGeneral.DomicilioEmp as DirEmpresa , dbo.CatAlmacen.DescAlmacen as NomSucursal, " & _
    ''''            "dbo.CatAlmacen.Domicilio as DirSucursal , dbo.ConfiguracionGeneral.TipoCambio  " & _
    ''''            "FROM         dbo.ConfiguracionGeneral CROSS JOIN  " & _
    ''''            "dbo.CatAlmacen  " & _
    ''''            "Where (dbo.CatAlmacen.CodAlmacen = " & CodSucursal & " )"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        TipoCambio = RsGral!TipoCambio
    '''        Valores(0) = Trim(RsGral!NomEmpresa)                                'Nombre Empresa
    '''        Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral!DirEmpresa))        'Direccion Empresa
    '''        Valores(2) = ""                                                     'Ciudad Empresa
    '''        Valores(3) = Trim(RsGral!NomSucursal)                               'Nombre Sucursal
    '''        Valores(4) = Trim(ModEstandar.QuitaEnter(RsGral!DirSucursal))       'Dirección Sucursal
    '''        Valores(5) = ""                                                     'Ciudad Sucursal
    '''        Valores(6) = Trim(ModEstandar.QuitaEnter(RsGral!RfcEmpresa))        'RFC Empresa
    '''    Else
    '''        MsgBox "Favor de Checar Configuración del Punto de Venta", vbOKOnly + vbExclamation, "Aviso"
    '''        For I = 0 To 6
    '''            Valores(I) = RsGral.Fields(Val(I))
    '''        Next I
    '''    End If
    '''
    '''    gStrSql = "SELECT     FolioCorte FROM         dbo.CorteZ " & _
    ''''            "wHERE FechaCorte ='" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'  and CodSucursal =" & CodSucursal & " and CodCaja= " & CodCaja & " "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsGral = Cmd.Execute
    '''    If RsGral.RecordCount > 0 Then
    '''        Valores(7) = RsGral!FolioCorte
    '''        Valores(8) = Format(FechaCorte, "DD/MMM/YYYY")       'Fecha
    '''        Valores(9) = Format(Now, "HH:MM")      'Hora
    '''        Valores(10) = ""                                     'Vendedor
    '''        Valores(11) = CodCaja                                'Caja
    '''    End If
    '''
    '''    COLS = ConfigCorte(0, 2)
    '''
    '''    For I = 1 To C_TamañoEncabezado
    '''        If ConfigCorte(I, 4) <> "E" Then Exit For
    '''            Encabez(I, 0) = ConfigCorte(I, 0)
    '''            Encabez(I, 2) = ConfigCorte(I, 2)
    '''            Encabez(I, 3) = ConfigCorte(I, 3)
    '''            Encabez(I, 4) = "S"
    '''            If ConfigCorte(I, 1) <> "" Then
    '''                PALABRA = ""
    '''                For J = 1 To Len(Trim(ConfigCorte(I, 1)))
    '''                    If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" Then
    '''                        PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                    ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    ''''                        Encabez(i, 4) = "S"
    '''                        Select Case PALABRA
    '''                            Case "Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
    '''                            Case "Dirección Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
    '''                            Case "Ciudad Empresa"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
    '''                            Case "Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
    '''                            Case "Dirección Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
    '''                            Case "Ciudad Sucursal"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
    '''                            Case "RFC"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
    '''                            Case "Folio"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
    '''                            Case "Fecha"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
    '''                            Case "Hora"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(9) + "  "
    '''                            Case "Vendedor"
    '''                                Encabez(I, 1) = Encabez(I, 1) + Valores(10) + "  "
    '''                            Case "Caja"
    '''                                Encabez(I, 1) = Encabez(I, 1) + CStr(Valores(11)) + "  "
    '''                            Case "Linea Separa"
    '''                                Encabez(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Encabez(I, 1) = Encabez(I, 1) + String(60, "-")
    ''''                                Encabez(i, 4) = "C"
    '''                        End Select
    '''                        PALABRA = ""
    '''                    End If
    '''                Next J
    '''            End If
    '''   Next I
    '''
    '''Continuar:
    '''
    '''    '''Open "C:\SISTEMA\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
    '''    Open gstrTicketPrinter For Output As #1
    '''    Dim Linea As String
    '''    Print #1, Chr(27) + Chr(33) + Chr(1)
    '''    For I = 1 To C_TamañoEncabezado
    '''        If Encabez(I, 4) = "S" Then
    '''            If CDbl(ConfigCorte(I, 2)) = -1 Then
    '''                Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
    '''                If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
    '''            End If
    '''            Linea = Left(Linea + Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
    '''            If Encabez(I, 3) > 0 Then
    '''                For J = 1 To Encabez(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        End If
    '''    Next I
    '''
    ''''Si se trata de un Corte de Auditoria, no se Imprime Esta Parte, se va Directamente a los Totales.
    '''If TipoCorte = "F" Then
    '''
    '''    ''IMPRESION DE LOS DATOS DE VENTAS
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de VEntas
    '''
    '''    gStrSql = "SELECT DISTINCT FolioMovto AS FolioMovto, TotalMovto, CantidadArticulos, Condicion, " & _
    ''''                    "(SELECT     MAX(FolioMovto) " & _
    ''''                    "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ") CorteFinalCaja " & _
    ''''                    "WHERE      (Movimiento = 'S')) AS FolioFinal, " & _
    ''''                    "(SELECT     MIN(FolioMovto) " & _
    ''''                    "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                    "WHERE      (Movimiento = 'S')) AS FolioInicial " & _
    ''''                "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                "WHERE     (Movimiento = 'S') " & _
    ''''                "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''    If recAux.RecordCount > 0 Then
    '''       Linea = Left(Space(20) + "MOVIMIENTOS DIARIOS" + Space(COLS), COLS)
    '''       Print #1, Left(RTrim(Linea), COLS)
    '''       Linea = Left(Space(20) + String(COLS, "-"), COLS)
    '''       Print #1, Left(RTrim(Linea), COLS)
    '''    End If
    '''
    '''    Dim SIMBOLO As String
    '''    Dim Valor As Double
    '''    Dim FinPal As Boolean           'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
    '''    Dim Encabezado As Boolean
    '''    Dim H As Byte
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            Valores(1) = Trim(recAux!FolioInicial)                    'FolioInicial
    '''            Valores(2) = Trim(recAux!FolioFinal)                      'Folio Final
    '''            If recAux!Condicion = "CO" Then
    '''                Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(4) = Valores(3) * TipoCambio
    '''            Else
    '''                Valores(5) = Valores(5) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(6) = Valores(5) * TipoCambio
    '''            End If
    '''            Valores(9) = Valores(9) + recAux!CantidadArticulos
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        TotalPiezasVendidas = Valores(9)
    '''        Valores(7) = Valores(3) + Valores(5)
    '''        TotalVentasD = Valores(7)
    '''        Valores(8) = Valores(4) + Valores(6)
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        Valores(5) = Format(Round(Valores(5), 2), gstrFormatoCantidad)
    '''        Valores(6) = Format(Round(Valores(6), 1), gstrFormatoCantidad)
    '''        Valores(7) = Format(Round(Valores(7), 2), gstrFormatoCantidad)
    '''        Valores(8) = Format(Round(Valores(8), 1), gstrFormatoCantidad)
    '''
    '''        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''        'y se le Asigna el Valor obtenido en la consulta para las ventas
    '''        For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoVentas)   '30. Tamaño del VEctro de Configuracion
    '''            If ConfigCorte(I, 4) = "S" Then
    '''                VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                VENTAS(I, 2) = ConfigCorte(I, 2)
    '''                VENTAS(I, 3) = ConfigCorte(I, 3)
    '''                VENTAS(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = Valores(0)
    '''                                    VENTAS(I, 4) = "C"
    '''                                Case "Folio Inicial"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = Valores(1)
    '''                                    VENTAS(I, 4) = "F"
    '''                                Case "Folio Final"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = Valores(2)
    '''                                    VENTAS(I, 4) = "F" 'F = Identifica a los Folios
    '''                                Case "Ventas Contado Dolar"
    '''                                    '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Ventas(I, 1) = Ventas(I, 1) + Valores(3) + "  "
    '''                                    '''Ventas(I, 4) = "D"
    '''                                Case "Ventas Contado Pesos"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = VENTAS(I, 1) + Valores(4) + "  "
    '''                                    VENTAS(I, 4) = "D"
    '''                                Case "Ventas Credito Dolar"
    '''                                    '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Ventas(I, 1) = Ventas(I, 1) + Valores(5) + "  "
    '''                                    '''Ventas(I, 4) = "D"
    '''                                Case "Ventas Credito Pesos"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = VENTAS(I, 1) + Valores(6) + "  "
    '''                                    VENTAS(I, 4) = "D"
    '''                                Case "Total Dolar"
    '''                                    '''Ventas(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Ventas(I, 1) = Ventas(I, 1) + Valores(7) + "  "
    '''                                    '''Ventas(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    VENTAS(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    VENTAS(I, 1) = VENTAS(I, 1) + Valores(8) + "  "
    '''                                    VENTAS(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoVentas)
    '''            If VENTAS(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), VENTAS(I, 2)) + VENTAS(I, 0) + CStr(VENTAS(I, 1))
    '''            ElseIf VENTAS(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), VENTAS(I, 2)) + Right(Space(19) + VENTAS(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), VENTAS(I, 2)) + Right(Space(19) + VENTAS(I, 1), 19)
    '''            End If
    '''
    '''            If VENTAS(I, 3) > 0 Then
    '''                For J = 1 To VENTAS(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase VENTAS
    '''        Set recAux = Nothing
    '''    End If
    '''
    '''    ''IMPRESION DE LOS DATOS DE DEVOLUIONES
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, TotalProceso, CantidadArticulos, Condicion, " & _
    ''''                          "(SELECT     MAX(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'v')) AS FolioFinal, " & _
    ''''                          "(SELECT     MIN(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'v')) AS FolioInicial " & _
    ''''            "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'v') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto, TotalProceso"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            Valores(1) = Trim(recAux!FolioInicial)                    'FolioInicial
    '''            Valores(2) = Trim(recAux!FolioFinal)                      'Folio Final
    '''            If recAux!TipoMovto = "V" Then                             'Vales de Devolucion
    '''                Valores(3) = Valores(3) + CCur(Numerico(recAux!tOTALpROCESO))
    '''                Valores(4) = Valores(3) * TipoCambio
    '''            ElseIf recAux!TipoMovto = "N" Then                          'Notas de Crédito
    '''                Valores(5) = Valores(5) + CCur(Numerico(recAux!tOTALpROCESO))
    '''                Valores(6) = Valores(5) * TipoCambio
    '''            ElseIf recAux!TipoMovto = "E" Then                                                    'then Devolución de Efectivo
    '''                Valores(7) = Valores(7) + CCur(Numerico(recAux!tOTALpROCESO))
    '''                Valores(8) = Valores(7) * TipoCambio
    '''            Else
    '''                Valores(12) = Valores(12) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(13) = Valores(12) * TipoCambio
    '''            End If
    '''            Valores(11) = Valores(11) + recAux!CantidadArticulos
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        TotalPiezasDevueltas = Valores(11)
    '''        Valores(9) = Valores(3) + Valores(5) + Valores(7) + Valores(12)
    '''        TotalDevolD = Valores(9)
    '''        Valores(10) = Valores(4) + Valores(6) + Valores(8) + Valores(13)
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        Valores(5) = Format(Round(Valores(5), 2), gstrFormatoCantidad)
    '''        Valores(6) = Format(Round(Valores(6), 1), gstrFormatoCantidad)
    '''        Valores(7) = Format(Round(Valores(7), 2), gstrFormatoCantidad)
    '''        Valores(8) = Format(Round(Valores(8), 1), gstrFormatoCantidad)
    '''        Valores(9) = Format(Round(Valores(9), 2), gstrFormatoCantidad)
    '''        Valores(10) = Format(Round(Valores(10), 1), gstrFormatoCantidad)
    '''        Valores(12) = Format(Round(Valores(12), 2), gstrFormatoCantidad)
    '''        Valores(13) = Format(Round(Valores(13), 1), gstrFormatoCantidad)
    '''
    '''        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''        'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + 1) To (C_TamañoEncabezado + C_TamañoDevoluciones + C_TamañoDevoluciones) - 1
    '''            If ConfigCorte(I, 4) = "V" Then
    '''                Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Devoluciones(I, 2) = ConfigCorte(I, 2)
    '''                Devoluciones(I, 3) = ConfigCorte(I, 3)
    '''                Devoluciones(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Valores(0)
    '''                                    Devoluciones(I, 4) = "C"
    '''                                Case "Folio Inicial"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Valores(1)
    '''                                    Devoluciones(I, 4) = "F"
    '''                                Case "Folio Final"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Valores(2)
    '''                                    Devoluciones(I, 4) = "F" 'F = Identifica a los Folios
    '''                                Case "Vale Devol Dolar"
    '''                                    '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(3) + "  "
    '''                                    '''Devoluciones(I, 4) = "D"
    '''                                Case "Vale Devol Pesos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(4) + "  "
    '''                                    Devoluciones(I, 4) = "D"
    '''                                Case "Notas Credito Dolar"
    '''                                    '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(5) + "  "
    '''                                    '''Devoluciones(I, 4) = "D"
    '''                                Case "Notas Credito Pesos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(6) + "  "
    '''                                    Devoluciones(I, 4) = "D"
    '''                                Case "Devol Efectivo Dolar"
    '''                                    '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(7) + "  "
    '''                                    '''Devoluciones(I, 4) = "D"
    '''                                Case "Devol Efectivo Pesos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(8) + "  "
    '''                                    Devoluciones(I, 4) = "D"
    '''                                Case "Total Dolar"
    '''                                    '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(9) + "  "
    '''                                    '''Devoluciones(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(10) + "  "
    '''                                    Devoluciones(I, 4) = "D"
    '''                                Case "Devol Dolar"
    '''                                    '''Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(12) + "  "
    '''                                    '''Devoluciones(I, 4) = "D"
    '''                                Case "Devol Pesos"
    '''                                    Devoluciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Devoluciones(I, 1) = Devoluciones(I, 1) + Valores(13) + "  "
    '''                                    Devoluciones(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones)
    '''            If Devoluciones(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Devoluciones(I, 2)) + Devoluciones(I, 0) + CStr(Devoluciones(I, 1))
    '''            ElseIf Devoluciones(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Devoluciones(I, 2)) + Right(Space(19) + Devoluciones(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Devoluciones(I, 2)) + Right(Space(19) + Devoluciones(I, 1), 19)
    '''            End If
    '''
    '''            If Devoluciones(I, 3) > 0 Then
    '''                For J = 1 To Devoluciones(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Devoluciones
    '''        Set recAux = Nothing
    '''    End If
    '''
    '''    ''IMPRESION DE LOS DATOS DE APARTADOS
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, " & _
    ''''                          "(SELECT     MAX(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'A')) AS FolioFinal, " & _
    ''''                          "(SELECT     MIN(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'A')) AS FolioInicial " & _
    ''''            "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'A') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            Valores(1) = Trim(recAux!FolioInicial)                    'FolioInicial
    '''            Valores(2) = Trim(recAux!FolioFinal)                      'Folio Final                           'Vales de Devolucion
    '''            Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''            Valores(4) = Valores(3) * TipoCambio
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        TotalApartadosD = Valores(3)
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados)
    '''            If ConfigCorte(I, 4) = "A" Then
    '''                Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Apartados(I, 2) = ConfigCorte(I, 2)
    '''                Apartados(I, 3) = ConfigCorte(I, 3)
    '''                Apartados(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Apartados(I, 1) = Valores(0)
    '''                                    Apartados(I, 4) = "C"
    '''                                Case "Folio Inicial"
    '''                                    Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Apartados(I, 1) = Valores(1)
    '''                                    Apartados(I, 4) = "F"
    '''                                Case "Folio Final"
    '''                                    Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Apartados(I, 1) = Valores(2)
    '''                                    Apartados(I, 4) = "F" 'F = Identifica a los Folios
    '''                                Case "Total Dolar"
    '''                                    '''Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Apartados(I, 1) = Apartados(I, 1) + Valores(3) + "  "
    '''                                    '''Apartados(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Apartados(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Apartados(I, 1) = Apartados(I, 1) + Valores(4) + "  "
    '''                                    Apartados(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados)
    '''            If Apartados(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Apartados(I, 2)) + Apartados(I, 0) + CStr(Apartados(I, 1))
    '''            ElseIf Apartados(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Apartados(I, 2)) + Right(Space(19) + Apartados(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Apartados(I, 2)) + Right(Space(19) + Apartados(I, 1), 19)
    '''            End If
    '''
    '''            If Apartados(I, 3) > 0 Then
    '''                For J = 1 To Apartados(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Apartados
    '''        Set recAux = Nothing
    '''    End If
    '''
    '''    ''IMPRESION DE LOS DATOS DE REPARACIONES
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, " & _
    ''''                          "(SELECT     MAX(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'R')) AS FolioFinal, " & _
    ''''                          "(SELECT     MIN(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'R')) AS FolioInicial " & _
    ''''            "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'R') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            Valores(1) = Trim(recAux!FolioInicial)                    'FolioInicial
    '''            Valores(2) = Trim(recAux!FolioFinal)                      'Folio Final                           'Vales de Devolucion
    '''            Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''            Valores(4) = Valores(3) * TipoCambio
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        TotalReparacionesD = Valores(3)
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoReparaciones + C_TamañoApartados)
    '''            If ConfigCorte(I, 4) = "R" Then
    '''                Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Reparaciones(I, 2) = ConfigCorte(I, 2)
    '''                Reparaciones(I, 3) = ConfigCorte(I, 3)
    '''                Reparaciones(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Reparaciones(I, 1) = Valores(0)
    '''                                    Reparaciones(I, 4) = "C"
    '''                                Case "Folio Inicial"
    '''                                    Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Reparaciones(I, 1) = Valores(1)
    '''                                    Reparaciones(I, 4) = "F"
    '''                                Case "Folio Final"
    '''                                    Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Reparaciones(I, 1) = Valores(2)
    '''                                    Reparaciones(I, 4) = "F" 'F = Identifica a los Folios
    '''                                Case "Total Dolar"
    '''                                    '''Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Reparaciones(I, 1) = Reparaciones(I, 1) + Valores(3) + "  "
    '''                                    '''Reparaciones(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Reparaciones(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Reparaciones(I, 1) = Reparaciones(I, 1) + Valores(4) + "  "
    '''                                    Reparaciones(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoReparaciones + C_TamañoApartados)
    '''            If Reparaciones(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Reparaciones(I, 2)) + Reparaciones(I, 0) + CStr(Reparaciones(I, 1))
    '''            ElseIf Reparaciones(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Reparaciones(I, 2)) + Right(Space(19) + Reparaciones(I, 1), 19)
    '''            ElseIf Reparaciones(I, 4) = "F" Then
    '''                Linea = Left(Linea + Space(COLS), Reparaciones(I, 2)) + Right(Space(19) + Reparaciones(I, 1), 19)
    '''            Else
    '''                Linea = Linea
    '''            End If
    '''
    '''            If Reparaciones(I, 3) > 0 Then
    '''                For J = 1 To Reparaciones(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Reparaciones
    '''        Set recAux = Nothing
    '''    End If
    '''
    '''    'IMPRESION DE LOS DATOS DE RETIROS
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, CantidadArticulos, Condicion, " & _
    ''''                          "(SELECT     MAX(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'T')) AS FolioFinal, " & _
    ''''                          "(SELECT     MIN(FolioMovto) " & _
    ''''                            "FROM           dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''                            "WHERE      (Movimiento = 'T')) AS FolioInicial " & _
    ''''            "FROM          dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "'," & CodSucursal & ", " & CodCaja & ")   CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'T') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, CantidadArticulos, Condicion, TipoMovto"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            Valores(1) = Trim(recAux!FolioInicial)                    'FolioInicial
    '''            Valores(2) = Trim(recAux!FolioFinal)                      'Folio Final
    '''            If recAux!TipoMovto = "T" Then                             'Vales de Devolucion
    '''                Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(4) = Valores(3) * TipoCambio
    '''            ElseIf recAux!TipoMovto = "D" Then                          'Notas de Crédito
    '''                Valores(5) = Valores(5) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(6) = Valores(5) * TipoCambio
    '''            Else                                                        'Devolución de Efectivo
    '''                Valores(7) = Valores(7) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(8) = Valores(7) * TipoCambio
    '''            End If
    '''
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        Valores(9) = Valores(3) + Valores(5) + Valores(7)
    '''        TotalRetirosD = Valores(9)
    '''        Valores(10) = Valores(4) + Valores(6) + Valores(8)
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        Valores(5) = Format(Round(Valores(5), 2), gstrFormatoCantidad)
    '''        Valores(6) = Format(Round(Valores(6), 1), gstrFormatoCantidad)
    '''        Valores(7) = Format(Round(Valores(7), 2), gstrFormatoCantidad)
    '''        Valores(8) = Format(Round(Valores(8), 1), gstrFormatoCantidad)
    '''        Valores(9) = Format(Round(Valores(9), 2), gstrFormatoCantidad)
    '''        Valores(10) = Format(Round(Valores(10), 1), gstrFormatoCantidad)
    '''
    '''        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''        'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros)
    '''            If ConfigCorte(I, 4) = "T" Then
    '''                Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Retiros(I, 2) = ConfigCorte(I, 2)
    '''                Retiros(I, 3) = ConfigCorte(I, 3)
    '''                Retiros(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Valores(0)
    '''                                    Retiros(I, 4) = "C"
    '''                                Case "Folio Inicial"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Valores(1)
    '''                                    Retiros(I, 4) = "F"
    '''                                Case "Folio Final"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Valores(2)
    '''                                    Retiros(I, 4) = "F" 'F = Identifica a los Folios
    '''                                Case "Retiro Terceros Dolar"
    '''                                    '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Retiros(I, 1) = Retiros(I, 1) + Valores(3) + "  "
    '''                                    '''Retiros(I, 4) = "D"
    '''                                Case "Retiro Terceros Pesos"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Retiros(I, 1) + Valores(4) + "  "
    '''                                    Retiros(I, 4) = "D"
    '''                                Case "Retiro Deposito Dolar"
    '''                                    '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Retiros(I, 1) = Retiros(I, 1) + Valores(5) + "  "
    '''                                    '''Retiros(I, 4) = "D"
    '''                                Case "Retiro Deposito Pesos"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Retiros(I, 1) + Valores(6) + "  "
    '''                                    Retiros(I, 4) = "D"
    '''                                Case "Retiro Envio Caja Dolar"
    '''                                    '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Retiros(I, 1) = Retiros(I, 1) + Valores(7) + "  "
    '''                                    '''Retiros(I, 4) = "D"
    '''                                Case "Retiro Envio Caja Pesos"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Retiros(I, 1) + Valores(8) + "  "
    '''                                    Retiros(I, 4) = "D"
    '''                                Case "Total Dolar"
    '''                                    '''Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Retiros(I, 1) = Retiros(I, 1) + Valores(9) + "  "
    '''                                    '''Retiros(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Retiros(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Retiros(I, 1) = Retiros(I, 1) + Valores(10) + "  "
    '''                                    Retiros(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1)
    '''            If Retiros(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Retiros(I, 2)) + Retiros(I, 0) + CStr(Retiros(I, 1))
    '''            ElseIf Retiros(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Retiros(I, 2)) + Right(Space(19) + Retiros(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Retiros(I, 2)) + Right(Space(19) + Retiros(I, 1), 19)
    '''            End If
    '''
    '''            If Retiros(I, 3) > 0 Then
    '''                For J = 1 To Retiros(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Retiros
    '''        Set recAux = Nothing
    '''    End If
    '''    ''IMPRESION DE LOS DATOS DE ABONOS A DOCUMENTOS
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto, TOTALpROCESO " & _
    ''''            "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & " , " & CodCaja & " ) CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'G') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, TipoMovto, TOTALpROCESO"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            If recAux!TipoMovto = "V" Then                             'Ventas de Crédito
    '''                Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(4) = Valores(3) * TipoCambio
    '''            ElseIf recAux!TipoMovto = "A" Then                          'Apartados
    '''                Valores(5) = Valores(5) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(6) = Valores(5) * TipoCambio
    '''            Else                                                        'Reparaciones
    '''                Valores(7) = Valores(7) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(8) = Valores(7) * TipoCambio
    '''            End If
    '''
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        Valores(9) = Valores(3) + Valores(5) + Valores(7)           'Total Dolares
    '''        TotalAbonosD = Valores(9)
    '''        Valores(10) = Valores(4) + Valores(6) + Valores(8)          'Total Pesos
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        Valores(5) = Format(Round(Valores(5), 2), gstrFormatoCantidad)
    '''        Valores(6) = Format(Round(Valores(6), 1), gstrFormatoCantidad)
    '''        Valores(7) = Format(Round(Valores(7), 2), gstrFormatoCantidad)
    '''        Valores(8) = Format(Round(Valores(8), 1), gstrFormatoCantidad)
    '''        Valores(9) = Format(Round(Valores(9), 2), gstrFormatoCantidad)
    '''        Valores(10) = Format(Round(Valores(10), 1), gstrFormatoCantidad)
    '''
    '''        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''        'y se le Asigna el Valor obtenido en la consulta para los Abonos
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + C_TamañoAbonos)
    '''            If ConfigCorte(I, 4) = "G" Then
    '''                Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Abonos(I, 2) = ConfigCorte(I, 2)
    '''                Abonos(I, 3) = ConfigCorte(I, 3)
    '''                Abonos(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Abonos(I, 1) = Valores(0)
    '''                                    Abonos(I, 4) = "C"
    '''                                Case "Abono Ventas Dolar"
    '''                                    '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Abonos(I, 1) = Abonos(I, 1) + Valores(3) + "  "
    '''                                    '''Abonos(I, 4) = "D"
    '''                                Case "Abono Ventas Pesos"
    '''                                    Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Abonos(I, 1) = Abonos(I, 1) + Valores(4) + "  "
    '''                                    Abonos(I, 4) = "D"
    '''                                Case "Abono Reparaciones Dolar"
    '''                                    '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Abonos(I, 1) = Abonos(I, 1) + Valores(7) + "  "
    '''                                    '''Abonos(I, 4) = "D"
    '''                                Case "Abono Reparaciones Pesos"
    '''                                    Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Abonos(I, 1) = Abonos(I, 1) + Valores(8) + "  "
    '''                                    Abonos(I, 4) = "D"
    '''                                Case "Abono Apartados Dolar"
    '''                                    '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Abonos(I, 1) = Abonos(I, 1) + Valores(5) + "  "
    '''                                    '''Abonos(I, 4) = "D"
    '''                                Case "Abono Apartados Pesos"
    '''                                    Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Abonos(I, 1) = Abonos(I, 1) + Valores(6) + "  "
    '''                                    Abonos(I, 4) = "D"
    '''                                Case "Total Dolar"
    '''                                    '''Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Abonos(I, 1) = Abonos(I, 1) + Valores(9) + "  "
    '''                                    '''Abonos(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Abonos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Abonos(I, 1) = Abonos(I, 1) + Valores(10) + "  "
    '''                                    Abonos(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoRetiros + C_TamañoAbonos)
    '''            If Abonos(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Abonos(I, 2)) + Abonos(I, 0) + CStr(Abonos(I, 1))
    '''            ElseIf Abonos(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Abonos(I, 2)) + Right(Space(19) + Abonos(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Abonos(I, 2)) + Right(Space(19) + Abonos(I, 1), 19)
    '''            End If
    '''
    '''            If Abonos(I, 3) > 0 Then
    '''                For J = 1 To Abonos(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Abonos
    '''    End If
    '''
    '''    ''IMPRESION DE LOS DATOS DE ANTICIPOS
    '''
    '''    'Obtener los valores para la formula, para la impresión de los Datos de las Devoluciones
    '''
    '''    gStrSql = " SELECT DISTINCT FolioMovto AS FolioMovto, TipoMovto, TotalMovto " & _
    ''''            "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & " , " & CodCaja & " ) CorteFinalCaja " & _
    ''''            "WHERE     (Movimiento = 'N') " & _
    ''''            "GROUP BY FolioMovto, TotalMovto, TipoMovto"
    '''
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set recAux = Cmd.Execute
    '''
    '''    For I = 0 To 20
    '''        Valores(I) = 0
    '''    Next
    '''    If recAux.RecordCount > 0 Then
    '''        recAux.MoveFirst
    '''        For H = 1 To recAux.RecordCount
    '''            Valores(0) = CInt(Valores(0)) + 1         'Total de Movimientos
    '''            If recAux!TipoMovto = "V" Then                             'Ventas de Crédito
    '''                Valores(3) = Valores(3) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(4) = Valores(3) * TipoCambio
    '''            ElseIf recAux!TipoMovto = "A" Then                          'Apartados
    '''                Valores(5) = Valores(5) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(6) = Valores(5) * TipoCambio
    '''            Else                                                        'Reparaciones
    '''                Valores(7) = Valores(7) + CCur(Numerico(recAux!TotalMovto))
    '''                Valores(8) = Valores(7) * TipoCambio
    '''            End If
    '''
    '''            recAux.MoveNext
    '''        Next H
    '''        'Redondear los Importe y Formatearlos
    '''        Valores(9) = Valores(3) + Valores(5) + Valores(7)           'Total Dolares
    '''        TotalAntciposD = Valores(9)
    '''        Valores(10) = Valores(4) + Valores(6) + Valores(8)          'Total Pesos
    '''        Valores(3) = Format(Round(Valores(3), 2), gstrFormatoCantidad)
    '''        Valores(4) = Format(Round(Valores(4), 1), gstrFormatoCantidad)
    '''        Valores(5) = Format(Round(Valores(5), 2), gstrFormatoCantidad)
    '''        Valores(6) = Format(Round(Valores(6), 1), gstrFormatoCantidad)
    '''        Valores(7) = Format(Round(Valores(7), 2), gstrFormatoCantidad)
    '''        Valores(8) = Format(Round(Valores(8), 1), gstrFormatoCantidad)
    '''        Valores(9) = Format(Round(Valores(9), 2), gstrFormatoCantidad)
    '''        Valores(10) = Format(Round(Valores(10), 1), gstrFormatoCantidad)
    '''
    '''        'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''        'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos)
    '''            If ConfigCorte(I, 4) = "N" Then
    '''                Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                Anticipos(I, 2) = ConfigCorte(I, 2)
    '''                Anticipos(I, 3) = ConfigCorte(I, 3)
    '''                Anticipos(I, 4) = "C"
    '''                If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                    PALABRA = ""
    '''                    For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                        FinPal = False
    '''                        If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                            PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                        ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                            FinPal = True
    '''                            Select Case PALABRA
    '''                                Case "Total Movimientos"
    '''                                    Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Anticipos(I, 1) = Valores(0)
    '''                                    Anticipos(I, 4) = "C"
    '''                                Case "Anticipo Ventas Dolar"
    '''                                    '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(3) + "  "
    '''                                    '''Anticipos(I, 4) = "D"
    '''                                Case "Anticipo Ventas Pesos"
    '''                                    Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Anticipos(I, 1) = Anticipos(I, 1) + Valores(4) + "  "
    '''                                    Anticipos(I, 4) = "D"
    '''                                Case "Anticipo Reparaciones Dolar"
    '''                                    '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(7) + "  "
    '''                                    '''Anticipos(I, 4) = "D"
    '''                                Case "Anticipo Reparaciones Pesos"
    '''                                    Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Anticipos(I, 1) = Anticipos(I, 1) + Valores(8) + "  "
    '''                                    Anticipos(I, 4) = "D"
    '''                                Case "Anticipo Apartados Dolar"
    '''                                    '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(5) + "  "
    '''                                    '''Anticipos(I, 4) = "D"
    '''                                Case "Anticipo Apartados Pesos"
    '''                                    Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Anticipos(I, 1) = Anticipos(I, 1) + Valores(6) + "  "
    '''                                    Anticipos(I, 4) = "D"
    '''                                Case "Total Dolar"
    '''                                    '''Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    '''Anticipos(I, 1) = Anticipos(I, 1) + Valores(9) + "  "
    '''                                    '''Anticipos(I, 4) = "D"
    '''                                Case "Total Pesos"
    '''                                    Anticipos(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                    Anticipos(I, 1) = Anticipos(I, 1) + Valores(10) + "  "
    '''                                    Anticipos(I, 4) = "D"
    '''                            End Select
    '''                            PALABRA = ""
    '''                            J = J + 1
    '''                        End If
    '''                    Next J
    '''                End If
    '''            End If
    '''        Next I
    '''        For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos)
    '''            If Anticipos(I, 4) = "C" Then
    '''                Linea = Left(Linea + Space(COLS), Anticipos(I, 2)) + Anticipos(I, 0) + CStr(Anticipos(I, 1))
    '''            ElseIf Anticipos(I, 4) = "D" Then
    '''                Linea = Left(Linea + Space(COLS), Anticipos(I, 2)) + Right(Space(19) + Anticipos(I, 1), 19)
    '''            Else
    '''                Linea = Left(Linea + Space(COLS), Anticipos(I, 2)) + Right(Space(19) + Anticipos(I, 1), 19)
    '''            End If
    '''
    '''            If Anticipos(I, 3) > 0 Then
    '''                For J = 1 To Anticipos(I, 3)
    '''                    Print #1, Left(RTrim(Linea), COLS)
    '''                    Linea = ""
    '''                Next J
    '''            End If
    '''        Next I
    '''        Erase Anticipos
    '''    End If
    '''End If
    ''''Esta Parte de Totales, siempre se Imprime, para los Dos Tipo de COrte
    '''      ''IMPRESION DE LOS TOTALES
    '''    Valores(0) = TotalVentasD - TotalDevolD + TotalApartadosD + TotalReparacionesD - TotalRetirosD + TotalAbonosD + TotalAntciposD
    '''    Valores(1) = Valores(0) * TipoCambio
    '''    Valores(0) = Format(Round(Valores(0), 2), gstrFormatoCantidad)
    '''    Valores(1) = Format(Round(Valores(1), 1), gstrFormatoCantidad)
    '''    Valores(2) = TotalPiezasVendidas
    '''    Valores(3) = TotalPiezasDevueltas
    '''    Valores(4) = ""     'para las formas de Pago
    '''    'Se recorre el Vector de configuración del Corte, para Saber donde debe ir cada Dato.
    '''    'y se le Asigna el Valor obtenido en la consulta para las Devoluciones
    '''    For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoTotales + C_TamañoAnticipos)
    '''        If ConfigCorte(I, 4) = "T" Then
    '''            Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''            Totales(I, 2) = ConfigCorte(I, 2)
    '''            Totales(I, 3) = ConfigCorte(I, 3)
    '''            Totales(I, 4) = "C"
    '''            If Trim(ConfigCorte(I, 1)) <> "" Then
    '''                PALABRA = ""
    '''                For J = 1 To Len(Trim(ConfigCorte(I, 1)) + " ")
    '''                    FinPal = False
    '''                    If Mid(Trim(ConfigCorte(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigCorte(I, 1)), J, 1) <> "*" Then
    '''                        PALABRA = PALABRA + Mid(Trim(ConfigCorte(I, 1)), J, 1)
    '''                    ElseIf Mid(Trim(ConfigCorte(I, 1)), J, 1) = ")" Then
    '''                        FinPal = True
    '''                        Select Case PALABRA
    '''                            Case "Total Dia Pesos"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + Valores(1) + "  "
    '''                                Totales(I, 4) = "D"
    '''                            Case "Total Dia Dolar"
    '''                                '''Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                '''Totales(I, 1) = Totales(I, 1) + Valores(0) + "  "
    '''                                '''Totales(I, 4) = "D"
    '''                            Case "Piezas Vendidas"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + "   " + CStr(Valores(2)) + "   "
    '''                                Totales(I, 4) = "P"     'IDENTIFICA LAS PIEZAS (vENDIDAS O DEVUELTAS)
    '''                            Case "Piezas Devueltas"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + "   " + CStr(Valores(3)) + "  "
    '''                                Totales(I, 4) = "P"     'IDENTIFICA LAS PIEZAS (vENDIDAS O DEVUELTAS)
    '''                            Case "Linea Separa"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + String(60, "-")
    '''                                Totales(I, 4) = "C"
    '''                            Case "Formas de Pago"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + Valores(4)
    '''                                Totales(I, 4) = "FORMASPAGO"
    '''                            Case "Total Documentos"
    '''                                Totales(I, 0) = Trim(ConfigCorte(I, 0))
    '''                                Totales(I, 1) = Totales(I, 1) + TotalDocumentos
    '''                                Totales(I, 4) = "D"
    '''                        End Select
    '''                        PALABRA = ""
    '''                        J = J + 1
    '''                    End If
    '''                Next J
    '''            End If
    '''        End If
    '''    Next I
    '''    For I = (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoAnticipos + 1) To (C_TamañoEncabezado + C_TamañoVentas + C_TamañoDevoluciones + C_TamañoApartados + C_TamañoReparaciones + C_TamañoAbonos + C_TamañoRetiros + C_TamañoTotales + C_TamañoAnticipos)
    '''        If Totales(I, 4) = "FORMASPAGO" Then
    '''            ImprimirFP FechaCorte, CodSucursal, CodCaja, TipoCorte, Reimpresion, CCur(TipoCambio), COLS
    '''        ElseIf Totales(I, 4) = "C" Then
    '''            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Totales(I, 0) + CStr(Totales(I, 1))
    '''        ElseIf Totales(I, 4) = "D" Then
    '''            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Right(Space(19) + Totales(I, 1), 19)
    '''        ElseIf (Totales(I, 4) = "P" And TipoCorte = "F") Then
    '''            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Left(Totales(I, 0) + Space(16), 16) + Space(5) + Right(Space(4) & Trim(CStr(Totales(I, 1))), 4)
    '''        Else
    '''            Linea = Left(Linea + Space(COLS), Totales(I, 2)) + Right(Space(19) + Totales(I, 1), 19)
    '''        End If
    '''        If Totales(I, 3) > 0 Then
    '''            For J = 1 To Totales(I, 3)
    '''                Print #1, Left(RTrim(Linea), COLS)
    '''                Linea = ""
    '''            Next J
    '''        End If
    '''    Next I
    '''    Erase Totales
    '''
    '''    For I = 1 To 5
    '''        Print #1, ""
    '''    Next I
    '''    '''Cortar Papel
    '''    Print #1, Chr(27) + Chr(105)
    '''    Close #1
    '''    '''OJO
    '''    '''x = Shell("C:\WINNT\NOTEPAD.EXE C:\SISTEMA\FILETICKET.TXT", vbNormalFocus)
    '''
    '''Errores:
    '''    If Err.Number = 55 Then
    '''        Close #1
    '''        Err.Clear
    '''        GoTo Continuar
    '''    End If
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''End Sub
    '''

    '''Sub ImprimirFP_original(FechaCorte As Date, CodSucursal As Integer, CodCaja As Integer, TipoCorte As String, Reimpresion As Boolean, TipoCambio As Currency, COLS As Byte)
    '''On Local Error GoTo Merr
    '''     'Imprimir el Contenido de las Formas de PAgo.
    '''                Dim FPIngresosD As Currency
    '''                Dim FPIngresosP As Currency
    '''                Dim FPDevolucionesEfectivo As Currency
    '''                Dim FPDevolucionesDolar As Currency
    '''                Dim FPREtirosD As Currency
    '''                Dim FPREtirosP As Currency
    '''                Dim TotalSistema As Currency
    '''                Dim TotalCajero As Currency
    '''                Dim TotalDif As Currency
    '''                Dim SubTotalSistema As Currency
    '''                Dim SubTotalCajero As Currency
    '''                Dim SubTotalDif As Currency
    '''
    '''                Dim D As Byte
    '''                Dim rsFP As Recordset
    '''                Dim ImporteFPUsuario As Currency            'Importe de la Forma de Pago ACtual, Proporcionado por el usuario-.
    '''                Dim RsAux As Recordset
    '''                Dim CodFP As Integer
    '''                Dim DescFP As String
    '''                Dim EsDolar As Boolean
    '''                Dim Escheque As Boolean
    '''                Dim EsDevolucion As Boolean
    '''                Dim EsTarjeta As Boolean
    '''                Dim EsDocumentoIntreno As Boolean
    '''                Dim EncabezadoEfectivo As Boolean 'Indica si ya se ha impreso el encabezado del TOtal de Efectivo
    '''                Dim PosInicioDolar As Integer
    '''                Dim PosInicioSistema As Integer
    '''                Dim PosInicioCajero As Integer
    '''                Dim PosInicioDif As Integer
    '''                Dim FPCambiosEfectivo As Currency
    '''                Dim FPCambiosDolar As Currency
    '''                Dim Linea As String
    '''
    '''                PosInicioDolar = 11
    '''                PosInicioSistema = 22
    '''                PosInicioCajero = 33
    '''                PosInicioDif = 44
    '''
    '''                gStrSql = "SELECT     CodFormaPago, DescFormaPago, EsDolar, EsCheque, EsDevolucion, EsDocumentoInterno, EsTarjeta " & _
    ''''                          "From dbo.CatFormasPago"
    '''                ModEstandar.BorraCmd
    '''                Cmd.CommandText = "dbo.Up_Select_Datos"
    '''                Cmd.CommandType = adCmdStoredProc
    '''                Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''                Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''                Set rsFP = Cmd.Execute
    '''
    '''                If rsFP.RecordCount > 0 Then
    '''                   Linea = Left(Space(20) + "FORMAS DE PAGO" + Space(COLS), COLS)
    '''                   Print #1, Left(RTrim(Linea), COLS)
    '''                   Linea = Left(Space(20) + String(COLS, "-"), COLS)
    '''                   Print #1, Left(RTrim(Linea), COLS)
    '''                End If
    '''
    '''                Print #1, "     DOCTOS              LOGICO       FISICO       DIF"
    '''                Print #1, ""
    '''                FPCambiosEfectivo = Round(ImporteCambioEfectivo(FechaCorte, CodSucursal, CodCaja) * TipoCambio, 1)
    '''                FPCambiosDolar = Round(ImporteCambioDolar(FechaCorte, CodSucursal, CodCaja), 2)
    '''
    '''                While Not rsFP.EOF
    '''                    CodFP = rsFP!CodFormaPago
    '''                    DescFP = rsFP!DescFormaPago
    '''                    EsDolar = rsFP!EsDolar
    '''                    Escheque = rsFP!Escheque
    '''                    EsDevolucion = rsFP!EsDevolucion
    '''                    EsDocumentoIntreno = rsFP!EsDocumentoInterno
    '''                    EsTarjeta = rsFP!EsTarjeta
    '''                    gStrSql = "SELECT     CodFormaPago, DescFormaPago, SUM(ImporteFP) AS ImporteFP, EsDolar, TipoProceso, " & _
    ''''                                    "isnull((SELECT      SUM(TotalProceso) " & _
    ''''                                    "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & _
    ''''                                    "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & _
    ''''                                    "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivo, " & _
    ''''                                    "isnull((SELECT      SUM(TotalProceso) " & _
    ''''                                    "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & _
    ''''                                    "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & _
    ''''                                    "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolar " & _
    ''''                                "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & ") CorteFinalCaja " & _
    ''''                                "WHERE     (TipoProceso = 'I') AND (CodFormaPago = " & CodFP & ") " & _
    ''''                                "GROUP BY CodFormaPago, DescFormaPago, EsDolar, TipoProceso    UNION   " & _
    ''''                                "SELECT     ISNULL(CodFormaPago, 0) AS CodFormaPago, ISNULL(DescFormaPago, '') AS DescFormaPago, SUM(ISNULL(ImporteFP, 0)) AS ImporteFP, " & _
    ''''                                "ISNULL(EsDolar, 0) AS EsDolar, TipoProceso, " & _
    ''''                                    "isnull((SELECT      SUM(TotalProceso) " & _
    ''''                                    "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & _
    ''''                                    "GROUP BY Movimiento, TipoMovto, TipoProceso, Esdolar " & _
    ''''                                    "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 0 )),0) as DevolEfectivo, " & _
    ''''                                    "isnull((SELECT      SUM(TotalProceso) " & _
    ''''                                    "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & " ) CF " & _
    ''''                                    "GROUP BY Movimiento, TipoMovto, TipoProceso , Esdolar " & _
    ''''                                    "HAVING      (Movimiento = 'V') AND (TipoMovto = 'E')AND (Esdolar= 1 )),0) as DevolDolar " & _
    ''''                                    "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "  , " & CodCaja & ") CF " & _
    ''''                                "WHERE     (TipoProceso = 'E') AND (CodFormaPago= " & CodFP & ") " & _
    ''''                                "GROUP BY CodFormaPago, DescFormaPago, EsDolar, TipoProceso"
    '''                    ModEstandar.BorraCmd
    '''                    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''                    Cmd.CommandType = adCmdStoredProc
    '''                    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''                    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''                    Set RsAux = Cmd.Execute
    '''
    '''                    'Con este Función se Obtiene el Importe que el usuario Proporcionó (como importe Fisico) para la Forma de
    '''                    If TipoCorte = "F" And Reimpresion = False Then
    '''                       MsgBox "frmCorteFinalDia.ObtnerImporteUsuarioFP(CodFP)"
    '''                        '''ImporteFPUsuario = frmCorteFinalDia.ObtnerImporteUsuarioFP(CodFP)
    '''                    ElseIf TipoCorte = "A" Then
    '''                       MsgBox "frmCorteAuditoria.ObtnerImporteUsuarioFP(CodFP)"
    '''                        '''ImporteFPUsuario = frmCorteAuditoria.ObtnerImporteUsuarioFP(CodFP)
    '''                    End If
    '''                    If EsDolar = True Then
    '''                        ImporteFPUsuario = ImporteFPUsuario * TipoCambio
    '''                        ImporteFPUsuario = Format(Round(ImporteFPUsuario, 1), gstrFormatoCantidad)
    '''                    End If
    '''                    'Clasificar el Importe en Ingresos y Egresos o Retiros
    '''                    While Not RsAux.EOF
    '''
    '''                     FPDevolucionesEfectivo = Format(Round(RsAux!DevolEfectivo * TipoCambio, 1), gstrFormatoCantidad)
    '''                     FPDevolucionesDolar = RsAux!Devoldolar
    '''
    '''                        If RsAux!TipoProceso = "I" Then
    '''                            FPIngresosD = RsAux!ImporteFP
    '''                            If EsDolar = True Then
    '''                                FPIngresosP = FPIngresosD * TipoCambio
    '''                            Else
    '''                                FPIngresosP = FPIngresosD
    '''                            End If
    '''                            FPIngresosD = Format(Round(FPIngresosD, 2), gstrFormatoCantidad)
    '''                            FPIngresosP = Format(Round(FPIngresosP, 1), gstrFormatoCantidad)
    '''                        ElseIf RsAux!TipoProceso = "E" Then
    '''                            FPREtirosD = RsAux!ImporteFP
    '''                            If EsDolar = True Then
    '''                                FPREtirosP = FPREtirosD * TipoCambio
    '''                            Else
    '''                                FPREtirosP = FPREtirosD
    '''                            End If
    '''                            FPREtirosD = Format(Round(FPREtirosD, 2), gstrFormatoCantidad)
    '''                            FPREtirosP = Format(Round(FPREtirosP, 1), gstrFormatoCantidad)
    '''                        End If
    '''                        RsAux.MoveNext
    '''                    Wend
    '''
    '''                    If FPIngresosD > 0 Or FPREtirosD > 0 Or ImporteFPUsuario > 0 Then
    '''                        If EsDolar = False And Escheque = False And EsDevolucion = False And EsDocumentoIntreno = False And EsTarjeta = False Then
    '''                            'Se trata de Efectivo
    '''                            SubTotalSistema = FPIngresosP - FPREtirosP - FPCambiosEfectivo - FPDevolucionesEfectivo
    '''                            SubTotalCajero = ImporteFPUsuario
    '''                            'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
    '''                            'Por Tanto, el Importe de Diferencia debe ser 0 También
    '''                            If Reimpresion = True Then
    '''                                SubTotalDif = 0
    '''                            Else
    '''                                SubTotalDif = SubTotalCajero - SubTotalSistema
    '''                            End If
    '''                            TotalSistema = TotalSistema + SubTotalSistema
    '''                            TotalCajero = TotalCajero + SubTotalCajero
    '''                            TotalDif = TotalDif + SubTotalDif
    '''
    '''                            Print #1, " " + CStr(CodFP) + ") " + UCase(DescFP)
    '''                            Print #1, ""
    '''                            Print #1, " " + Left("(+)Ingresos" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left("(-)Retiros" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left("(-)Devoluciones" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPDevolucionesEfectivo, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left("(-)Cambios" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosEfectivo, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + String(10, "-") + Space(COLS), PosInicioCajero) + String(10, "-") + Space(COLS), PosInicioDif) + String(11, "-")
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(SubTotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(SubTotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(SubTotalDif, gstrFormatoCantidad), 11)
    '''                            Print #1, " "
    '''
    '''                        ElseIf EsDolar = True And Escheque = False And EsDevolucion = False And EsDocumentoIntreno = False And EsTarjeta = False Then
    '''                            'Se trata de Forma PAgo Dólar
    '''                            SubTotalSistema = FPIngresosP - FPREtirosP - Round(FPDevolucionesDolar * TipoCambio, 1) - Round(FPCambiosDolar * TipoCambio, 2)
    '''                            SubTotalCajero = ImporteFPUsuario
    '''                            'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
    '''                            'Por Tanto, el Importe de Diferencia debe ser 0 También
    '''                            If Reimpresion = True Then
    '''                                SubTotalDif = 0
    '''                            Else
    '''                                SubTotalDif = SubTotalCajero - SubTotalSistema
    '''                            End If
    '''                            TotalSistema = TotalSistema + SubTotalSistema
    '''                            TotalCajero = TotalCajero + SubTotalCajero
    '''                            TotalDif = TotalDif + SubTotalDif
    '''                            Print #1, " " + CStr(CodFP) + ") " + UCase(DescFP)
    '''                            Print #1, ""
    '''
    '''                            Print #1, " " + Left(Left("(+)Ingresos" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPIngresosD, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left("(-)Egresos" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPREtirosD, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left("(-)Devoluciones" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPDevolucionesDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(Round(FPDevolucionesDolar * TipoCambio, 1), gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left("(-)Cambios" + Space(COLS), PosInicioDolar) + Right(Space(10) + Format(Round(FPCambiosDolar, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosDolar * TipoCambio, gstrFormatoCantidad)), 10)
    '''
    '''                            'Print #1, " " + Left("(-)Devoluciones" + Space(Cols), PosInicioSistema) + Right(Space(10) + CStr(Format(FPDevolucionesDolar, gstrFormatoCantidad)), 10)
    '''                            'Print #1, " " + Left("(-)Cambios" + Space(Cols), PosInicioSistema) + Right(Space(10) + CStr(Format(FPCambiosDolar, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + String(10, "-") + Space(COLS), PosInicioCajero) + String(10, "-") + Space(COLS), PosInicioDif) + String(11, "-")
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(Round(SubTotalSistema, 2), gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(SubTotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(SubTotalDif, gstrFormatoCantidad), 11)
    '''                            If EncabezadoEfectivo = False Then
    '''                                '''Print #1, " " & String(COLS - 1, "-")
    '''                                '''Print #1, ""
    '''                                '''Print #1, " " + Left(Left(Left("TOTAL EFECTIVO" + String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(TotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(TotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(TotalDif, gstrFormatoCantidad), 11)
    '''                                '''Print #1, ""
    '''                                EncabezadoEfectivo = True
    '''                            End If
    '''                            '''TotalSistema = 0
    '''                            '''TotalCajero = 0
    '''                            '''TotalDif = 0
    '''                        Else
    '''                            'Se trata de el resto de las Formas de Pago
    '''                            SubTotalSistema = FPIngresosP - FPREtirosP
    '''                            SubTotalCajero = ImporteFPUsuario
    '''                            'Cuando es Reimpresión, en el Importe de CAjero es 0 porque el usuario no proporciona Importe,
    '''                            'Por Tanto, el Importe de Diferencia debe ser 0 También
    '''                            If Reimpresion = True Then
    '''                                SubTotalDif = 0
    '''                            Else
    '''                                SubTotalDif = SubTotalCajero - SubTotalSistema
    '''                            End If
    '''                            TotalSistema = TotalSistema + SubTotalSistema
    '''                            TotalCajero = TotalCajero + SubTotalCajero
    '''                            TotalDif = TotalDif + SubTotalDif
    '''                            Print #1, " " + CStr(CodFP) + ") " + UCase(DescFP)
    '''                            Print #1, ""
    '''                            Print #1, " " + Left("(+)Ingresos" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPIngresosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left("(-)Retiros" + Space(COLS), PosInicioSistema) + Right(Space(10) + CStr(Format(FPREtirosP, gstrFormatoCantidad)), 10)
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + String(10, "-") + Space(COLS), PosInicioCajero) + String(10, "-") + Space(COLS), PosInicioDif) + String(11, "-")
    '''                            Print #1, " " + Left(Left(Left(String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(SubTotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(SubTotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(SubTotalDif, gstrFormatoCantidad), 11)
    '''                            Print #1, " "
    '''                        End If
    '''                    End If
    '''                    rsFP.MoveNext
    '''                    FPIngresosD = 0
    '''                    FPIngresosP = 0
    '''                    FPREtirosD = 0
    '''                    FPREtirosP = 0
    '''                    SubTotalCajero = 0
    '''                    SubTotalDif = 0
    '''                    SubTotalSistema = 0
    '''                Wend
    '''
    '''                'Impresión de los Totales de Documentos
    '''                Print #1, String(COLS, "-")
    '''                Print #1, ""
    '''                Print #1, " " + Left(Left(Left("TOTAL " + String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(TotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(TotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(TotalDif, gstrFormatoCantidad), 11)
    '''                '''Print #1, " " + Left(Left(Left("TOTAL DOCUMENTOS" + String(COLS, " "), PosInicioSistema) + Right(Space(10) + Format(TotalSistema, gstrFormatoCantidad), 10) + Space(COLS), PosInicioCajero) + Right(Space(10) + Format(TotalCajero, gstrFormatoCantidad), 10) + Space(COLS), PosInicioDif) + Right(Space(11) + Format(TotalDif, gstrFormatoCantidad), 11)
    '''                Print #1, ""
    '''                Print #1, ""
    '''                Print #1, ""
    '''                EncabezadoEfectivo = True
    '''Merr:
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''End Sub

    '''Function ImporteCambioDolar(FechaCorte As Date, CodSucursal As Integer, CodCaja As Integer) As Currency
    '''On Local Error GoTo Merr
    '''    Dim RsCambio As Recordset
    '''    ImporteCambioDolar = 0
    '''
    '''    gStrSql = "SELECT     FolioMovto, CambioDol " & _
    ''''            "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "," & CodCaja & ") CorteFinalCaja " & _
    ''''            "GROUP BY FolioMovto, CambioDol " & _
    ''''            "Having (CambioDol > 0) "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsCambio = Cmd.Execute
    '''
    '''    While Not RsCambio.EOF
    '''        ImporteCambioDolar = ImporteCambioDolar + RsCambio!CambioDol
    '''        RsCambio.MoveNext
    '''    Wend
    '''    Exit Function
    '''Merr:
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''End Function
    '''
    '''Function ImporteCambioEfectivo(FechaCorte As Date, CodSucursal As Integer, CodCaja As Integer) As Currency
    '''On Local Error GoTo Merr
    '''    Dim RsCambio As Recordset
    '''    ImporteCambioEfectivo = 0
    '''
    '''    gStrSql = "SELECT     FolioMovto, Cambio " & _
    ''''            "FROM         dbo.CorteFinalCaja('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "," & CodCaja & ") CorteFinalCaja " & _
    ''''            "GROUP BY FolioMovto, Cambio " & _
    ''''            "Having (Cambio > 0) "
    '''    ModEstandar.BorraCmd
    '''    Cmd.CommandText = "dbo.Up_Select_Datos"
    '''    Cmd.CommandType = adCmdStoredProc
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Renglon", adInteger, adParamReturnValue)
    '''    Cmd.Parameters.Append Cmd.CreateParameter("Sentencia", adChar, adParamInput, 8000, gStrSql)
    '''    Set RsCambio = Cmd.Execute
    '''
    '''    While Not RsCambio.EOF
    '''        ImporteCambioEfectivo = ImporteCambioEfectivo + RsCambio!cambio
    '''        RsCambio.MoveNext
    '''    Wend
    '''    Exit Function
    '''Merr:
    '''    If Err.Number <> 0 Then ModEstandar.MostrarError
    '''End Function
    '''
    '''

    Function ImporteCambioDolar(ByRef FechaCorte As Date, ByRef CodSucursal As Integer, ByRef CodCaja As Integer) As Decimal
        On Error GoTo Merr
        Dim RsCambio As ADODB.Recordset
        ImporteCambioDolar = 0

        gStrSql = "SELECT     FolioMovto, CambioDol, TipoCambio " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "," & CodCaja & ") CorteFinalCaja " & "GROUP BY FolioMovto, CambioDol, TipoCambio " & "Having (CambioDol > 0) "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsCambio = Cmd.Execute

        While Not RsCambio.EOF
            ImporteCambioDolar = ImporteCambioDolar + RsCambio.Fields("CambioDol").Value
            mcurImporteCambioDolarP = mcurImporteCambioDolarP + (RsCambio.Fields("CambioDol").Value * RsCambio.Fields("TipoCambio").Value)
            RsCambio.MoveNext()
        End While
        Exit Function
Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Function ImporteCambioEfectivo(ByRef FechaCorte As Date, ByRef CodSucursal As Integer, ByRef CodCaja As Integer) As Decimal
        On Error GoTo Merr
        Dim RsCambio As ADODB.Recordset
        ImporteCambioEfectivo = 0

        gStrSql = "SELECT     FolioMovto, Cambio, TipoCambio " & "FROM         dbo.CorteFinalCaja ('" & Format(FechaCorte, C_FORMATFECHAGUARDAR) & "', " & CodSucursal & "," & CodCaja & ") CorteFinalCaja " & "GROUP BY FolioMovto, Cambio, TipoCambio " & "Having (Cambio > 0) "
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsCambio = Cmd.Execute

        While Not RsCambio.EOF
            ImporteCambioEfectivo = (ImporteCambioEfectivo + RsCambio.Fields("cambio").Value) * RsCambio.Fields("TipoCambio").Value
            RsCambio.MoveNext()
        End While
        Exit Function

Merr:
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Function

    Sub TicketValeImportePorAplicar(ByRef Folio As String, ByRef CodCaja As Integer, ByRef TipoDevolucion As String)
        On Error GoTo Errores
        'Folio : Contiene el Número de Folio sobre el cual se imprime el ticket
        'Caja  : Número de Caja, que imprime el Ticket
        Dim I As Integer
        Dim J As Integer
        Dim COLS As Byte 'Contiene el Número total de COlumnas que abarcará el Ticket
        Dim recAux As ADODB.Recordset
        Dim RENCABEZ As Integer
        Dim RDETALLE As Integer
        Dim RTOTALES As Integer
        Dim x As Object

        Dim Encabez(21, 4) As Object 'Arreglo que contiene los Datos del Encabezado del Ticket
        Dim Detalle(21, 4) As Object 'Arreglo que contiene los Datos del Detalle del Ticket
        Dim Totales(21, 4) As Object 'Arreglo que contiene los Datos de los Totales del Ticket
        Dim ConfigDevolucion(22, 5) As Object 'Arreglo que contiene los datos de  Configuración del Ticket de Apartado, Ya que no existe una tabla que tenga esta configuración.
        ' De esta forma, si se requiere cambiar la configuracion del ticket, se hace directamente aqui y no se cambiará el código de la impresión.

        Dim Valores(16) As Object 'Contiene los Valores de las Tablas que serán los Impresos en el Ticket

        Dim PALABRA As String
        Dim TipoPrecio As String
        Dim ImpteIVACtes As Double
        Dim TipoCambio As Double
        Dim DesgloceFormas As Boolean
        Dim RenIniDesg As Integer
        Dim ColIniDesg As Integer
        Dim FormatoCantidad As String 'Contiene el FOrmato para la catidad de Artículos, es Base al Parametro de Configuración GEneral del Pv, que Indica el número de Decimales a usar.
        Dim C_TamañoTotales As Integer
        Const C_TamañoEncabezado As Integer = 9
        Const C_TamañoDetalle As Integer = 4
        C_TamañoTotales = 6

        '***************************************************************
        ' ** Obtiene Valores para la Fórmula
        '***** ENCABEZADO *****'
        For I = 0 To 16
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(I) = ""
        Next I
        ''Llenar el Vector de COnfiguración del Tickect
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 2) = 56
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(0, 4) = "C"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 1) = "(Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(1, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(1, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 0) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 1) = "(Dirección Empresa)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(2, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(2, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 0) = "RFC:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 1) = "(RFC)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(3, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(3, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 0) = "***  VALE DE DEVOLUCION  ***"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 2) = -1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 3) = 3
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(4, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 0) = "FECHA: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 1) = "(Fecha)+(Hora)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(5, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(5, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 0) = "FOLIO: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 1) = "(Folio Devolucion)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 2) = 32
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(6, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(6, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 0) = "FOLIO VENTA: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 1) = "(Folio Venta)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(7, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(7, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 0) = "TIPO DE CAMBIO: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 1) = "(Tipo de Cambio)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 2) = 35
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(8, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(8, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 0) = "CLIENTE: "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 1) = "(Cliente)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 3) = 2
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(9, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(9, 4) = "E"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(10, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(10, 0) = "CANTIDAD"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(10, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(10, 1) = "(Cantidad)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(10, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(10, 2) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(10, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(10, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(10, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(10, 4) = "D"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 0) = "ARTICULO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 1) = "(Descripción)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 2) = 11
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(11, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(11, 4) = "D"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 0) = "PRECIO"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 1) = "(Precio Real)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 2) = 35
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 3) = 0
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(12, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(12, 4) = "D"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(13, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(13, 0) = "IMPORTE"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(13, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(13, 1) = "(Importe)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(13, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(13, 2) = 46
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(13, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(13, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(13, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(13, 4) = "D"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(14, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(14, 0) = "DEVOLUCION DE MERCANCIA:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(14, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(14, 1) = "(Total Devol)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(14, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(14, 2) = 21
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(14, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(14, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(14, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(14, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(15, 0) = "---------------------"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(15, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(15, 2) = 35
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(15, 3) = 3
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(15, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(16, 0) = "VALE POR:"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(16, 1) = "(Total Docto)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(16, 2) = 21
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(16, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(16, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(17, 0) = ""
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(17, 1) = "(Moneda)"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(17, 2) = 21
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(17, 3) = 3
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(17, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(18, 0) = "____________________"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(18, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(18, 2) = 20
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(18, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(18, 4) = "T"

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(19, 0) = "GERENTE"
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(19, 1) = " "
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(19, 2) = 26
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(19, 3) = 1
        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        ConfigDevolucion(19, 4) = "T"

        If TipoDevolucion = "E" Then

            'Devolución de Efectivo
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 0) = "***  DEVOLUCION DE EFECTIVO ***"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 2) = -1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 3) = 3
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 0) = "DEVOLUCION DE EFECTIVO:"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 1) = "(Total Docto)"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 2) = 21
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 0) = "CLIENTE"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 2) = 26
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 4) = "T"

        ElseIf TipoDevolucion = "D" Then

            'Devolución únicamente
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 0) = "***  DEVOLUCION DE MERCANCIA ***"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 2) = -1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 3) = 3
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(4, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(4, 4) = "E"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(15, 0) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(15, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(15, 2) = 35
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(15, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(15, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(15, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 0) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 1) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 2) = 21
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(16, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(16, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(17, 0) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(17, 1) = ""
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(17, 2) = 21
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(17, 3) = 3
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(17, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(17, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(18, 0) = "____________________"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(18, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(18, 2) = 5
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(18, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(18, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(18, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 0) = "____________________"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 2) = 35
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(19, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(19, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(20, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(20, 0) = "GERENTE"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(20, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(20, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(20, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(20, 2) = 11
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(20, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(20, 3) = 0
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(20, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(20, 4) = "T"

            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(21, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(21, 0) = "CLIENTE"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(21, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(21, 1) = " "
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(21, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(21, 2) = 41
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(21, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(21, 3) = 1
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(21, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ConfigDevolucion(21, 4) = "T"

            C_TamañoTotales = 8
        End If

        gStrSql = "SELECT     NombreEmp, DomicilioEmp, RFCEmp " & "From dbo.ConfiguracionGeneral GROUP BY NombreEmp, DomicilioEmp, RFCEmp"

        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Trim(RsGral.Fields("NombreEmp").Value) 'Nombre Empresa
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(1) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("DomicilioEmp").Value)) 'Direccion Empresa                                                     'Ciudad Sucursal
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = Trim(ModEstandar.QuitaEnter(RsGral.Fields("RFCEmp").Value)) 'RFC Empresa
        Else
            MsgBox("Favor de Checar Configuración del Punto de Venta", MsgBoxStyle.OkOnly + MsgBoxStyle.Exclamation, "Aviso")
            For I = 0 To 2
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(I). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(I) = RsGral.Fields(Val(CStr(I))).Value
            Next I
        End If

        '''Se elimino el codigo de caja porque no es util
        If TipoDevolucion = "V" Then
            gStrSql = "SELECT     TipoCambio, FolioDevolucion, FechaDevolucion, FolioVenta, Nombre, Titular, TipoDevol " & "From dbo.DevolucionesCab (Nolock) " & "WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'V') "
            '''"WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'V') and Codcaja= " & CodCaja
        ElseIf TipoDevolucion = "E" Then
            gStrSql = "SELECT     TipoCambio, FolioDevolucion, FechaDevolucion, FolioVenta, Nombre, Titular, TipoDevol " & "From dbo.DevolucionesCab (Nolock) " & "WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'E') "
            '''"WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'E') and Codcaja= " & CodCaja
        Else
            gStrSql = "SELECT     TipoCambio, FolioDevolucion, FechaDevolucion, FolioVenta, Nombre, Titular, TipoDevol " & "From dbo.DevolucionesCab (Nolock) " & "WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'D') "
            '''"WHERE     (FolioDevolucion = '" & Folio & "') AND (TipoDevol = 'D') and Codcaja= " & CodCaja
        End If
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(3) = Folio 'Folio Devoluvion
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(4) = Format(RsGral.Fields("FechaDevolucion").Value, "DD/MMM/YYYY") 'Fecha
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(5) = RsGral.Fields("FolioVenta").Value 'Folio de Venta
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(6) = Trim(RsGral.Fields("Titular").Value) 'Nombre de la Persona a quien se le Dará el Vale.
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(7) = Format(RsGral.Fields("TipoCambio").Value, gstrFormatoCantidad)
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(8) = Format(Now, "HH:MM")
        End If

        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(0, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
        COLS = ConfigDevolucion(0, 2)
        For I = 1 To C_TamañoEncabezado 'Tamaño del Vector de Configurqcion del Ticket
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigDevolucion(I, 4) <> "E" Then Exit For
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 0) = ConfigDevolucion(I, 0)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 2) = ConfigDevolucion(I, 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 3) = ConfigDevolucion(I, 3)
            'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Encabez(I, 4) = "S"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If ConfigDevolucion(I, 1) <> "" Then
                PALABRA = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Len(Trim(ConfigDevolucion(I, 1)))
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                        Select Case PALABRA
                            Case "Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(0) + "  "
                            Case "Dirección Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(1) + "  "
                            Case "Ciudad Empresa"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "RFC"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(2) + "  "
                            Case "Folio Devolucion"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(3) + "  "
                            Case "Fecha"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(4) + "  "
                            Case "Hora"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(8). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(8) + "  "
                            Case "Folio Venta"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(5). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(5) + "  "
                            Case "Cliente"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(6). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(6) + "  "
                            Case "Tipo de Cambio"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(7). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Encabez(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Encabez(I, 1) = Encabez(I, 1) + Valores(7) + "  "
                        End Select
                        PALABRA = ""
                    End If
                Next J
            End If
        Next I
Continuar:
        'Impresión de la primera parte del Ticket, Encabezado
        FileOpen(1, gstrTicketPrinter, OpenMode.Output)
        '''Open "C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT" For Output As #1   ' Abre un Archivo.
        Dim Linea As String
        PrintLine(1, Chr(27) & Chr(33) & Chr(1))
        For I = 1 To C_TamañoEncabezado
            If Encabez(I, 4) = "S" Then
                If CDbl(ConfigDevolucion(I, 2)) = -1 Then
                    Encabez(I, 2) = (COLS - Len(Encabez(I, 0) + Trim(Encabez(I, 1)))) \ 2
                    If Encabez(I, 2) < 0 Then Encabez(I, 2) = 0
                End If
                Linea = Left(Linea & Space(Encabez(I, 2)), Encabez(I, 2)) + Encabez(I, 0) + Encabez(I, 1)
                If Encabez(I, 3) > 0 Then
                    For J = 1 To Encabez(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            End If
        Next I

        'Obtener los valores para la formula, para la impresión del detalle del Ticket
        gStrSql = "SELECT     DD.FolioDevolucion, DD.CodArticulo, A.DescArticulo, DD.CantidadDevol, DD.PrecioReal as PrecioReal, " & "DD.PrecioReal * DD.CantidadDevol AS ImporteD " & "FROM         dbo.DevolucionesDet DD INNER JOIN " & "dbo.CatArticulos A ON DD.CodArticulo = A.CodArticulo INNER JOIN " & "dbo.DevolucionesCab DC ON DD.FolioDevolucion = DC.FolioDevolucion " & "WHERE     (DD.FolioDevolucion = '" & Folio & "')    AND (DC.CodCaja =" & CodCaja & ")"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        recAux = Cmd.Execute

        Dim SIMBOLO As String
        Dim Valor As Double
        Dim FinPal As Boolean 'Indica cuando es Fin de Palabra, para hacer los calculos correspondientes.
        Dim Encabezado As Boolean
        Dim H As Integer
        SIMBOLO = "+"
        Encabezado = True
        If Not recAux.EOF Then
            recAux.MoveFirst()
        End If
        For H = 1 To recAux.RecordCount
            Valores(0) = recAux.Fields("CodArticulo").Value
            Valores(1) = Trim(recAux.Fields("DescArticulo").Value)
            Valores(2) = recAux.Fields("CantidadDevol").Value
            Valores(3) = Format(System.Math.Round(recAux.Fields("PrecioReal").Value, 2), gstrFormatoCantidad) 'pRECIO Real
            Valores(4) = Format(System.Math.Round(recAux.Fields("ImporteD").Value, 2), gstrFormatoCantidad) 'Importe
            'RsGral.MoveFirst
            '        recAux.MoveFirst
            For I = 0 To 16
                Detalle(I, 0) = ""
                Detalle(I, 1) = ""
                Detalle(I, 2) = ""
                Detalle(I, 3) = ""
                Detalle(I, 4) = ""
            Next I

            'Se asgina un valor a cada formula de la configuración de ticket, para posteriormente realizar la impresión.
            For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle) '30. Tamaño del VEctro de Configuracion
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If ConfigDevolucion(I, 4) = "D" Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 0) = Right(Space(8) & Trim(ConfigDevolucion(I, 0)), 8)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 2) = ConfigDevolucion(I, 2)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Detalle(I, 3) = ConfigDevolucion(I, 3)
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Trim(ConfigDevolucion(I, 1)) <> "" Then
                        PALABRA = ""
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                            FinPal = False
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                                FinPal = True
                                Select Case PALABRA
                                    Case "Código"
                                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 1) = Detalle(I, 1) + Valores(0) + "  "
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 4) = "C"
                                    Case "Descripción"
                                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 0) = Trim(ConfigDevolucion(I, 0))
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 1) = Detalle(I, 1) + Valores(1) + "  "
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 4) = "C"
                                    Case "Cantidad"
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Valor = Valores(2)
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 4) = Detalle(I, 4) + "E" 'SIGNIFICA QUE ES UN DATO ENTERO
                                    Case "Precio Real"
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Valor = Valores(3)
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 4) = Detalle(I, 4) + "D"
                                    Case "Importe"
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Valores(4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Valor = Valores(4)
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 4) = "D"
                                End Select
                                PALABRA = ""
                                J = J + 1
                                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If FinPal And Detalle(I, 4) = "S" Or Detalle(I, 4) = "D" Or Detalle(I, 4) = "E" Or Detalle(I, 4) = "DE" Or Detalle(I, 4) = "ED" Then
                                    '                                Detalle(i, 1) = ""
                                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                    If Detalle(I, 1) = "" Then Detalle(I, 1) = 0
                                    If SIMBOLO = "+" Then
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 1) = Detalle(I, 1) + Valor
                                    ElseIf SIMBOLO = "-" Then
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 1) = Detalle(I, 1) - Valor
                                    ElseIf SIMBOLO = "*" Then
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                        Detalle(I, 1) = Detalle(I, 1) * Valor
                                    End If
                                End If
                                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                                    SIMBOLO = "+"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                                    SIMBOLO = "-"
                                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "x" Then
                                    SIMBOLO = "*"
                                End If
                            End If
                        Next J
                    End If
                    '                RsGral.MoveNext
                End If
            Next I
            If Encabezado Then
                Encabezado = False
                PrintLine(1, LineaSepara(COLS))
                For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) + Detalle(I, 0)
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Detalle(I, 3) > 0 Then
                        For J = 1 To 1 'Detalle(i, 3)
                            PrintLine(1, Left(RTrim(Linea), COLS))
                            Linea = ""
                        Next J
                    End If
                Next I
                PrintLine(1, LineaSepara(COLS))
            End If

            ''''***** DETALLE *****
            For I = (C_TamañoEncabezado + 1) To (C_TamañoEncabezado + C_TamañoDetalle)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 4) = "C" Then
                    'Se trata de un dato caracter
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Trim(Detalle(I, 1))
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                ElseIf Detalle(I, 4) = "E" Then
                    'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                    If gbytPosicionesDecimal = 0 Then
                        FormatoCantidad = CStr(0)
                    Else
                        FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                    End If
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(8) & Format(Detalle(I, 1), FormatoCantidad), 8)
                Else
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), "###,###,##0.00"), 10)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                If Detalle(I, 3) > 0 Then
                    'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    For J = 1 To Detalle(I, 3)
                        PrintLine(1, Left(RTrim(Linea), COLS))
                        Linea = ""
                    Next J
                End If
            Next I
            recAux.MoveNext()

            System.Array.Clear(Detalle, 0, Detalle.Length)
        Next H
        '***** TOTALES *****}
        gStrSql = "SELECT Dc.Moneda, DD.FolioDevolucion, DC.TotalDevol, DC.TotalxAplicar AS TotalD, DC.TotalxAplicar * dc.TipoCambio  AS TotalP " & "FROM dbo.DevolucionesDet DD INNER JOIN " & "dbo.DevolucionesCab DC ON DD.FolioDevolucion = DC.FolioDevolucion " & "WHERE (DD.FolioDevolucion = '" & Folio & "') " & "GROUP BY DD.FolioDevolucion, DC.TotalDevol, DC.TotalxAplicar, DC.TotalxAplicar * DC.TipoCambio, Dc.Moneda"
        ModEstandar.BorraCmd()
        Cmd.CommandText = "dbo.Up_Select_Datos"
        Cmd.CommandType = ADODB.CommandTypeEnum.adCmdStoredProc
        Cmd.Parameters.Append(Cmd.CreateParameter("Renglon", ADODB.DataTypeEnum.adInteger, ADODB.ParameterDirectionEnum.adParamReturnValue))
        Cmd.Parameters.Append(Cmd.CreateParameter("Sentencia", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 8000, gStrSql))
        RsGral = Cmd.Execute
        If RsGral.RecordCount > 0 Then
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(0) = Format(System.Math.Round(RsGral.Fields("TotalDevol").Value, 2), gstrFormatoCantidad) 'Total Devolucion Dólares
            If Trim(RsGral.Fields("Moneda").Value) = "D" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(1) = Format(System.Math.Round(RsGral.Fields("TotalD").Value, 2), gstrFormatoCantidad) 'Total Devolucion dolar
            ElseIf Trim(RsGral.Fields("Moneda").Value) = "P" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Valores(1) = Format(System.Math.Round(RsGral.Fields("TotalP").Value, 1), gstrFormatoCantidad) 'Total Devolucion Pesos
            End If
            'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Valores(2) = IIf((Trim(RsGral.Fields("Moneda").Value) = "D"), "DOLAR", "PESOS")
        End If

        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 0) = ConfigDevolucion(I, 0)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

            Totales(I, 2) = ConfigDevolucion(I, 2)
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(I, 3). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

            Totales(I, 3) = ConfigDevolucion(I, 3)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            Totales(I, 4) = "C"
            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Trim(ConfigDevolucion(I, 1)) <> "" Then
                PALABRA = ""
                'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                For J = 1 To Len(Trim(ConfigDevolucion(I, 1)) & " ")
                    FinPal = False
                    'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> ")" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "+" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "(" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "-" And Mid(Trim(ConfigDevolucion(I, 1)), J, 1) <> "*" Then
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        PALABRA = PALABRA & Mid(Trim(ConfigDevolucion(I, 1)), J, 1)
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                    ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = ")" Then
                        FinPal = True
                        Select Case PALABRA
                            Case "Total Devol"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(0)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Total Docto"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Valor = Valores(1)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "N"
                            Case "Moneda"
                                'UPGRADE_WARNING: Couldn't resolve default property of object Valores(2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Valores(2)
                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 4) = "C"
                        End Select
                        PALABRA = ""
                        J = J + 1
                        'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If FinPal And (Totales(I, 4) = "N" Or Totales(I, 4) = "E" Or Totales(I, 4) = "EN" Or Totales(I, 4) = "NE") Then
                            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                            If Totales(I, 1) = "" Then Totales(I, 1) = 0
                            If SIMBOLO = "+" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) + Valor
                            ElseIf SIMBOLO = "-" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) - Valor
                            ElseIf SIMBOLO = "*" Then

                                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                                Totales(I, 1) = Totales(I, 1) * Valor
                            End If
                        End If
                        'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        If Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "+" Or Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "" Then
                            SIMBOLO = "+"
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "-" Then
                            SIMBOLO = "-"
                            'UPGRADE_WARNING: Couldn't resolve default property of object ConfigDevolucion(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                        ElseIf Mid(Trim(ConfigDevolucion(I, 1)), J, 1) = "*" Then
                            SIMBOLO = "*"
                        End If
                    End If
                Next J
            End If
        Next I
        'Imprimir 3 Lineas en Blanco, para separar el Total de el Detalle.
        For I = 1 To 2
            Linea = ""
            PrintLine(1, Left(RTrim(Linea), COLS))
        Next
        For I = (C_TamañoEncabezado + C_TamañoDetalle + 1) To (C_TamañoEncabezado + C_TamañoDetalle + C_TamañoTotales)
            'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            If Totales(I, 4) = "C" Then
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 1). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Totales(I, 0). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'

                Linea = Left(Linea & Space(COLS), Totales(I, 2)) + Totales(I, 0) + Totales(I, 1)
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 4). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
            ElseIf Detalle(I, 4) = "E" Then
                'Se Trata de un dato Entero, como la Cantidad. Y se aplicará el FOrmateo de Acuerdo al Parametro de Configuración General que indica, cuantos decimales tendrá la CAntidad.
                If gbytPosicionesDecimal = 0 Then
                    FormatoCantidad = CStr(0)
                Else
                    FormatoCantidad = "0." & New String("0", gbytPosicionesDecimal)
                End If
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'UPGRADE_WARNING: Couldn't resolve default property of object Detalle(I, 2). Click for more: 'ms-help://MS.VSCC.v80/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                Linea = Left(Linea & Space(COLS), Detalle(I, 2)) & Right(Space(10) & Format(Detalle(I, 1), FormatoCantidad), 10)
            Else


                Linea = Left(Linea & Space(COLS), Totales(I, 2)) & Left(Totales(I, 0) + Space(25), 25) & Right(Space(10) & Format(Totales(I, 1), "###,###,##0.00"), 10)
            End If

            If Totales(I, 3) > 0 Then

                For J = 1 To Totales(I, 3)
                    PrintLine(1, Left(RTrim(Linea), COLS))
                    Linea = ""
                Next J
            End If
        Next I

        For I = 1 To 4
            PrintLine(1, "")
        Next I
        PrintLine(1, Chr(27) & Chr(105))
        FileClose(1)
        'SE usa el siguiente código paramostrar el archivo donde se esta guardando el Ticket, por el momento, Después sólo se mandará a la impresora.
        '''x = Shell("C:\WINDOWS\NOTEPAD.EXE C:\Archivos de programa\Microsoft Visual Studio\VB98\FILETICKET.TXT", vbNormalFocus)

        System.Array.Clear(Encabez, 0, Encabez.Length)

        System.Array.Clear(Detalle, 0, Detalle.Length)

        System.Array.Clear(Totales, 0, Totales.Length)

        System.Array.Clear(Valores, 0, Valores.Length)

        recAux = Nothing

Errores:
        If Err.Number = 55 Then
            FileClose(1)
            Err.Clear()
            GoTo Continuar
        End If
        If Err.Number <> 0 Then ModEstandar.MostrarError()
    End Sub
End Module